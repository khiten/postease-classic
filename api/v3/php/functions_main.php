<?php
 goto JrWHX; LHt9U: function get_comment($id) { global $database; global $pdo; global $table_prefix; $id = intval($id); if (!empty($id)) { $qsi_post_datetime = $database == 1 ? "\123\125\x42\x53\124\x52\50\x70\x6f\x73\x74\x65\x64\x5f\x61\x74\x2c\40\61\x2c\40\61\66\x29" : "\x53\125\102\123\x54\122\x49\116\107\x28\x70\157\163\164\145\x64\x5f\141\164\54\x20\61\x2c\40\61\x36\x29"; $qsi_post_date = $database == 1 ? "\123\125\102\x53\124\122\50\x70\x6f\163\164\145\x64\137\x61\164\54\x20\x31\x2c\x20\x31\60\51" : "\x53\x55\102\123\124\122\111\116\x47\50\160\x6f\x73\x74\x65\x64\x5f\141\x74\x2c\40\61\54\x20\61\60\x29"; $comment = array(); try { $sql = "\xa\11\x9\11\x9\11\x53\x45\114\x45\103\124\xa\11\x9\x9\11\x9\11\x69\144\x20\x41\x53\x20\47\151\x64\47\54\12\11\11\x9\11\11\x9\x70\157\163\164\145\144\137\141\164\40\101\123\x20\x27\160\x6f\x73\x74\137\144\141\x74\x65\x74\151\155\x65\x5f\157\x72\151\147\x69\156\141\x6c\47\54\12\x9\11\11\x9\x9\x9{$qsi_post_datetime}\x20\x41\123\40\x27\x70\157\163\164\x5f\x64\x61\x74\145\x74\151\155\x65\47\54\xa\11\11\x9\x9\x9\11{$qsi_post_date}\40\101\123\x20\47\160\157\x73\164\137\144\141\164\x65\47\x2c\12\x9\x9\11\x9\11\11\x70\157\163\x74\137\151\144\40\101\123\40\x70\x6f\x73\x74\137\151\144\x2c\12\11\11\11\11\11\11\143\x6f\x6d\x6d\x65\x6e\x74\137\x69\x64\x20\101\123\x20\x27\x63\157\155\x6d\x65\156\164\x5f\x69\x64\x27\x2c\xa\11\x9\11\11\11\11\160\141\x72\x65\156\164\137\151\x64\x20\101\x53\x20\47\160\141\162\145\x6e\x74\137\151\x64\x27\x2c\xa\x9\x9\x9\11\11\x9\163\151\164\145\x5f\x69\144\40\x41\123\40\x27\x73\151\x74\145\137\151\144\x27\x2c\12\11\11\11\11\11\11\x70\x6f\x73\164\x74\171\160\145\137\x69\144\x20\x41\123\40\x27\x70\157\x73\x74\x74\171\x70\145\x5f\x69\144\x27\54\xa\x9\11\x9\11\11\x9\x74\171\x70\x65\x20\101\x53\x20\x27\164\x79\x70\145\47\x2c\xa\11\x9\11\x9\x9\11\163\x63\157\x72\x65\x20\101\x53\x20\47\163\143\x6f\162\145\47\54\xa\11\x9\x9\11\11\11\x6e\x69\143\x6b\156\x61\x6d\145\40\x41\x53\40\47\156\x69\143\x6b\x6e\x61\x6d\145\x27\x2c\xa\11\11\x9\11\x9\x9\x65\x6d\141\x69\154\x20\101\123\x20\47\x65\155\x61\151\x6c\x27\x2c\12\x9\11\11\11\11\11\145\x79\145\x63\141\x74\x63\150\40\101\x53\40\x27\145\x79\145\143\141\164\143\150\47\54\xa\11\x9\x9\x9\x9\11\x74\151\164\154\x65\40\101\123\40\x27\164\151\164\154\x65\x27\54\xa\11\x9\11\11\x9\x9\143\157\x6e\x74\x65\156\x74\40\x41\123\40\x27\x63\157\x6e\x74\x65\156\x74\x27\xa\x9\11\11\11\11\x46\x52\117\x4d\x20{$table_prefix}\143\x6f\155\155\x65\x6e\164\163\xa\11\11\11\11\x9\x57\x48\x45\122\x45\xa\11\x9\11\x9\11\x9\x69\144\40\x3d\x20\x3a\x49\104\12\11\11\x9\x9\x9\11\x41\116\x44\x20\144\145\x6c\x65\164\x65\x5f\146\x6c\x67\x20\x3d\40\60\xa\x9\x9\11\11\11\x9\101\116\104\40\163\x74\x61\164\x75\163\40\x3d\x20\61\xa\11\11\x9"; $read_comment = $pdo->prepare($sql); $read_comment->bindValue("\72\x49\x44", $id, PDO::PARAM_INT); $read_comment->execute(); if ($record = $read_comment->fetch(PDO::FETCH_ASSOC)) { $comment = $record; } unset($read_post_base); } catch (PDOException $e) { var_dump($e->getMessage()); } return $comment; } else { return false; } } goto vJ_nC; IEopu: function decodeHashId($hash_string, $digits = 12, $salt = null) { $hash_strings = "\60\x31\x32\63\64\65\x36\x37\70\x39\141\142\143\x64\145\146"; $hashids = new Hashids($salt, $digits, $hash_strings); if ($raw_string = $hashids->decode($hash_string)) { return $raw_string; } return false; } goto ZKAA8; AQwwW: function post_comment($postdata) { global $database; global $pdo; global $table_prefix; if (!empty($postdata)) { $target_id = !empty($postdata["\x74\x61\162\147\x65\164\137\x69\144"]) ? intval($postdata["\164\141\x72\147\145\164\137\151\144"]) : 0; $post_id = !empty($postdata["\160\157\x73\x74\x5f\x69\x64"]) ? intval($postdata["\x70\157\163\164\137\151\x64"]) : 0; $comment_id = !empty($postdata["\x63\x6f\155\x6d\145\x6e\x74\137\151\x64"]) ? intval($postdata["\x63\x6f\x6d\155\x65\x6e\x74\x5f\151\144"]) : 0; $parent_id = !empty($postdata["\x70\x61\x72\x65\x6e\x74\137\151\144"]) ? intval($postdata["\160\141\x72\145\x6e\x74\x5f\x69\x64"]) : 0; $site_id = !empty($postdata["\x73\151\x74\145\137\151\144"]) ? intval($postdata["\x73\151\164\145\x5f\151\144"]) : 1; $posttype_id = !empty($postdata["\x70\157\x73\x74\x74\171\x70\145\x5f\x69\x64"]) ? intval($postdata["\x70\157\163\x74\x74\171\x70\x65\x5f\x69\144"]) : 1; $type = !empty($postdata["\164\x79\160\145"]) ? intval($postdata["\164\x79\x70\145"]) : 1; $score = isset($postdata["\x73\x63\157\162\145"]) ? intval($postdata["\x73\143\157\162\x65"]) : 0; $nickname = !empty($postdata["\156\151\x63\153\156\x61\155\x65"]) ? $postdata["\x6e\151\x63\x6b\156\141\155\145"] : ''; $email = !empty($postdata["\x65\155\x61\151\154"]) ? $postdata["\x65\x6d\141\x69\154"] : ''; $eyecatch = !empty($postdata["\145\x79\x65\143\x61\164\x63\x68"]) ? $postdata["\x65\x79\x65\x63\141\x74\x63\x68"] : null; $title = !empty($postdata["\164\151\164\x6c\x65"]) ? $postdata["\164\x69\164\154\x65"] : ''; $content = !empty($postdata["\x63\x6f\156\164\145\x6e\164"]) ? $postdata["\x63\x6f\156\x74\x65\x6e\164"] : ''; $ip_address = !empty($postdata["\151\x70\x5f\x61\144\x64\162\145\x73\163"]) ? $postdata["\x69\160\x5f\x61\x64\x64\162\x65\x73\x73"] : null; $delete_flg = !empty($postdata["\144\145\154\145\164\x65\x5f\146\x6c\x67"]) ? intval($postdata["\144\145\x6c\145\164\x65\137\146\x6c\147"]) : 0; $posted_at = date("\131\55\155\x2d\144\40\x48\x3a\x69\72\x73"); $updated_at = date("\x59\x2d\x6d\x2d\x64\x20\110\x3a\151\72\x73"); $affected_id = 0; try { $pdo->beginTransaction(); if (!$target_id) { $sql = "\xa\x9\x9\11\11\x9\x9\x49\x4e\x53\x45\x52\124\40\x49\116\124\117\40{$table_prefix}\143\x6f\155\x6d\145\156\164\163\xa\x9\11\11\x9\x9\x9\x9\50\40\160\157\x73\x74\137\x69\x64\x2c\40\x20\x63\157\x6d\155\145\x6e\x74\x5f\151\144\54\40\x20\160\141\x72\145\156\x74\137\x69\x64\54\40\40\163\x69\x74\145\x5f\x69\144\x2c\x20\x20\160\157\163\x74\x74\171\x70\x65\137\151\x64\x2c\40\x20\164\x79\160\x65\x2c\40\40\163\143\157\162\x65\x2c\x20\40\156\x69\x63\153\156\141\x6d\x65\x2c\40\40\x65\x6d\x61\x69\154\54\40\x20\145\171\x65\x63\x61\x74\x63\150\54\40\40\164\x69\x74\x6c\145\54\40\40\143\157\156\x74\x65\x6e\164\x2c\x20\x20\151\160\137\x61\144\x64\162\x65\x73\163\x2c\x20\40\160\157\163\x74\145\x64\137\141\x74\x29\xa\x9\x9\x9\11\11\11\126\x41\114\125\x45\123\12\11\x9\x9\x9\11\11\x9\x28\72\120\117\x53\x54\x5f\x49\x44\54\x20\72\x43\117\115\x4d\105\116\124\137\111\x44\x2c\40\x3a\x50\101\122\105\x4e\x54\137\x49\x44\54\x20\72\x53\111\x54\105\x5f\x49\104\x2c\x20\72\x50\x4f\x53\x54\x54\x59\120\x45\x5f\111\104\54\40\x3a\x54\131\x50\x45\54\40\72\123\x43\x4f\x52\105\x2c\x20\x3a\116\x49\103\x4b\116\101\x4d\105\54\x20\72\105\x4d\101\x49\114\54\40\72\105\131\105\x43\101\124\x43\x48\x2c\x20\72\x54\111\124\x4c\105\54\x20\x3a\x43\117\116\x54\105\116\x54\54\x20\x3a\x49\120\x5f\x41\104\x44\x52\105\x53\x53\54\x20\x3a\120\117\x53\124\105\104\137\101\x54\x29\xa\x9\x9\11\11"; $create_comment = $pdo->prepare($sql); $create_comment->bindValue("\x3a\120\117\x53\124\x5f\111\x44", $post_id, PDO::PARAM_INT); $create_comment->bindValue("\x3a\103\x4f\x4d\x4d\105\116\124\x5f\111\104", $comment_id, PDO::PARAM_INT); $create_comment->bindValue("\x3a\120\101\x52\x45\116\x54\x5f\x49\104", $parent_id, PDO::PARAM_INT); $create_comment->bindValue("\72\x53\x49\124\x45\x5f\x49\104", $site_id, PDO::PARAM_INT); $create_comment->bindValue("\72\x50\x4f\123\124\x54\131\x50\x45\137\x49\x44", $posttype_id, PDO::PARAM_INT); $create_comment->bindValue("\x3a\124\131\120\105", $type, PDO::PARAM_INT); $create_comment->bindValue("\x3a\x53\x43\117\x52\x45", $score, PDO::PARAM_INT); $create_comment->bindValue("\x3a\x4e\x49\x43\113\x4e\101\115\105", $nickname, PDO::PARAM_STR); $create_comment->bindValue("\72\105\115\101\x49\x4c", $email, PDO::PARAM_STR); $create_comment->bindValue("\72\105\131\105\103\x41\x54\103\110", $eyecatch, PDO::PARAM_STR); $create_comment->bindValue("\72\124\111\x54\x4c\105", $title, PDO::PARAM_STR); $create_comment->bindValue("\x3a\103\117\116\124\105\116\124", $content, PDO::PARAM_STR); $create_comment->bindValue("\72\x49\120\x5f\x41\x44\104\122\x45\123\x53", $ip_address, PDO::PARAM_STR); $create_comment->bindValue("\x3a\x50\x4f\x53\x54\x45\x44\x5f\101\x54", $posted_at, PDO::PARAM_STR); $create_comment->execute(); unset($create_comment); $sql = "\123\105\x4c\105\103\x54\x20\x69\x64\x20\x46\122\117\x4d\40{$table_prefix}\x63\x6f\155\x6d\x65\x6e\164\163\x20\x4f\122\x44\105\x52\40\x42\131\40\x69\144\x20\x44\x45\123\x43\x20\114\x49\x4d\x49\x54\40\x30\x2c\40\61"; $get_new_comment = $pdo->prepare($sql); $get_new_comment->execute(); if ($new_comment = $get_new_comment->fetch(PDO::FETCH_ASSOC)) { $affected_id = $new_comment["\151\x64"]; unset($get_new_comment); } } elseif ($target_id && empty($delete_flg)) { $sql = "\xa\11\x9\11\x9\x9\11\125\x50\x44\x41\124\x45\40{$table_prefix}\x63\157\155\155\145\156\164\163\40\x53\x45\124\xa\x9\11\x9\11\x9\x9\x9\163\x63\157\162\145\40\x20\40\x20\x20\40\40\x3d\x20\x3a\x53\103\117\x52\105\54\12\x9\x9\x9\x9\11\x9\x9\x6e\x69\x63\153\x6e\x61\155\145\40\40\x20\x20\75\x20\72\116\111\103\113\116\101\x4d\105\x2c\xa\11\11\11\11\11\11\x9\x65\x6d\141\x69\154\x20\40\x20\x20\40\x20\40\75\40\x3a\x45\115\101\x49\114\x2c\xa\x9\11\x9\11\11\x9\11\145\171\x65\143\141\x74\143\x68\x20\x20\40\40\75\x20\72\105\x59\105\103\101\124\x43\110\54\xa\x9\11\x9\11\x9\x9\x9\x74\151\x74\x6c\145\x20\x20\40\x20\40\x20\40\x3d\x20\72\124\x49\x54\114\105\x2c\12\x9\x9\11\x9\x9\x9\x9\143\157\156\x74\x65\x6e\x74\40\x20\x20\x20\40\x3d\40\x3a\x43\117\116\124\x45\x4e\124\x2c\12\11\11\x9\11\11\x9\11\151\x70\x5f\141\144\144\x72\x65\163\x73\x20\x20\75\40\x3a\111\120\137\101\x44\x44\x52\105\x53\x53\54\12\11\11\x9\11\11\11\11\x75\160\144\141\x74\145\x64\137\141\164\40\40\75\40\72\x55\x50\104\x41\124\x45\x44\137\x41\124\x2c\xa\x9\11\x9\11\11\11\11\163\164\x61\164\165\x73\x20\x20\x20\x20\40\x20\75\x20\72\x53\124\x41\124\x55\123\xa\x9\11\11\x9\x9\x9\x57\x48\x45\x52\105\40\151\x64\x20\75\x20\72\111\x44\xa\11\x9\11\11"; $update_comment = $pdo->prepare($sql); $update_comment->bindValue("\x3a\123\103\x4f\x52\x45", $score, PDO::PARAM_INT); $update_comment->bindValue("\x3a\116\x49\x43\x4b\x4e\x41\115\x45", $nickname, PDO::PARAM_STR); $update_comment->bindValue("\72\x45\115\x41\111\x4c", $email, PDO::PARAM_STR); $update_comment->bindValue("\x3a\105\131\x45\x43\101\x54\103\x48", $eyecatch, PDO::PARAM_STR); $update_comment->bindValue("\72\x54\111\124\114\x45", $title, PDO::PARAM_STR); $update_comment->bindValue("\72\103\x4f\x4e\x54\105\116\x54", $content, PDO::PARAM_STR); $update_comment->bindValue("\72\x49\120\137\x41\x44\x44\122\x45\123\x53", $ip_address, PDO::PARAM_STR); $update_comment->bindValue("\72\x55\120\x44\x41\124\105\x44\137\101\x54", $updated_at, PDO::PARAM_STR); $update_comment->bindValue("\72\123\x54\x41\x54\125\123", 2, PDO::PARAM_INT); $update_comment->bindValue("\x3a\111\x44", $target_id, PDO::PARAM_INT); $update_comment->execute(); if ($update_comment->rowCount()) { $affected_id = $target_id; } unset($update_comment); } elseif ($target_id && $delete_flg == 1) { $sql = "\12\11\11\x9\x9\11\x9\x55\x50\104\101\124\105\40{$table_prefix}\x63\157\x6d\x6d\x65\156\164\x73\x20\123\x45\124\12\11\x9\11\x9\x9\x9\x9\x75\x70\x64\141\x74\145\x64\137\141\x74\40\x20\75\x20\72\125\120\104\x41\124\105\x44\137\x41\x54\x2c\12\11\x9\11\11\x9\11\11\144\145\154\145\164\x65\137\x66\154\x67\x20\40\x3d\40\x3a\x44\x45\114\105\x54\x45\137\106\x4c\x47\xa\x9\x9\11\11\11\x9\127\x48\x45\122\105\12\11\11\x9\11\11\x9\11\151\144\40\x3d\40\x3a\111\x44\12\11\x9\x9\x9\x9\11\x9\x41\x4e\104\40\x6e\151\143\153\x6e\x61\155\x65\x20\75\40\72\116\111\x43\x4b\116\x41\115\105\12\11\11\11\11\11\x9\11\101\116\x44\x20\145\x6d\x61\151\x6c\40\x3d\40\72\x45\x4d\101\111\x4c\12\x9\x9\x9\x9"; $update_comment = $pdo->prepare($sql); $update_comment->bindValue("\72\x55\x50\x44\x41\x54\105\104\x5f\x41\124", $updated_at, PDO::PARAM_STR); $update_comment->bindValue("\x3a\104\x45\114\x45\124\x45\x5f\106\x4c\x47", 1, PDO::PARAM_INT); $update_comment->bindValue("\72\111\x44", $target_id, PDO::PARAM_INT); $update_comment->bindValue("\x3a\116\x49\x43\x4b\116\101\115\x45", $nickname, PDO::PARAM_STR); $update_comment->bindValue("\x3a\105\115\x41\111\114", $email, PDO::PARAM_STR); $update_comment->execute(); if ($update_comment->rowCount()) { $affected_id = $target_id; } unset($update_comment); } $pdo->commit(); } catch (PDOException $e) { $pdo->rollBack(); return false; } return $affected_id; } return false; } goto iU39A; QxZf7: function get_posts($config = array()) { global $database; global $pdo; global $table_prefix; $limit = isset($config["\x6c\151\x6d\x69\164"]) ? intval($config["\x6c\151\155\151\164"]) : null; $page = !empty($config["\160\141\x67\x65"]) ? intval($config["\160\x61\x67\x65"]) : 1; $content_length = isset($config["\143\x6f\x6e\164\x65\x6e\164\x5f\154\145\x6e\147\x74\150"]) ? intval($config["\x63\157\x6e\x74\x65\156\164\x5f\154\x65\x6e\147\x74\150"]) : 0; $orderby = isset($config["\157\x72\144\x65\x72\x62\x79"]) ? $config["\157\162\x64\x65\x72\x62\x79"] : 0; $site = !empty($config["\x73\151\164\x65"]) ? $config["\163\151\164\x65"] : null; $site_id = isset($config["\163\x69\164\x65\137\151\x64"]) ? intval($config["\x73\151\164\145\137\x69\x64"]) : 1; $posttype = !empty($config["\160\x6f\163\x74\x74\x79\x70\145"]) ? $config["\x70\x6f\163\x74\x74\171\x70\x65"] : null; $posttype_id = isset($config["\x70\x6f\x73\x74\164\x79\x70\145\137\x69\144"]) ? $config["\160\x6f\163\x74\164\171\x70\x65\137\151\144"] : 1; $language = !empty($config["\x6c\141\x6e\x67\x75\141\x67\145"]) ? $config["\154\x61\156\x67\x75\x61\x67\x65"] : null; $language_id = isset($config["\x6c\141\156\147\x75\141\147\x65\x5f\151\x64"]) ? intval($config["\154\x61\156\x67\x75\141\x67\145\137\151\x64"]) : 1; $anchor_equal = isset($config["\x61\156\143\x68\157\162\x5f\145\161\x75\141\154"]) ? intval($config["\x61\x6e\143\150\157\x72\x5f\145\x71\x75\141\x6c"]) : null; $anchor_morethan = isset($config["\141\x6e\143\x68\x6f\x72\137\x6d\157\162\x65\164\x68\x61\x6e"]) ? intval($config["\x61\156\x63\x68\157\x72\137\x6d\157\x72\145\164\x68\x61\x6e"]) : null; $anchor_lessthan = isset($config["\141\156\143\150\x6f\x72\x5f\154\x65\x73\x73\164\150\141\156"]) ? intval($config["\x61\x6e\143\x68\157\162\137\154\145\x73\x73\164\x68\x61\x6e"]) : null; $year = !empty($config["\171\145\x61\x72"]) ? intval($config["\x79\x65\x61\162"]) : 0; $month = !empty($config["\155\157\156\x74\x68"]) ? sprintf("\45\60\62\x64", intval($config["\x6d\157\x6e\x74\x68"])) : 0; $day = !empty($config["\144\141\171"]) ? sprintf("\x25\x30\x32\x64", intval($config["\x64\x61\x79"])) : 0; $text = !empty($config["\x74\x65\170\x74"]) ? mb_convert_kana($config["\x74\145\x78\x74"], "\x73", "\125\x54\106\55\70") : null; $title = !empty($config["\164\151\164\x6c\145"]) ? $config["\x74\x69\164\x6c\145"] : null; $addition = !empty($config["\x61\144\144\151\164\151\157\x6e"]) ? $config["\x61\144\144\151\x74\x69\157\x6e"] : null; $content = !empty($config["\143\x6f\156\164\x65\x6e\164"]) ? $config["\x63\x6f\156\x74\145\156\x74"] : null; $category = !empty($config["\x63\x61\164\145\147\x6f\x72\171"]) ? $config["\143\x61\x74\145\147\157\x72\x79"] : null; $category_id = !empty($config["\x63\x61\x74\145\x67\157\162\171\x5f\151\144"]) ? $config["\143\141\x74\x65\x67\x6f\162\x79\137\x69\x64"] : null; $category_splice = !empty($config["\143\x61\164\145\x67\157\162\171\137\x73\160\154\151\x63\x65"]) ? $config["\143\141\x74\145\x67\x6f\162\171\x5f\x73\x70\x6c\151\x63\145"] : "\117\x52"; $tag = !empty($config["\164\x61\x67"]) ? $config["\x74\x61\147"] : null; $tag_id = !empty($config["\164\x61\x67\x5f\151\x64"]) ? $config["\x74\141\147\x5f\x69\x64"] : null; $tag_splice = !empty($config["\164\141\147\137\x73\160\154\x69\x63\x65"]) ? $config["\164\141\x67\x5f\163\160\154\151\143\x65"] : "\117\x52"; $exclude_category = !empty($config["\145\170\143\x6c\165\144\x65\137\143\141\x74\145\x67\x6f\x72\171"]) ? $config["\x65\170\x63\154\165\x64\x65\x5f\143\141\164\x65\147\157\162\x79"] : null; $exclude_category_id = !empty($config["\x65\x78\143\x6c\165\144\x65\x5f\x63\x61\x74\x65\147\157\x72\171\x5f\151\144"]) ? $config["\145\170\x63\154\x75\x64\x65\137\143\x61\164\145\147\157\162\171\137\151\x64"] : null; $exclude_tag = !empty($config["\145\x78\x63\x6c\165\144\x65\137\x74\141\x67"]) ? $config["\x65\170\x63\x6c\165\x64\x65\x5f\164\141\x67"] : null; $exclude_tag_id = !empty($config["\x65\170\143\154\165\x64\145\137\164\141\x67\137\x69\x64"]) ? $config["\145\x78\143\154\165\144\x65\x5f\x74\141\x67\137\x69\144"] : null; $exclude_id = !empty($config["\x65\x78\143\154\x75\x64\145\x5f\x69\x64"]) ? $config["\145\x78\x63\154\165\x64\x65\137\x69\x64"] : null; $author = !empty($config["\141\x75\x74\150\x6f\x72"]) ? $config["\141\165\x74\150\x6f\162"] : null; $author_id = !empty($config["\141\165\x74\x68\157\162\x5f\x69\144"]) ? intval($config["\141\x75\164\150\x6f\x72\x5f\151\144"]) : 0; $group = !empty($config["\147\162\x6f\165\160"]) ? $config["\147\162\157\x75\160"] : null; $group_id = !empty($config["\147\162\157\165\x70\137\x69\x64"]) ? intval($config["\147\162\x6f\165\160\137\151\144"]) : 0; $date_from = !empty($config["\x64\141\164\x65\x5f\146\x72\157\155"]) ? $config["\x64\141\164\145\x5f\x66\162\157\x6d"] : null; $date_to = !empty($config["\x64\141\x74\x65\x5f\164\157"]) ? $config["\x64\141\164\x65\x5f\x74\x6f"] : null; $eyecatch_frame = !empty($config["\145\171\x65\x63\141\x74\143\x68\x5f\146\x72\x61\155\145"]) ? $config["\145\x79\145\x63\x61\164\x63\x68\137\x66\x72\x61\155\x65"] : null; $content_frame = !empty($config["\143\x6f\x6e\x74\x65\156\164\137\146\x72\141\155\x65"]) ? $config["\143\x6f\x6e\164\x65\156\x74\x5f\146\x72\141\155\x65"] : null; $custom_frame = !empty($config["\143\165\163\x74\x6f\155\x5f\x66\x72\x61\155\145"]) ? $config["\x63\x75\x73\164\157\x6d\x5f\146\162\141\155\x65"] : array(); $with_list_index = isset($config["\x77\x69\x74\150\137\x6c\151\x73\164\137\151\x6e\144\145\170"]) ? intval($config["\167\151\x74\x68\137\x6c\151\163\164\x5f\151\x6e\144\145\x78"]) : 1; $with_custom = isset($config["\x77\151\x74\150\x5f\x63\165\163\x74\157\155"]) ? intval($config["\x77\151\x74\150\137\x63\165\x73\x74\157\155"]) : 1; $with_counter = isset($config["\x77\x69\x74\x68\137\143\x6f\165\x6e\x74\145\162"]) ? intval($config["\x77\x69\164\x68\137\143\157\x75\x6e\164\x65\162"]) : 1; $count_comments = isset($config["\x63\157\165\x6e\x74\x5f\143\x6f\155\x6d\145\x6e\164\x73"]) ? intval($config["\x63\x6f\165\156\x74\x5f\143\157\x6d\155\x65\156\x74\163"]) : 0; $ignore_anchor = isset($config["\151\147\156\157\162\x65\137\141\156\x63\x68\157\162"]) ? intval($config["\x69\147\x6e\x6f\x72\145\x5f\141\x6e\x63\x68\157\162"]) : 0; $preview = isset($config["\160\162\x65\166\151\x65\167"]) ? intval($config["\x70\162\145\x76\151\x65\x77"]) : 0; if ($orderby) { if (strtoupper($orderby) === "\x41\x53\103") { $orderby = 1; } elseif (strtoupper($orderby) === "\x44\x45\x53\103") { $orderby = 0; } elseif (intval($orderby) > 0) { $orderby = 1; } else { $orderby = 0; } } if ($site) { $site_id = 9999; $sql = "\x53\105\114\105\x43\x54\40\151\144\x20\x46\122\x4f\x4d\x20{$table_prefix}\x73\151\164\145\163\x20\x57\110\105\122\105\40\144\145\154\x65\164\x65\137\146\x6c\147\x20\75\40\x30\x20\x41\116\x44\40\x73\x74\x61\x74\x75\163\40\x3d\x20\x31\40\101\x4e\x44\x20\163\154\x75\x67\40\x3d\40\47{$site}\x27"; $read_records = $pdo->prepare($sql); $read_records->execute(); if ($record = $read_records->fetch(PDO::FETCH_ASSOC)) { $site_id = intval($record["\x69\x64"]); } unset($read_records); } if ($posttype) { $posttype_id = 9999; $sql = "\x53\105\x4c\x45\x43\124\40\151\144\40\x46\x52\x4f\x4d\x20{$table_prefix}\x70\x6f\163\x74\164\x79\160\x65\163\40\x57\110\x45\122\105\x20\144\145\x6c\x65\x74\x65\137\146\x6c\x67\x20\x3d\x20\x30\40\101\116\104\x20\x73\x74\141\x74\165\x73\x20\x3d\40\x31\x20\x41\116\x44\40\x73\154\165\147\x20\x3d\x20\47{$posttype}\x27"; $read_records = $pdo->prepare($sql); $read_records->execute(); if ($record = $read_records->fetch(PDO::FETCH_ASSOC)) { $posttype_id = intval($record["\x69\144"]); } unset($read_records); } $configs_posttype = array(); if ($site_id && $posttype_id) { $sql = "\xa\x9\x9\11\x53\x45\x4c\105\x43\x54\x20\151\164\x65\155\x2c\x20\166\x61\154\165\x65\40\x46\122\x4f\x4d\40{$table_prefix}\143\x6f\x6e\x66\151\x67\163\137\160\x6f\163\x74\x74\x79\160\145\12\x9\x9\11\x57\x48\105\x52\105\40\50\163\x69\x74\145\137\151\144\40\75\40\x30\40\117\x52\40\x73\151\164\x65\x5f\151\x64\x20\x3d\x20{$site_id}\x29\40\101\x4e\x44\x20\160\x6f\x73\x74\x74\171\160\145\x5f\151\x64\40\75\40{$posttype_id}\12\x9\11\x9\101\x4e\x44\x20\x69\x74\x65\155\40\111\116\x20\x28\47\x70\x65\x72\155\x61\154\151\x6e\153\x5f\x62\x61\163\x65\x5f\x70\162\144\x27\x2c\x20\x27\145\x79\x65\x63\141\x74\143\x68\137\x66\162\x61\155\145\47\51\xa\11\x9\x9"; $read_records = $pdo->prepare($sql); $read_records->execute(); while ($record = $read_records->fetch(PDO::FETCH_ASSOC)) { $configs_posttype[$record["\x69\164\145\155"]] = $record["\166\141\x6c\x75\x65"]; } unset($permalink_base); } $permalink_base = $configs_posttype["\160\x65\162\155\141\154\x69\x6e\153\137\142\x61\163\145\x5f\x70\162\144"]; $eyecatch_frame = !$eyecatch_frame ? $configs_posttype["\x65\171\x65\143\x61\x74\143\150\137\x66\x72\x61\x6d\145"] : $eyecatch_frame; if ($language) { $language_id = 9999; $sql = "\x53\x45\114\x45\x43\x54\40\151\144\x20\x46\x52\x4f\x4d\x20{$table_prefix}\x6c\141\156\147\165\141\147\145\163\x20\x57\110\x45\x52\105\40\x73\x6c\165\147\40\75\40\47{$language}\x27"; $read_records = $pdo->prepare($sql); $read_records->execute(); if ($record = $read_records->fetch(PDO::FETCH_ASSOC)) { $language_id = intval($record["\151\x64"]); } unset($read_records); } if ($author) { $sql = "\x53\x45\x4c\105\103\124\x20\x69\x64\x20\106\x52\117\x4d\x20{$table_prefix}\165\x73\145\x72\163\40\x57\110\105\x52\105\40\x61\143\x63\157\x75\x6e\164\40\75\40\47{$author}\x27"; $read_records = $pdo->prepare($sql); $read_records->execute(); if ($record = $read_records->fetch(PDO::FETCH_ASSOC)) { $author_id = intval($record["\x69\x64"]); } unset($read_records); } if ($group) { $sql = "\x53\105\x4c\x45\x43\x54\40\151\144\x20\106\122\x4f\115\x20{$table_prefix}\x67\162\x6f\165\x70\163\40\x57\x48\105\122\x45\40\163\x6c\165\x67\40\75\40\47{$group}\x27"; $read_records = $pdo->prepare($sql); $read_records->execute(); if ($record = $read_records->fetch(PDO::FETCH_ASSOC)) { $group_id = intval($record["\x69\x64"]); } unset($read_records); } $group_user_ids = null; if ($group_id) { $sql = "\123\x45\114\105\x43\x54\x20\x69\144\40\x46\x52\117\x4d\x20{$table_prefix}\x75\163\x65\x72\x73\x20\x57\x48\x45\122\x45\x20\147\162\x6f\x75\160\137\x69\x64\40\x3d\x20{$group_id}"; $read_records = $pdo->prepare($sql); $read_records->execute(); if ($record = $read_records->fetch(PDO::FETCH_ASSOC)) { $group_user_ids_arr[] = intval($record["\151\144"]); } unset($read_records); if (!empty($group_user_ids_arr)) { $group_user_ids = implode("\x2c", $group_user_ids_arr); } } $category_ids = array(); if ($category_id) { if (!is_array($category_id)) { $category_id_arr = array_map("\151\156\164\166\141\x6c", array_map("\x74\162\x69\155", explode("\54", $category_id))); foreach ($category_id_arr as $category_id) { $category_ids[] = sprintf("\45\60\64\x64", $category_id); } } } if ($category) { if (!is_array($category)) { $category_arr = array_map("\164\162\x69\x6d", explode("\x2c", $category)); } else { $category_arr = $category; } foreach ($category_arr as $category) { $sql = "\123\105\114\x45\103\x54\x20\x69\144\40\106\122\x4f\x4d\x20{$table_prefix}\x74\x61\x78\157\x6e\x6f\x6d\151\x65\163\x5f\x62\141\163\145\x20\127\x48\x45\x52\x45\x20\x64\145\154\145\164\145\137\x66\154\x67\x20\x3d\x20\60\40\101\x4e\x44\x20\x73\x74\x61\164\x75\163\x20\75\40\61\40\101\116\104\x20\143\x6c\141\163\163\151\146\x69\143\x61\164\151\157\156\x20\x3d\40\61\40\101\116\104\x20\x70\x6f\x73\x74\164\171\160\x65\x5f\151\144\x20\x3d\x20{$posttype_id}\x20\x41\x4e\104\x20\163\154\165\147\x20\x3d\40\x27{$category}\47"; $read_records = $pdo->prepare($sql); $read_records->execute(); if ($record = $read_records->fetch(PDO::FETCH_ASSOC)) { $category_ids[] = sprintf("\45\60\64\144", $record["\x69\x64"]); } } unset($read_records); } $tag_ids = array(); if ($tag_id) { if (!is_array($tag_id)) { $tag_id_arr = array_map("\151\156\x74\166\141\x6c", array_map("\x74\x72\x69\x6d", explode("\x2c", $tag_id))); foreach ($tag_id_arr as $tag_id) { $tag_ids[] = sprintf("\x25\60\64\144", $tag_id); } } } if ($tag) { if (!is_array($tag)) { $tag_arr = array_map("\164\x72\151\x6d", explode("\54", $tag)); } else { $tag_arr = $tag; } foreach ($tag_arr as $tag) { $sql = "\123\105\114\x45\x43\x54\40\151\x64\x20\106\122\117\x4d\x20{$table_prefix}\164\x61\170\157\156\157\x6d\x69\x65\x73\x5f\142\141\163\x65\x20\x57\110\105\x52\105\40\144\x65\x6c\x65\x74\145\x5f\146\x6c\147\x20\75\40\60\x20\101\116\x44\40\x73\164\x61\164\165\x73\x20\x3d\x20\x31\x20\101\x4e\x44\40\x63\154\141\x73\163\151\x66\151\x63\141\164\151\x6f\156\40\x3d\x20\x32\x20\x41\116\104\x20\x70\157\x73\164\x74\x79\x70\x65\x5f\151\144\40\x3d\x20{$posttype_id}\40\x41\116\x44\x20\163\154\x75\147\40\x3d\x20\x27{$tag}\47"; $read_records = $pdo->prepare($sql); $read_records->execute(); if ($record = $read_records->fetch(PDO::FETCH_ASSOC)) { $tag_ids[] = sprintf("\45\x30\64\x64", $record["\x69\x64"]); } } unset($read_records); } $exclude_category_ids = array(); if ($exclude_category_id) { if (!is_array($exclude_category_id)) { $exclude_category_id_arr = array_map("\151\156\x74\166\x61\x6c", array_map("\x74\162\x69\x6d", explode("\x2c", $exclude_category_id))); foreach ($exclude_category_id_arr as $exclude_category_id) { $exclude_category_ids[] = sprintf("\x25\x30\64\x64", $exclude_category_id); } } } if ($exclude_category) { if (!is_array($exclude_category)) { $exclude_category_arr = array_map("\164\162\x69\155", explode("\x2c", $exclude_category)); } else { $exclude_category_arr = $exclude_category; } foreach ($exclude_category_arr as $exclude_category) { $sql = "\x53\105\x4c\x45\x43\124\x20\151\144\40\x46\x52\x4f\115\40{$table_prefix}\x74\x61\x78\x6f\156\157\155\x69\x65\163\x5f\142\141\163\x65\x20\x57\x48\x45\x52\x45\x20\x64\x65\154\145\164\145\137\146\x6c\147\40\x3d\x20\x30\40\101\116\104\40\163\x74\x61\164\165\163\x20\75\x20\61\40\101\116\x44\x20\143\154\x61\x73\163\151\146\151\x63\x61\x74\x69\157\156\40\75\x20\x31\40\101\116\104\x20\x70\157\163\x74\164\171\160\x65\x5f\151\144\x20\x3d\40{$posttype_id}\40\x41\116\x44\x20\x73\x6c\x75\147\40\x3d\40\x27{$exclude_category}\x27"; $read_records = $pdo->prepare($sql); $read_records->execute(); if ($record = $read_records->fetch(PDO::FETCH_ASSOC)) { $exclude_category_ids[] = sprintf("\45\60\64\144", $record["\x69\x64"]); } } unset($read_records); } $exclude_tag_ids = array(); if ($exclude_tag_id) { if (!is_array($exclude_tag_id)) { $exclude_tag_id_arr = array_map("\151\156\x74\166\141\154", array_map("\164\162\151\x6d", explode("\54", $exclude_tag_id))); foreach ($exclude_tag_id_arr as $exclude_tag_id) { $exclude_tag_ids[] = sprintf("\45\x30\64\144", $exclude_tag_id); } } } if ($exclude_tag) { if (!is_array($exclude_tag)) { $exclude_tag_arr = array_map("\164\162\x69\x6d", explode("\x2c", $exclude_tag)); } else { $exclude_tag_arr = $exclude_tag; } foreach ($exclude_tag_arr as $exclude_tag) { $sql = "\123\x45\x4c\105\103\x54\x20\151\144\x20\106\x52\x4f\x4d\x20{$table_prefix}\164\141\170\157\156\157\155\x69\145\x73\137\x62\x61\x73\x65\40\127\x48\x45\x52\x45\x20\x64\x65\x6c\x65\164\145\137\146\154\147\40\75\40\60\x20\101\x4e\x44\40\163\x74\x61\164\165\x73\x20\75\40\61\x20\x41\116\104\x20\143\x6c\141\x73\x73\151\146\x69\143\141\x74\x69\x6f\x6e\40\75\40\62\x20\101\x4e\x44\x20\160\157\163\x74\164\171\x70\x65\137\151\x64\40\x3d\40{$posttype_id}\x20\101\116\104\x20\163\x6c\x75\x67\40\x3d\40\47{$exclude_tag}\47"; $read_records = $pdo->prepare($sql); $read_records->execute(); if ($record = $read_records->fetch(PDO::FETCH_ASSOC)) { $exclude_tag_ids[] = sprintf("\x25\60\64\144", $record["\x69\144"]); } } unset($read_records); } $texts = array(); if ($text) { if (!is_array($text)) { $texts = explode("\x20", $text); } } $qsc_posttype_id = null; if (!is_numeric($posttype_id) && strpos($posttype_id, "\54") !== false) { $posttype_ids = explode("\54", $posttype_id); foreach ($posttype_ids as $key => $value) { $posttype_ids[$key] = intval($value); } $posttype_id = implode("\x2c", $posttype_ids); $qsc_posttype_id = "\101\116\104\x20\160\x62\56\x70\157\x73\164\164\171\x70\x65\137\x69\x64\40\x49\116\40\x28{$posttype_id}\x29"; } elseif (is_numeric($posttype_id)) { $posttype_id = intval($posttype_id); $qsc_posttype_id = "\x41\x4e\x44\x20\x70\x62\x2e\x70\x6f\x73\164\x74\x79\160\x65\x5f\x69\144\40\x3d\x20{$posttype_id}"; } $offset = $limit > 0 ? ($page - 1) * $limit : 0; $orderby = empty($orderby) ? "\104\105\123\103" : "\101\123\x43"; $title = $title ? "\45{$title}\x25" : "\x25\x25"; $addition = $addition ? "\x25{$addition}\45" : "\45\x25"; $content = $content ? "\45{$content}\x25" : "\x25\45"; $date_from = !empty($date_from) ? date("\x59\x2d\155\x2d\144\x20\x48\72\151\72\x73", strtotime($date_from)) : null; $date_to = !empty($date_to) ? date("\x59\55\155\55\144\40\x48\x3a\x69\x3a\163", strtotime($date_to)) : null; $qsc_text = null; foreach ($texts as $key => $value) { $qsc_text .= "\40\101\x4e\104\40\50\164\x69\164\154\x65\40\x4c\x49\x4b\105\x20\x3a\124\105\x58\124{$key}\x20\x4f\122\40\141\x64\144\151\x74\151\x6f\156\40\x4c\x49\x4b\105\40\x3a\124\105\130\x54{$key}\x20\117\122\x20\x63\157\x6e\x74\145\x6e\x74\x20\x4c\111\x4b\105\40\x3a\x54\105\130\124{$key}\x29"; } $qsi_publish_datetime = $database == 1 ? "\123\125\102\123\x54\x52\x28\160\x62\56\x70\x75\142\154\151\163\150\137\x64\x61\x74\145\164\x69\x6d\x65\x2c\40\61\54\x20\x31\66\51" : "\123\x55\x42\123\x54\122\x49\x4e\107\x28\x70\x62\x2e\160\165\x62\154\x69\x73\150\x5f\x64\141\164\x65\164\x69\x6d\x65\x2c\40\61\x2c\x20\x31\66\51"; $qsi_publish_date = $database == 1 ? "\x53\125\x42\x53\x54\122\x28\160\142\x2e\160\165\142\x6c\x69\163\x68\x5f\144\x61\x74\x65\x74\151\x6d\x65\54\x20\x31\x2c\40\61\60\51" : "\123\x55\102\123\124\122\111\x4e\x47\x28\160\142\x2e\x70\x75\142\x6c\x69\x73\150\137\x64\141\x74\x65\x74\151\155\x65\x2c\40\x31\x2c\40\61\60\x29"; $now = date("\x59\x2d\155\55\144\40\110\x3a\x69\72\x73"); $qsc_publish_datetime = !$preview ? "\x41\116\104\40\x70\142\x2e\160\x75\142\x6c\x69\x73\150\137\x64\141\x74\145\164\x69\155\145\x20\74\75\x20\x27{$now}\47" : null; $qsc_publish_end_at = !$preview ? "\x41\116\x44\x20\x28\160\x62\56\160\165\142\x6c\151\163\x68\137\145\x6e\x64\137\x61\164\x20\x3e\x20\x27{$now}\x27\x20\117\122\40\160\x62\x2e\x70\165\x62\x6c\151\x73\150\x5f\145\x6e\144\137\141\164\x20\x49\x53\x20\x4e\125\114\114\51" : null; $qsc_status = !$preview ? "\x41\x4e\x44\x20\x70\142\56\163\164\x61\x74\165\x73\40\x3d\x20\61" : "\x41\x4e\104\40\x70\142\56\x73\x74\141\x74\165\x73\40\74\x3d\x20\62"; $qsc_publish_year = !empty($year) ? $database == 1 ? "\101\116\104\x20\x53\x54\x52\106\124\111\x4d\105\50\47\x25\x59\x27\x2c\40\160\142\x2e\160\165\142\x6c\x69\x73\150\137\144\141\164\x65\x74\x69\155\x65\51\40\x3d\40\x27{$year}\47" : "\x41\116\104\x20\x59\x45\101\x52\x28\x70\x62\56\160\165\x62\154\151\x73\x68\137\x64\x61\x74\145\x74\x69\x6d\x65\51\x20\75\40\47{$year}\47" : null; $qsc_publish_month = !empty($month) ? $database == 1 ? "\x41\116\104\40\x53\124\x52\x46\x54\111\x4d\x45\x28\47\45\x6d\x27\54\40\x70\x62\x2e\160\165\142\154\151\163\x68\137\144\x61\164\145\164\151\x6d\145\x29\40\x3d\40\x27{$month}\x27" : "\x41\x4e\x44\40\x4d\x4f\116\x54\110\50\x70\142\x2e\160\165\142\154\x69\x73\150\137\x64\x61\164\145\164\x69\x6d\145\51\40\75\40\47{$month}\x27" : null; $qsc_publish_day = !empty($day) ? $database == 1 ? "\x41\x4e\x44\x20\123\124\122\x46\x54\111\x4d\105\x28\47\x25\x64\47\x2c\x20\160\142\x2e\160\x75\142\x6c\x69\x73\x68\137\144\141\x74\145\164\x69\x6d\x65\51\x20\x3d\40\x27{$day}\x27" : "\101\116\x44\x20\x44\x41\131\x28\x70\142\x2e\x70\x75\142\154\151\x73\150\x5f\x64\x61\x74\145\164\151\155\x65\x29\40\75\40\x27{$day}\x27" : null; $qsc_date_from = !empty($date_from) ? "\x41\116\104\x20\160\142\x2e\160\x75\x62\x6c\x69\163\x68\x5f\144\x61\x74\x65\x74\x69\x6d\x65\40\x3e\75\x20\47{$date_from}\47" : null; $qsc_date_to = !$preview ? !empty($date_to) ? "\101\116\104\40\x70\142\x2e\160\x75\x62\x6c\x69\163\x68\137\x64\141\164\x65\164\151\155\145\40\74\75\x20\47{$date_to}\47" : "\101\x4e\x44\40\160\142\56\160\x75\x62\x6c\151\x73\x68\x5f\x64\x61\x74\x65\164\x69\x6d\x65\40\74\75\x20\x27{$now}\x27" : null; $qsc_category_id = null; if (count($category_ids)) { $splice = strtoupper($category_splice) == "\101\x4e\104" ? "\x41\116\x44" : "\x4f\122"; $qsc_category_id = "\101\116\104\40\x28"; foreach ($category_ids as $key => $category_id) { if ($key > 0) { $qsc_category_id .= "\40{$splice}\x20"; } $qsc_category_id .= "\160\x62\x2e\143\141\164\145\x67\x6f\x72\171\x5f\x69\144\40\x4c\x49\x4b\105\x20\x27\x25{$category_id}\45\47"; } $qsc_category_id .= "\51"; } $qsc_tag_id = null; if (count($tag_ids)) { $splice = strtoupper($tag_splice) == "\x41\116\x44" ? "\x41\116\x44" : "\x4f\x52"; $qsc_tag_id = "\x41\116\104\40\x28"; foreach ($tag_ids as $key => $tag_id) { if ($key > 0) { $qsc_tag_id .= "\40{$splice}\x20"; } $qsc_tag_id .= "\x70\x62\x2e\164\141\147\x5f\151\x64\x20\114\111\113\x45\40\x27\45{$tag_id}\x25\47"; } $qsc_tag_id .= "\x29"; } $qsc_exclude_category_id = null; if (count($exclude_category_ids)) { $qsc_exclude_category_id = "\101\x4e\104\40\x28"; foreach ($exclude_category_ids as $key => $exclude_category_id) { if ($key > 0) { $qsc_exclude_category_id .= "\x20\x41\116\x44\x20"; } $qsc_exclude_category_id .= "\x70\142\56\143\141\x74\x65\x67\x6f\162\x79\x5f\151\x64\x20\116\117\x54\x20\x4c\x49\x4b\x45\x20\x27\45{$exclude_category_id}\x25\47"; } $qsc_exclude_category_id .= "\x29"; } $qsc_exclude_tag_id = null; if (count($exclude_tag_ids)) { $qsc_exclude_tag_id = "\x41\116\104\40\x28"; foreach ($exclude_tag_ids as $key => $exclude_tag_id) { if ($key > 0) { $qsc_exclude_tag_id .= "\40\101\116\x44\x20"; } $qsc_exclude_tag_id .= "\x70\x62\x2e\x74\141\x67\137\x69\x64\x20\x4e\117\x54\40\x4c\111\113\x45\x20\47\x25{$exclude_tag_id}\45\47"; } $qsc_exclude_tag_id .= "\x29"; } $qsc_exclude_id = null; if (!empty($exclude_id)) { $exclude_ids_arr = array(); if (!is_array($exclude_id)) { $exclude_ids_arr = explode("\54", $exclude_id); } foreach ($exclude_ids_arr as $key => $value) { $exclude_ids_arr[$key] = intval($value); } $exclude_ids = implode("\54", $exclude_ids_arr); $qsc_exclude_id = "\101\x4e\x44\40\x70\142\x2e\151\x64\x20\x4e\x4f\x54\x20\111\116\40\50{$exclude_ids}\51"; } $qsc_anchor_equal = $anchor_equal !== null ? "\x41\116\x44\x20\x70\x62\56\141\156\x63\150\157\162\40\x3d\40\x20{$anchor_equal}" : null; $qsc_anchor_morethan = $anchor_morethan !== null ? "\101\116\x44\x20\160\142\56\x61\x6e\x63\x68\x6f\162\40\76\75\40{$anchor_morethan}" : null; $qsc_anchor_lessthan = $anchor_lessthan !== null ? "\x41\x4e\x44\40\x70\142\56\141\x6e\x63\x68\x6f\162\x20\74\x3d\x20{$anchor_lessthan}" : null; $qsc_created_by = !empty($author_id) ? "\x41\116\x44\x20\x70\x62\x2e\143\x72\145\141\164\x65\x64\137\x62\171\x20\75\40{$author_id}" : null; $qsc_grouped_by = !empty($group_id) ? "\101\x4e\104\40\50\160\142\x2e\x67\162\157\165\x70\145\144\137\x62\171\x20\75\40{$group_id}\x20\x4f\122\x20\160\142\56\x63\162\145\141\164\145\x64\x5f\142\x79\40\111\116\40\x28{$group_user_ids}\x29\51" : null; $query_orderby = $ignore_anchor ? "\x70\142\x2e\x70\x75\142\154\x69\x73\x68\x5f\144\141\164\145\164\151\x6d\x65\40{$orderby}\x2c\x20\160\142\56\x69\x64\40{$orderby}" : "\160\142\x2e\141\156\x63\x68\x6f\x72\40\x44\x45\123\103\54\x20\x70\x62\x2e\160\x75\x62\x6c\x69\163\x68\137\144\141\164\145\x74\x69\x6d\145\x20{$orderby}\54\40\160\x62\56\x69\144\x20{$orderby}"; $query_limit = $limit ? "\x4c\111\x4d\111\x54\40{$limit}\x20\117\106\x46\123\105\124\x20{$offset}" : null; $posts = array("\157\165\x74\x6c\x69\x6e\x65" => array(), "\x6c\151\163\x74\137\x69\x6e\x64\x65\170" => array(), "\x6c\151\163\164" => array()); try { $sql = "\12\11\x9\x9\x9\123\x45\114\x45\103\x54\x20\x43\x4f\125\116\x54\50\x70\x62\x2e\151\144\51\40\x41\x53\x20\x27\x63\x6f\165\156\x74\47\xa\x9\x9\11\11\x46\x52\x4f\x4d\40{$table_prefix}\160\157\x73\x74\163\137\142\141\163\145\40\101\123\x20\160\x62\12\11\x9\x9\11\11\x49\116\116\x45\x52\x20\112\x4f\x49\x4e\40\50\x53\105\x4c\x45\x43\124\40\52\40\106\122\117\115\x20{$table_prefix}\x70\x6f\163\x74\x73\x5f\164\x65\x78\164\x20\x57\110\x45\122\105\x20\154\141\156\x67\x75\141\x67\x65\137\x69\x64\40\x3d\40\72\114\101\116\x47\x55\101\x47\x45\x5f\x49\x44\x20\101\116\104\40\164\x69\164\154\x65\x20\x4c\111\x4b\105\40\x3a\x54\x49\124\114\x45\40\x41\x4e\x44\x20\x61\x64\144\151\x74\151\x6f\156\x20\114\x49\113\105\x20\72\101\x44\104\x49\124\111\117\x4e\x20\x41\x4e\x44\40\143\x6f\x6e\x74\x65\x6e\x74\40\114\x49\113\x45\x20\72\103\117\116\x54\x45\116\124\40{$qsc_text}\51\40\101\x53\x20\x70\164\xa\11\x9\11\11\11\x9\117\116\40\x70\142\56\151\144\x20\75\40\x70\164\56\x62\x61\x73\x65\137\x69\144\x20\101\116\x44\40\160\x62\56\166\x65\162\163\x69\157\x6e\x20\x3d\40\160\164\x2e\142\141\x73\x65\x5f\166\145\x72\x73\151\157\156\12\11\x9\x9\11\x57\110\105\122\105\xa\x9\11\11\11\x9\160\x62\x2e\x63\x75\x72\x72\145\156\164\137\146\154\147\x20\x3d\x20\x31\12\x9\11\11\11\11\x41\116\x44\40\x70\142\x2e\x64\x65\x6c\145\x74\145\137\146\x6c\147\x20\x3d\x20\60\xa\x9\x9\x9\11\x9\x41\x4e\x44\x20\160\142\x2e\x70\141\162\x65\x6e\x74\137\151\144\40\x3d\40\x30\xa\11\11\x9\x9\11\101\116\x44\40\x70\142\56\x73\151\164\145\137\151\144\x20\x3d\40\72\x53\x49\x54\105\137\111\x44\12\x9\11\11\11\11{$qsc_status}\xa\x9\x9\11\11\11{$qsc_publish_datetime}\xa\11\x9\x9\x9\x9{$qsc_publish_end_at}\xa\x9\11\11\x9\x9{$qsc_posttype_id}\xa\11\11\x9\11\x9{$qsc_publish_year}\xa\11\x9\11\x9\x9{$qsc_publish_month}\xa\x9\x9\x9\x9\11{$qsc_publish_day}\12\11\11\11\11\11{$qsc_date_from}\12\11\x9\x9\x9\x9{$qsc_date_to}\12\x9\11\11\x9\11{$qsc_category_id}\12\11\x9\x9\11\x9{$qsc_tag_id}\12\x9\x9\11\x9\11{$qsc_exclude_category_id}\12\11\x9\11\11\11{$qsc_exclude_tag_id}\12\11\x9\11\x9\x9{$qsc_exclude_id}\12\11\x9\x9\x9\x9{$qsc_anchor_equal}\12\11\x9\x9\x9\11{$qsc_anchor_morethan}\xa\x9\11\x9\x9\11{$qsc_anchor_lessthan}\xa\x9\11\x9\11\x9{$qsc_created_by}\12\x9\x9\x9\11\x9{$qsc_grouped_by}\12\11\x9"; $read_count = $pdo->prepare($sql); $read_count->bindValue("\72\x4c\101\x4e\x47\125\x41\x47\105\x5f\x49\104", $language_id, PDO::PARAM_INT); foreach ($texts as $key => $value) { $read_count->bindValue("\72\124\x45\130\124" . $key, "\45{$value}\45", PDO::PARAM_STR); } $read_count->bindValue("\x3a\x54\x49\124\114\x45", $title, PDO::PARAM_STR); $read_count->bindValue("\x3a\101\104\104\x49\x54\x49\x4f\116", $addition, PDO::PARAM_STR); $read_count->bindValue("\72\103\x4f\x4e\124\105\116\x54", $content, PDO::PARAM_STR); $read_count->bindValue("\x3a\123\x49\x54\x45\137\x49\x44", $site_id, PDO::PARAM_INT); $read_count->execute(); if ($record = $read_count->fetch(PDO::FETCH_ASSOC)) { $posts["\157\x75\164\x6c\x69\x6e\x65"]["\x63\x6f\x75\156\164\x5f\x74\x6f\164\x61\154"] = $record["\x63\157\165\156\x74"]; $posts["\157\x75\164\x6c\x69\x6e\x65"]["\154\151\155\151\x74"] = $limit; $pages = $limit ? ceil($record["\143\157\x75\x6e\164"] / $limit) : 1; $posts["\x6f\165\164\154\151\x6e\x65"]["\x70\x61\x67\x65\163"] = $pages; } unset($read_count); } catch (PDOException $e) { var_dump($e->getMessage()); } $posts["\x6c\151\163\164\x5f\x69\x6e\144\x65\170"] = array(); if ($with_list_index) { try { $sql = "\12\x9\x9\11\x9\11\x53\x45\114\x45\103\x54\xa\11\11\11\11\11\11\160\x62\x2e\151\x64\x20\101\x53\40\47\151\x64\x27\54\xa\11\x9\11\x9\11\x9\x70\x62\56\x68\141\x73\x68\137\151\144\40\101\123\x20\47\x68\141\163\x68\x5f\x69\x64\47\x2c\xa\11\11\x9\11\x9\x9\x70\x62\56\x70\145\162\x6d\x61\x6c\x69\156\x6b\137\153\x65\x79\40\x41\x53\40\47\160\x6f\163\164\137\153\x65\x79\x27\x2c\12\11\x9\x9\x9\11\x9\x6e\x75\154\154\x20\101\x53\x20\47\160\145\x72\x6d\141\x6c\151\x6e\x6b\47\54\12\x9\11\11\x9\x9\x9\x70\x62\x2e\x70\x65\x72\x6d\141\154\151\x6e\153\137\165\x72\x69\40\101\x53\40\47\x70\x65\x72\155\141\154\151\156\153\137\x75\x72\151\47\x2c\xa\x9\x9\11\x9\11\11\160\142\56\x73\154\x75\147\40\x41\x53\40\x27\x73\x6c\165\147\x27\54\12\11\11\11\11\11\x9\x70\142\x2e\x65\x79\145\x63\x61\164\143\150\x20\x41\123\40\x27\145\171\x65\x63\x61\x74\143\150\x5f\162\x61\167\47\x2c\12\x9\11\x9\x9\x9\11\x6e\x75\x6c\x6c\x20\x41\x53\40\x27\x65\171\x65\x63\141\x74\x63\150\x27\x2c\12\11\11\11\x9\11\11\160\164\x2e\164\151\164\x6c\x65\40\x41\123\x20\47\x74\151\164\154\x65\47\xa\x9\x9\11\x9\11\x46\x52\117\115\x20{$table_prefix}\x70\157\x73\164\163\x5f\142\141\x73\145\x20\x41\x53\40\160\142\xa\11\11\x9\x9\x9\x9\x49\116\x4e\105\x52\40\112\117\111\x4e\x20\x28\123\x45\114\105\103\x54\40\52\40\x46\122\117\x4d\x20{$table_prefix}\160\x6f\163\x74\163\x5f\164\x65\170\x74\40\x57\x48\x45\122\105\40\x6c\x61\156\x67\165\141\x67\x65\x5f\151\x64\40\x3d\x20\x3a\114\101\116\x47\125\101\x47\x45\x5f\111\104\40\101\116\104\x20\x74\151\x74\154\x65\x20\114\x49\x4b\x45\40\72\x54\x49\x54\114\x45\40\101\x4e\x44\40\141\x64\x64\x69\164\151\157\x6e\x20\x4c\x49\x4b\105\x20\72\101\x44\x44\111\124\111\x4f\x4e\x20\x41\116\x44\40\143\x6f\156\x74\145\156\x74\x20\114\111\113\x45\x20\72\x43\x4f\116\x54\105\x4e\124\x20{$qsc_text}\51\x20\101\123\40\160\x74\xa\11\11\x9\11\x9\x9\11\117\116\x20\x70\142\56\x69\x64\40\x3d\40\x70\164\56\x62\141\163\145\x5f\x69\144\x20\101\116\104\x20\x70\x62\x2e\x76\x65\162\163\x69\x6f\156\x20\75\x20\x70\x74\56\142\x61\x73\145\137\166\x65\x72\163\151\157\x6e\12\11\x9\x9\x9\x9\127\x48\105\122\x45\xa\11\11\11\11\11\11\x70\142\56\x63\165\x72\162\145\x6e\164\x5f\146\x6c\x67\40\75\40\x31\12\11\x9\11\11\x9\x9\x41\116\104\40\x70\x62\x2e\x64\x65\x6c\145\164\145\137\146\154\x67\40\x3d\40\x30\xa\11\x9\x9\x9\x9\11\101\116\104\x20\160\142\56\160\141\162\x65\x6e\164\137\x69\x64\x20\x3d\40\x30\xa\x9\x9\11\11\x9\11\x41\116\x44\x20\x70\x62\56\x73\151\x74\145\x5f\x69\x64\40\x3d\40\72\x53\x49\124\x45\x5f\x49\x44\12\11\11\11\x9\x9\11{$qsc_status}\12\40\x20\40\40\x20\x20\40\40\x20\x20\40\40{$qsc_publish_datetime}\xa\40\40\x20\40\x20\40\x20\x20\x20\x20\x20\x20{$qsc_publish_end_at}\12\x9\11\x9\11\11\11{$qsc_posttype_id}\12\x9\x9\11\11\x9\x9{$qsc_publish_year}\xa\11\11\11\11\x9\11{$qsc_publish_month}\xa\x9\x9\11\x9\x9\x9{$qsc_publish_day}\12\11\11\x9\x9\11\x9{$qsc_date_from}\xa\x9\11\11\11\11\x9{$qsc_date_to}\xa\11\11\x9\11\11\11{$qsc_category_id}\xa\11\x9\x9\11\11\11{$qsc_tag_id}\12\11\11\11\x9\11\x9{$qsc_exclude_category_id}\12\11\11\11\11\11\11{$qsc_exclude_tag_id}\xa\x9\x9\x9\x9\11\x9{$qsc_exclude_id}\xa\x9\x9\x9\11\x9\11{$qsc_anchor_equal}\xa\11\11\x9\11\11\x9{$qsc_anchor_morethan}\xa\x9\x9\x9\x9\11\x9{$qsc_anchor_lessthan}\xa\11\x9\11\11\11\11{$qsc_created_by}\12\11\11\11\11\11\x9{$qsc_grouped_by}\12\x9\11\x9\11\11\x4f\122\x44\105\x52\x20\x42\x59\x20{$query_orderby}\12\x9\x9\x9"; $read_count = $pdo->prepare($sql); $read_count->bindValue("\x3a\x4c\x41\116\107\125\101\107\105\x5f\111\104", $language_id, PDO::PARAM_INT); foreach ($texts as $key => $value) { $read_count->bindValue("\72\124\105\130\x54{$key}", "\45{$value}\45", PDO::PARAM_STR); } $read_count->bindValue("\72\124\111\x54\x4c\105", $title, PDO::PARAM_STR); $read_count->bindValue("\x3a\x41\x44\104\111\x54\111\117\116", $addition, PDO::PARAM_STR); $read_count->bindValue("\72\103\x4f\116\x54\105\x4e\x54", $content, PDO::PARAM_STR); $read_count->bindValue("\x3a\123\111\x54\x45\x5f\x49\x44", $site_id, PDO::PARAM_INT); $read_count->execute(); $list_index_i = 1; while ($record = $read_count->fetch(PDO::FETCH_ASSOC)) { $record["\145\171\x65\x63\141\x74\x63\x68"]["\x73\162\x63"]["\x78\x31"] = $record["\145\x79\145\x63\141\x74\143\x68\137\x72\141\167"]; $record["\x65\x79\145\143\x61\x74\143\x68"]["\163\x72\x63"]["\x78\62"] = str_replace("\57\61\x78\x2f", "\57\x32\170\x2f", $record["\145\171\x65\143\141\164\x63\150\137\162\141\x77"]); $uri_arr = explode("\57", $record["\x65\x79\x65\143\141\x74\143\150\x5f\162\x61\x77"]); $record["\x65\x79\145\143\141\164\x63\x68"]["\146\x69\154\145\x5f\x6e\141\155\x65"] = preg_replace("\x2f\x5c\77\166\x3d\x5c\x64\x2a\44\57", '', end($uri_arr)); if (!empty($record["\x65\171\x65\143\141\x74\143\x68\137\162\141\x77"]) && !empty($eyecatch_frame)) { $record["\145\x79\145\x63\141\x74\x63\x68"]["\x73\162\x63"]["\x78\61"] = str_replace("\57\x66\162\x5f\x61\x64\155\151\x6e\x2f\145\171\x65\x63\x61\x74\x63\x68\57", "\57" . $eyecatch_frame . "\x2f", $record["\x65\171\x65\x63\x61\x74\143\x68"]["\x73\162\143"]["\x78\61"]); $record["\145\171\x65\143\141\164\143\x68"]["\163\x72\x63"]["\x78\x32"] = str_replace("\57\x66\x72\x5f\x61\144\x6d\151\x6e\57\145\171\145\x63\141\164\x63\x68\57", "\57" . $eyecatch_frame . "\x2f", $record["\x65\x79\145\143\141\x74\143\150"]["\163\162\x63"]["\170\62"]); } unset($record["\145\x79\x65\x63\141\x74\143\x68\137\x72\x61\x77"]); $record["\x70\x65\x72\155\x61\154\151\156\x6b"] = $permalink_base . $record["\160\x65\162\x6d\x61\154\151\156\153\137\x75\x72\x69"]; $posts["\x6c\x69\x73\164\137\x69\x6e\x64\145\170"][$list_index_i] = $record; $list_index_i++; } unset($read_count); } catch (PDOException $e) { var_dump($e->getMessage()); } } if (!empty($posts["\x6f\165\164\x6c\x69\156\145"]["\143\x6f\x75\156\164\137\164\157\164\141\x6c"])) { try { $sql = "\xa\11\x9\11\x9\11\123\105\x4c\x45\103\x54\xa\11\x9\11\x9\x9\x9\160\x62\x2e\x69\x64\x20\101\x53\x20\47\x69\x64\x27\x2c\12\x9\x9\x9\x9\x9\11\x70\x62\56\150\141\163\x68\137\151\144\40\x41\x53\x20\x27\x68\x61\x73\150\x5f\x69\x64\x27\x2c\xa\x9\11\x9\11\11\x9\x70\x62\x2e\x70\145\x72\x6d\141\154\x69\x6e\x6b\137\153\x65\171\x20\x41\x53\40\x27\160\x6f\163\164\x5f\153\145\x79\47\54\xa\11\11\x9\11\x9\11\160\x62\x2e\x76\x65\162\163\x69\x6f\x6e\x20\x41\123\x20\x27\166\145\162\163\151\157\x6e\x27\54\12\x9\x9\x9\x9\x9\11\x6e\165\154\x6c\x20\101\x53\x20\x27\x70\x65\x72\155\141\154\x69\x6e\x6b\47\54\xa\x9\x9\11\11\11\11\x70\142\56\160\145\162\x6d\x61\x6c\x69\x6e\x6b\x5f\x75\x72\x69\40\x41\x53\x20\x27\160\x65\x72\155\141\x6c\x69\156\x6b\137\x75\162\151\x27\x2c\xa\x9\11\11\x9\x9\x9{$qsi_publish_datetime}\x20\x41\x53\40\47\160\165\142\x6c\151\x73\x68\137\144\x61\164\145\x74\x69\155\x65\x27\54\12\11\11\x9\x9\x9\x9{$qsi_publish_date}\x20\x41\123\40\x27\x70\x75\142\x6c\151\x73\150\137\144\x61\x74\x65\x27\x2c\12\x9\x9\x9\x9\11\x9\x70\x62\56\x70\x75\142\154\x69\x73\150\x5f\x65\156\144\x5f\x61\x74\40\101\x53\x20\x27\x70\x75\x62\x6c\x69\163\x68\x5f\145\x6e\x64\x5f\x61\164\47\54\12\x9\11\11\x9\11\11\160\x62\56\160\x61\162\x65\x6e\x74\137\x69\x64\x20\101\x53\40\x27\160\141\162\x65\x6e\x74\137\151\x64\x27\x2c\12\x9\x9\11\x9\x9\11\160\x62\x2e\141\x6e\143\x68\157\x72\x20\x41\x53\40\47\x61\x6e\143\x68\x6f\162\x27\54\12\x9\11\11\11\x9\x9\x70\x62\x2e\x63\162\145\141\164\x65\144\x5f\142\x79\x20\x41\x53\x20\x27\141\165\x74\150\x6f\x72\x5f\x69\x64\x27\x2c\12\x9\x9\x9\11\x9\11\x75\x73\56\156\151\143\x6b\156\x61\155\x65\x20\x41\x53\x20\x27\141\x75\164\150\x6f\x72\47\x2c\xa\x9\x9\x9\x9\x9\11\x70\142\x2e\143\162\x65\x61\164\x65\x64\137\141\x74\x20\x41\x53\40\47\143\162\x65\141\x74\x65\x64\137\141\x74\x27\54\xa\11\x9\11\x9\x9\x9\160\142\56\165\160\144\141\164\x65\144\x5f\141\164\x20\101\x53\x20\47\x75\x70\x64\141\x74\145\144\x5f\x61\x74\47\54\12\x9\11\11\11\x9\x9\x70\142\x2e\163\154\x75\x67\40\101\123\x20\47\x73\154\x75\x67\x27\x2c\xa\x9\11\x9\x9\x9\x9\x70\142\x2e\x65\x79\145\x63\141\164\143\150\40\101\x53\40\47\x65\171\x65\143\141\x74\x63\x68\137\x72\x61\x77\x27\54\xa\x9\11\x9\11\x9\x9\156\x75\154\x6c\40\x41\x53\x20\47\x65\171\145\143\141\x74\x63\150\x27\54\12\11\11\11\x9\11\x9\x70\164\x2e\164\x69\x74\x6c\145\x20\x41\x53\x20\x27\x74\x69\164\154\145\47\54\12\11\x9\x9\11\11\x9\160\x74\56\x61\144\144\151\164\151\x6f\x6e\x20\101\123\x20\47\144\x65\x73\x63\x72\151\x70\164\151\157\156\x27\x2c\xa\x9\x9\11\x9\x9\11\x70\164\56\x61\144\144\x69\x74\151\157\156\40\101\x53\40\x27\141\x64\144\x69\164\x69\157\156\47\x2c\12\11\x9\x9\x9\11\x9\x70\164\56\143\157\x6e\x74\x65\x6e\x74\x20\x41\x53\40\x27\x63\157\x6e\164\145\x6e\164\x27\x2c\12\11\11\x9\x9\11\11\60\x20\x41\x53\40\47\143\157\x6e\164\x65\156\164\137\x63\x75\x74\137\x66\154\x67\x27\x2c\12\11\x9\x9\x9\x9\x9\160\142\x2e\143\141\164\x65\147\x6f\x72\x79\137\151\x64\x20\x41\x53\40\x27\x63\x61\x74\145\x67\x6f\162\171\x5f\151\x64\x27\x2c\12\11\x9\x9\x9\11\x9\x70\x62\56\x74\141\x67\137\151\x64\40\101\x53\x20\47\x74\x61\147\137\x69\144\47\54\12\11\x9\x9\11\11\x9\x43\x41\x53\x45\40\x57\x48\x45\116\40\x70\x62\x32\x2e\x63\157\165\x6e\164\137\143\150\151\154\x64\x72\145\156\40\111\x53\40\x4e\x4f\124\x20\116\125\114\114\40\124\110\105\116\x20\160\x62\x32\x2e\x63\157\x75\x6e\164\x5f\x63\150\151\154\144\x72\x65\x6e\40\x45\x4c\123\x45\40\60\x20\105\x4e\104\40\x41\x53\x20\x27\x63\157\x75\x6e\164\x5f\143\x68\x69\x6c\144\162\145\x6e\47\xa\11\11\x9\11\11\x46\122\x4f\x4d\40{$table_prefix}\160\x6f\x73\164\x73\x5f\142\141\163\x65\x20\101\x53\40\160\x62\12\11\11\x9\11\11\x9\111\x4e\116\105\122\40\112\x4f\111\x4e\x20\x28\x53\105\114\105\x43\x54\40\x2a\40\106\122\117\x4d\x20{$table_prefix}\x70\x6f\163\x74\x73\x5f\x74\145\x78\x74\40\x57\x48\105\122\105\x20\154\x61\x6e\x67\x75\141\147\x65\x5f\151\x64\x20\x3d\40\x3a\114\x41\116\107\125\x41\x47\105\137\x49\104\x20\x41\x4e\104\40\164\x69\164\x6c\x65\x20\114\111\x4b\x45\40\x3a\x54\x49\x54\x4c\x45\x20\x41\x4e\x44\x20\x61\144\144\x69\164\x69\x6f\x6e\x20\114\x49\x4b\105\x20\x3a\x41\x44\x44\x49\124\x49\x4f\x4e\40\x41\x4e\104\40\x63\x6f\x6e\x74\145\156\x74\x20\114\x49\x4b\105\40\72\103\117\116\124\x45\116\x54\x20{$qsc_text}\51\x20\101\x53\x20\x70\x74\xa\11\x9\x9\11\11\11\x9\x4f\116\40\160\x62\56\151\x64\x20\x3d\x20\x70\x74\x2e\142\x61\x73\x65\x5f\x69\144\40\x41\x4e\104\x20\160\x62\x2e\x76\145\162\x73\x69\157\156\40\75\x20\160\164\x2e\x62\141\163\145\137\166\145\x72\x73\x69\157\x6e\xa\x9\x9\x9\x9\x9\x9\x4c\x45\106\x54\40\x4f\x55\x54\x45\x52\40\112\x4f\111\116\40{$table_prefix}\165\163\x65\162\163\40\101\123\x20\x75\163\12\x9\x9\x9\11\x9\x9\11\x4f\x4e\40\160\x62\56\x63\162\x65\141\164\145\144\137\142\x79\40\x3d\x20\165\x73\56\151\x64\12\x9\x9\x9\x9\11\x9\114\x45\x46\124\40\x4f\x55\124\105\122\x20\112\117\111\116\x20\50\123\x45\114\x45\103\x54\x20\x44\x49\x53\x54\111\x4e\x43\x54\x28\160\x61\162\x65\156\164\x5f\x69\144\51\x20\x41\123\40\47\x70\141\162\x65\156\x74\137\x69\x64\x27\54\x20\x60\166\145\162\163\x69\157\x6e\x60\40\101\x53\x20\x27\x76\x65\x72\163\151\157\156\47\x2c\40\103\117\125\x4e\124\50\151\144\x29\x20\101\123\40\47\143\x6f\165\x6e\164\137\143\x68\151\x6c\x64\x72\x65\156\47\40\x46\x52\x4f\x4d\x20{$table_prefix}\160\157\163\164\x73\137\142\x61\163\x65\x20\127\x48\105\x52\x45\40\x63\x75\162\x72\x65\156\164\x5f\146\x6c\x67\40\x3d\40\61\x20\x41\x4e\104\40\144\145\x6c\145\x74\x65\x5f\146\154\147\x20\x3d\40\60\x20\x41\x4e\x44\x20\x73\x74\x61\164\x75\163\x20\75\40\x31\40\101\x4e\104\x20\x70\x61\x72\145\x6e\x74\x5f\151\x64\x20\74\x3e\40\60\x20\x47\x52\x4f\125\120\40\x42\131\x20\x70\x61\x72\145\156\164\137\x69\x64\54\40\166\145\162\163\x69\x6f\156\x29\x20\101\x53\x20\x70\x62\62\xa\11\x9\11\11\11\11\x9\117\116\x20\x70\x62\x2e\x69\x64\40\75\40\160\x62\x32\56\160\141\x72\x65\156\164\x5f\x69\144\x20\101\116\x44\40\x70\142\56\x76\x65\162\163\x69\x6f\x6e\x20\x3d\40\x70\142\x32\56\166\145\162\163\151\x6f\x6e\12\x9\11\11\11\x9\127\x48\x45\122\105\xa\11\11\11\11\x9\x9\x70\142\56\143\x75\x72\162\x65\156\x74\137\x66\154\x67\40\75\40\61\12\11\x9\11\x9\x9\x9\101\x4e\104\40\x70\142\56\144\x65\x6c\x65\164\x65\x5f\146\x6c\x67\40\75\40\x30\xa\11\x9\11\x9\x9\11\101\x4e\104\x20\160\x62\56\x70\141\x72\145\156\164\137\151\144\x20\75\x20\60\xa\11\x9\11\11\11\x9\101\116\104\x20\x70\142\x2e\x73\151\x74\x65\137\x69\x64\x20\75\40\x3a\x53\111\x54\x45\x5f\111\104\xa\x9\11\11\x9\11\x9{$qsc_status}\12\x20\x20\x20\x20\x20\x20\40\x20\40\40\40\x20{$qsc_publish_datetime}\xa\40\x20\x20\40\40\x20\40\x20\40\40\40\x20{$qsc_publish_end_at}\12\11\x9\11\x9\x9\11{$qsc_posttype_id}\xa\11\11\x9\x9\11\11{$qsc_publish_year}\12\11\x9\11\x9\11\x9{$qsc_publish_month}\12\11\x9\x9\x9\x9\x9{$qsc_publish_day}\12\11\x9\11\x9\11\11{$qsc_date_from}\12\11\x9\11\x9\11\11{$qsc_date_to}\xa\11\11\11\11\11\11{$qsc_category_id}\12\x9\11\11\x9\x9\11{$qsc_tag_id}\12\x9\x9\x9\x9\11\x9{$qsc_exclude_category_id}\xa\11\x9\11\11\11\x9{$qsc_exclude_tag_id}\xa\11\x9\x9\11\11\x9{$qsc_exclude_id}\12\11\x9\11\x9\11\x9{$qsc_anchor_equal}\12\x9\x9\11\x9\x9\11{$qsc_anchor_morethan}\xa\11\x9\11\x9\11\x9{$qsc_anchor_lessthan}\12\x9\x9\11\x9\11\11{$qsc_created_by}\xa\11\11\x9\x9\11\11{$qsc_grouped_by}\12\11\x9\11\x9\x9\117\x52\x44\105\x52\x20\102\x59\40{$query_orderby}\xa\x9\11\11\x9\x9{$query_limit}\12\11\11\11"; $read_posts = $pdo->prepare($sql); $read_posts->bindValue("\72\x4c\101\x4e\x47\125\101\107\105\137\111\x44", $language_id, PDO::PARAM_INT); foreach ($texts as $key => $value) { $read_posts->bindValue("\72\124\105\130\x54{$key}", "\45{$value}\x25", PDO::PARAM_STR); } $read_posts->bindValue("\x3a\x54\x49\124\x4c\105", $title, PDO::PARAM_STR); $read_posts->bindValue("\x3a\101\x44\x44\x49\124\111\117\x4e", $addition, PDO::PARAM_STR); $read_posts->bindValue("\x3a\x43\x4f\x4e\124\x45\x4e\124", $content, PDO::PARAM_STR); $read_posts->bindValue("\x3a\123\x49\124\105\137\x49\x44", $site_id, PDO::PARAM_INT); $read_posts->execute(); while ($record = $read_posts->fetch(PDO::FETCH_ASSOC)) { $posts["\x6c\151\163\164"][$record["\151\144"]] = $record; } unset($read_posts); } catch (PDOException $e) { var_dump($e->getMessage()); } foreach ($posts["\x6c\151\x73\x74"] as $post_id => $row) { if ($row["\x70\145\162\155\141\154\x69\x6e\x6b\137\165\162\151"] && $permalink_base) { $posts["\x6c\151\163\164"][$post_id]["\x70\x65\162\155\x61\154\151\156\153"] = $permalink_base . $row["\x70\x65\162\155\141\x6c\151\156\153\137\x75\162\x69"]; } $posts["\154\x69\x73\x74"][$post_id]["\x65\171\x65\x63\x61\164\143\150"]["\163\x72\x63"]["\170\61"] = $row["\x65\x79\145\x63\x61\164\x63\x68\137\x72\x61\167"]; $posts["\154\x69\163\164"][$post_id]["\x65\x79\x65\x63\141\164\143\x68"]["\x73\x72\143"]["\x78\x32"] = str_replace("\57\x31\170\x2f", "\57\x32\170\57", $row["\145\171\x65\143\141\164\x63\x68\x5f\x72\141\167"]); $uri_arr = explode("\x2f", $row["\145\171\145\143\141\164\143\x68\x5f\162\x61\167"]); $posts["\154\x69\x73\164"][$post_id]["\x65\x79\x65\143\x61\164\143\150"]["\146\151\x6c\145\x5f\x6e\141\155\x65"] = preg_replace("\57\134\x3f\166\x3d\x5c\x64\52\44\57", '', end($uri_arr)); if (!empty($row["\145\171\x65\x63\x61\x74\143\150\137\x72\141\167"]) && !empty($eyecatch_frame)) { $posts["\x6c\151\x73\x74"][$post_id]["\x65\171\x65\143\141\164\x63\150"]["\163\162\x63"]["\x78\61"] = str_replace("\57\x66\x72\x5f\x61\x64\155\151\156\x2f\x65\x79\x65\x63\141\164\x63\x68\x2f", "\x2f" . $eyecatch_frame . "\x2f", $posts["\x6c\x69\163\164"][$post_id]["\145\171\145\143\x61\x74\x63\x68"]["\x73\x72\143"]["\170\x31"]); $posts["\154\x69\x73\164"][$post_id]["\x65\171\x65\143\141\x74\143\150"]["\x73\162\143"]["\170\62"] = str_replace("\x2f\x66\162\137\141\144\155\x69\156\57\x65\171\x65\143\141\164\x63\x68\57", "\57" . $eyecatch_frame . "\57", $posts["\x6c\x69\163\x74"][$post_id]["\145\171\145\143\x61\164\x63\150"]["\163\162\143"]["\x78\x32"]); } unset($posts["\x6c\x69\163\164"][$post_id]["\x65\171\x65\x63\x61\164\x63\x68\x5f\x72\141\167"]); if (!empty($row["\x63\x6f\156\164\x65\x6e\164"]) && !empty($content_frame)) { $posts["\x6c\x69\163\x74"][$post_id]["\x63\x6f\156\x74\x65\x6e\164"] = str_replace("\57\146\162\137\155\x61\x69\x6e\57", "\57" . $content_frame . "\57", $row["\x63\x6f\156\164\145\156\x74"]); } if ($content_length > 0) { $line_feed_code = array("\xd\12", "\15", "\xa"); $raw_content = preg_replace("\57\x5c\163\x2f", '', $row["\143\x6f\x6e\x74\145\x6e\164"]); $raw_content = str_replace("\x26\156\x62\x73\x70\73", '', $row["\143\157\156\x74\x65\x6e\x74"]); $raw_content = strip_tags($raw_content); $raw_content = str_replace($line_feed_code, '', $raw_content); $posts["\x6c\x69\x73\164"][$post_id]["\143\x6f\156\164\x65\x6e\164"] = mb_substr($raw_content, 0, $content_length, "\x55\124\x46\55\70"); if (mb_strlen($raw_content, "\125\124\x46\x2d\70") > $content_length) { $posts["\154\151\163\164"][$post_id]["\143\x6f\x6e\x74\x65\x6e\x74\137\143\x75\164\x5f\146\154\x67"] = 1; } } $posts["\154\151\x73\164"][$post_id]["\143\141\x74\x65\147\157\162\151\x65\x73"] = array(); if (!empty($row["\x63\x61\164\145\x67\x6f\162\x79\x5f\151\144"])) { $category_id_arr = explode("\x2c", $row["\x63\141\x74\x65\147\157\x72\x79\x5f\x69\144"]); $categories = array(); foreach ($category_id_arr as $value) { $sql = "\xa\11\x9\11\x9\11\11\x9\123\105\x4c\x45\103\124\12\x9\x9\x9\x9\x9\11\x9\x9\x74\x62\56\x69\144\x20\101\x53\40\x27\164\141\170\x6f\x6e\x6f\155\171\137\151\144\x27\x2c\xa\11\x9\x9\11\x9\x9\x9\x9\164\142\56\x70\141\162\x65\x6e\x74\x5f\x69\144\x20\101\123\40\47\160\141\x72\145\x6e\x74\x5f\151\x64\47\x2c\12\x9\x9\x9\11\11\11\11\11\164\x62\56\163\154\x75\147\40\x41\123\x20\x27\x73\154\165\x67\x27\x2c\xa\11\11\11\11\x9\11\11\11\x74\154\56\154\x61\x62\145\x6c\40\101\x53\40\47\154\x61\142\x65\154\47\x2c\12\x9\x9\11\x9\x9\x9\x9\11\164\142\x2e\154\151\x6e\x65\x5f\157\x72\x64\x65\x72\xa\11\11\x9\11\11\x9\x9\106\122\117\x4d\40{$table_prefix}\x74\x61\x78\157\156\x6f\x6d\x69\145\163\137\x62\x61\x73\x65\x20\101\x53\x20\x74\142\xa\11\11\11\x9\x9\x9\11\11\111\116\x4e\105\x52\40\x4a\117\x49\x4e\40{$table_prefix}\x74\141\x78\157\156\x6f\x6d\x69\x65\163\137\154\x61\x62\x65\x6c\x20\x41\123\x20\164\x6c\xa\x9\x9\11\x9\x9\11\x9\11\x9\117\116\40\164\x62\x2e\x69\144\x20\x3d\40\164\154\x2e\x62\x61\163\145\x5f\151\x64\12\x9\11\x9\11\11\x9\x9\x57\x48\x45\122\x45\40\x74\x62\56\151\x64\40\75\x20\72\103\x41\124\x45\107\117\x52\x59\137\x49\x44\x20\101\x4e\104\40\x74\x6c\56\154\141\156\147\165\141\147\145\x5f\151\x64\40\75\x20\72\x4c\x41\x4e\x47\125\x41\107\105\137\x49\x44\xa\11\11\x9\x9\11"; $read_post_category = $pdo->prepare($sql); $read_post_category->bindValue("\72\x43\101\124\x45\107\x4f\122\x59\137\111\104", intval($value), PDO::PARAM_INT); $read_post_category->bindValue("\72\x4c\101\x4e\107\x55\101\107\105\x5f\x49\104", $language_id, PDO::PARAM_INT); $read_post_category->execute(); while ($record = $read_post_category->fetch(PDO::FETCH_ASSOC)) { $categories[$record["\154\x69\156\x65\137\x6f\162\144\x65\x72"]] = $record; } } unset($read_post_category); ksort($categories); $posts["\x6c\x69\163\164"][$post_id]["\x63\141\164\x65\147\157\x72\x79\x5f\x74\x65\170\x74"] = null; $i_categories = 1; foreach ($categories as $row_category) { $posts["\154\151\x73\x74"][$post_id]["\143\141\164\145\147\157\x72\x69\x65\x73"][$i_categories] = $row_category; $posts["\154\x69\x73\x74"][$post_id]["\x63\x61\x74\x65\147\x6f\162\171\137\164\x65\x78\164"] .= empty($posts["\154\x69\x73\164"][$post_id]["\x63\141\x74\145\x67\x6f\x72\x79\x5f\164\x65\170\x74"]) ? $row_category["\x6c\141\142\145\x6c"] : "\x2c" . $row_category["\154\x61\x62\x65\x6c"]; $i_categories++; } } $posts["\154\151\x73\164"][$post_id]["\164\141\147\163"] = array(); if (!empty($row["\x74\141\147\x5f\151\x64"])) { $tag_id_arr = explode("\x2c", $row["\164\141\x67\137\151\x64"]); $tags = array(); foreach ($tag_id_arr as $value) { $sql = "\12\x9\x9\11\11\11\x9\11\x53\105\x4c\105\x43\124\xa\x9\11\11\x9\11\11\x9\x9\164\142\x2e\x69\x64\40\101\123\x20\x27\164\x61\x78\x6f\156\157\155\171\137\151\x64\47\x2c\xa\x9\11\x9\x9\x9\x9\11\11\164\x62\x2e\x73\154\x75\147\x20\101\123\x20\x27\x73\x6c\x75\x67\x27\x2c\xa\11\x9\11\x9\x9\x9\x9\11\164\x6c\56\x6c\141\x62\145\154\40\101\123\x20\x27\154\x61\x62\145\154\47\54\12\x9\11\x9\11\11\11\11\11\x74\x62\56\154\151\x6e\x65\137\x6f\162\144\145\162\x20\101\x53\x20\x27\154\151\156\x65\137\157\x72\144\x65\162\x27\xa\11\x9\x9\x9\11\x9\x9\x46\122\x4f\x4d\40{$table_prefix}\x74\x61\170\157\156\157\x6d\x69\x65\163\137\x62\x61\x73\x65\40\x41\x53\40\164\x62\12\11\11\x9\x9\x9\11\x9\11\x49\116\116\x45\x52\x20\x4a\x4f\x49\x4e\40{$table_prefix}\x74\141\170\157\x6e\157\155\151\145\163\x5f\x6c\x61\142\x65\154\x20\x41\x53\40\x74\x6c\xa\x9\x9\11\x9\11\x9\x9\11\x9\117\x4e\40\164\x62\x2e\151\144\x20\75\40\x74\154\56\142\141\x73\145\137\x69\144\xa\x9\x9\x9\x9\x9\11\11\x57\x48\105\x52\105\x20\x74\142\x2e\x69\144\x20\75\x20\72\x54\101\107\137\x49\104\x20\x41\116\x44\x20\x74\x6c\56\x6c\x61\x6e\147\165\141\147\145\137\x69\144\x20\x3d\x20\x3a\114\x41\116\107\125\x41\107\105\x5f\x49\104\12\x9\11\11\x9\x9"; $read_post_tag = $pdo->prepare($sql); $read_post_tag->bindValue("\x3a\124\101\107\137\111\x44", intval($value), PDO::PARAM_INT); $read_post_tag->bindValue("\72\x4c\101\x4e\107\125\x41\x47\x45\137\x49\x44", $language_id, PDO::PARAM_INT); $read_post_tag->execute(); while ($record = $read_post_tag->fetch(PDO::FETCH_ASSOC)) { $tags[$record["\154\x69\x6e\x65\137\157\162\144\145\x72"]] = $record; } } unset($read_post_tag); ksort($tags); $posts["\154\151\x73\164"][$post_id]["\164\x61\x67\137\x74\x65\170\164"] = null; $i_tags = 1; foreach ($tags as $row_tag) { $posts["\x6c\151\163\164"][$post_id]["\x74\141\x67\163"][$i_tags] = $row_tag; $posts["\x6c\x69\163\x74"][$post_id]["\164\141\147\137\x74\x65\x78\x74"] .= empty($posts["\x6c\151\163\164"][$post_id]["\x74\x61\147\137\x74\x65\x78\x74"]) ? $row_tag["\154\141\142\145\x6c"] : "\54" . $row_tag["\154\141\x62\x65\x6c"]; $i_tags++; } } } if (!empty($posts) && $with_custom) { foreach ($posts["\154\151\163\164"] as $post_id => $row) { try { $sql = "\12\11\11\x9\11\11\11\x9\123\105\x4c\105\x43\x54\12\11\x9\11\11\11\x9\11\11\x70\143\x2e\154\141\156\x67\x75\141\147\x65\x5f\x69\x64\40\x41\123\40\47\154\141\x6e\147\165\x61\147\145\137\x69\x64\x27\54\xa\x9\11\x9\11\11\11\x9\x9\160\x63\56\143\165\x73\x74\157\x6d\137\x69\164\145\x6d\x5f\x69\x64\x20\101\123\40\47\x63\165\x73\164\157\x6d\x5f\x69\164\145\x6d\137\151\x64\47\x2c\xa\x9\11\x9\x9\11\x9\x9\x9\x63\151\56\163\x6c\165\147\40\x41\x53\40\x27\x63\157\154\165\155\x6e\47\x2c\12\x9\11\x9\x9\x9\11\x9\11\143\151\x2e\x74\x79\160\x65\40\x41\123\40\47\164\171\x70\145\x27\54\12\11\x9\11\11\11\x9\11\11\x63\151\x2e\x63\x68\x6f\x69\x63\145\x73\40\x41\123\x20\x27\143\x68\157\x69\x63\145\163\x27\54\12\x9\11\11\11\x9\11\x9\x9\160\143\x2e\x76\141\x6c\x75\145\x20\x41\x53\40\x27\x76\141\154\165\x65\47\xa\11\x9\x9\11\x9\x9\11\x46\122\117\115\x20{$table_prefix}\143\x75\163\x74\x6f\x6d\x5f\151\x74\x65\155\x73\x20\x41\x53\40\x63\x69\xa\x9\x9\x9\x9\x9\x9\x9\x9\114\x45\106\124\40\117\x55\x54\105\122\40\x4a\117\111\x4e\40{$table_prefix}\160\x6f\163\164\163\x5f\x63\165\163\x74\x6f\x6d\x20\101\x53\40\160\143\12\x9\11\x9\x9\x9\x9\x9\11\11\x4f\x4e\40\x63\151\56\x69\x64\x20\75\40\x70\x63\56\143\x75\x73\164\157\155\x5f\151\x74\x65\155\x5f\x69\144\xa\x9\x9\11\x9\x9\x9\x9\x57\x48\105\122\105\xa\x9\11\x9\x9\x9\x9\11\11\x63\151\56\x73\x74\141\164\x75\163\40\75\x20\x31\xa\11\x9\11\11\x9\11\11\x9\101\x4e\104\40\143\151\56\144\x65\x6c\x65\164\x65\x5f\146\x6c\147\x20\40\40\x3d\40\x30\12\11\x9\x9\11\11\x9\11\11\x41\x4e\x44\x20\160\143\56\142\141\163\145\137\151\144\x20\x20\x20\x20\40\40\x3d\x20\72\102\101\123\105\x5f\x49\x44\12\11\11\x9\11\x9\11\x9\11\x41\x4e\104\x20\160\143\56\142\x61\x73\145\x5f\x76\x65\x72\x73\151\157\156\40\75\40\72\102\x41\123\x45\137\126\105\x52\x53\x49\117\x4e\12\11\11\x9\11\11\11\x9\11\101\116\x44\40\x70\143\x2e\154\x61\x6e\x67\165\x61\147\x65\137\151\144\40\40\75\40\72\114\x41\116\x47\x55\101\x47\x45\x5f\111\x44\xa\11\11\11\x9\11"; $read_post_custom = $pdo->prepare($sql); $read_post_custom->bindValue("\x3a\x42\101\x53\105\137\x49\x44", $post_id, PDO::PARAM_INT); $read_post_custom->bindValue("\72\102\101\123\x45\137\x56\105\122\123\111\x4f\116", $row["\x76\145\162\163\151\x6f\x6e"], PDO::PARAM_INT); $read_post_custom->bindValue("\x3a\114\x41\x4e\x47\x55\x41\x47\x45\137\111\x44", $language_id, PDO::PARAM_INT); $read_post_custom->execute(); while ($record = $read_post_custom->fetch(PDO::FETCH_ASSOC)) { if ($record["\164\x79\x70\145"] == "\x69\155\x61\x67\x65") { if (isset($custom_frame[$record["\x63\x6f\x6c\x75\155\156"]])) { $record["\166\x61\x6c\x75\x65"] = preg_replace("\57\134\x2f\x66\x72\137\50\x61\x75\164\157\x7c\143\x72\157\x70\x29\134\57\x5b\60\55\71\135\x7b\62\x2c\x33\175\134\x2f\x2f", "\57" . $custom_frame[$record["\143\157\154\x75\155\x6e"]] . "\57", $record["\x76\141\154\x75\145"]); } $x1 = $record["\x76\x61\x6c\165\x65"]; $x2 = preg_replace("\57\x5c\57\61\170\134\57\57", "\x2f\62\x78\57", $x1); $key = "\x63\165\x73\164\x6f\x6d\x5f" . $record["\x63\x6f\154\x75\155\156"]; $posts["\154\x69\163\x74"][$post_id][$key]["\163\x72\x63"]["\170\61"] = $x1; $posts["\154\x69\163\164"][$post_id][$key]["\x73\162\x63"]["\170\62"] = $x2; $uri_arr = explode("\57", $record["\166\141\154\x75\145"]); $posts["\x6c\151\163\164"][$post_id][$key]["\146\x69\x6c\x65\x5f\156\x61\155\x65"] = preg_replace("\57\x5c\x3f\166\x3d\134\x64\x2a\x24\57", '', end($uri_arr)); } elseif ($record["\164\171\160\145"] == "\x67\141\x6c\x6c\x65\x72\171") { $urls = array(); $captions = array(); if (preg_match("\x2f\x5c\x6e\x2f", $record["\x76\141\154\x75\x65"])) { $record_arr = explode("\xa", $record["\x76\141\154\x75\x65"]); $urls = $record_arr[0]; $captions = $record_arr[1]; } else { $urls = $record["\166\x61\x6c\165\x65"]; } $urls = make_list_data($urls, "\54", false); $captions = make_list_data($captions, "\54", false); $x_arr = array(); foreach ($urls as $key => $value) { $x1 = $value; $x2 = preg_replace("\x2f\134\x2f\x31\170\134\x2f\x2f", "\x2f\62\x78\57", $x1); $x2_arr[$key] = $x2; $x_arr[$key]["\x73\162\x63"]["\x78\x31"] = $x1; $x_arr[$key]["\163\162\143"]["\170\62"] = $x2; $uri_arr = explode("\57", $value); $x_arr[$key]["\x66\151\154\x65\x5f\x6e\141\155\x65"] = preg_replace("\x2f\x5c\77\x76\x3d\x5c\x64\x2a\44\x2f", '', end($uri_arr)); $x_arr[$key]["\143\141\x70\x74\x69\157\x6e"] = $captions[$key]; } $key = "\x63\x75\x73\x74\157\x6d\137" . $record["\143\x6f\154\x75\x6d\x6e"]; $posts["\154\151\x73\x74"][$post_id][$key] = $x_arr; } else { if ($record["\x74\171\160\145"] == "\163\171\x6e\x74\141\x78") { $record["\166\141\x6c\x75\x65"] = htmlspecialchars($record["\166\141\x6c\165\x65"], ENT_QUOTES); } if ($record["\x74\171\160\x65"] == "\154\x69\163\x74") { $record["\x76\141\x6c\165\x65"] = make_list_data($record["\x76\141\154\165\x65"]); } if ($record["\x74\171\160\145"] == "\164\x61\142\154\x65") { $delimiter = ''; switch ($record["\143\x68\157\x69\x63\145\x73"]) { case "\x63\x6f\x6d\x6d\x61": $delimiter = "\54"; break; case "\x73\x65\x6d\151\x63\157\154\x6f\156": $delimiter = "\x3b"; break; case "\143\157\154\x6f\x6e": $delimiter = "\x3a"; break; case "\x73\x6c\141\163\x68": $delimiter = "\57"; break; case "\x64\157\164": $delimiter = "\56"; break; } $record["\166\141\x6c\x75\x65"] = make_table_data($record["\166\x61\x6c\165\145"], $delimiter); } $key = "\143\165\163\164\x6f\x6d\137" . $record["\143\157\154\165\x6d\156"]; $posts["\x6c\151\x73\164"][$post_id][$key] = $record["\x76\141\x6c\x75\145"]; } } unset($read_post_custom); } catch (PDOException $e) { var_dump($e->getMessage()); } } } if ($count_comments) { foreach ($posts["\154\151\163\164"] as $post_id => $row) { $posts["\x6c\x69\x73\164"][$post_id]["\x63\157\x6d\x6d\x65\156\164\x73"] = array(); $sql = "\xa\x9\11\x9\11\x9\11\x53\105\114\105\103\x54\40\x44\x49\x53\124\x49\116\103\x54\50\x74\171\x70\x65\x29\x20\x41\x53\40\x74\x79\x70\145\54\40\x43\x4f\125\116\124\50\x2a\51\x20\101\x53\x20\x63\157\x75\156\164\xa\x9\x9\11\11\11\x9\106\122\x4f\115\x20{$table_prefix}\143\157\155\x6d\x65\x6e\x74\163\12\x9\11\11\x9\11\11\x57\110\x45\x52\105\xa\11\11\x9\x9\x9\11\x9\144\x65\154\x65\164\145\137\146\154\x67\x20\x3d\40\60\12\11\x9\11\x9\11\11\11\x41\x4e\104\x20\163\164\141\164\x75\x73\40\x3d\x20\x31\12\x9\x9\11\11\x9\x9\11\x41\x4e\x44\x20\x70\x6f\163\164\x5f\151\144\x20\x3d\40{$post_id}\xa\11\x9\11\x9\11\11\11\101\116\104\x20\143\157\155\155\145\x6e\164\x5f\x69\144\40\x3d\40\x30\12\11\11\x9\x9\11\11\107\122\117\125\120\x20\x42\x59\x20\x74\x79\x70\x65\xa\11\x9\11\x9"; $read_count_comment = $pdo->prepare($sql); $read_count_comment->execute(); while ($record = $read_count_comment->fetch(PDO::FETCH_ASSOC)) { $posts["\154\x69\163\164"][$post_id]["\x63\157\155\155\145\x6e\x74\163"][$record["\164\x79\160\x65"]] = $record["\x63\157\165\156\x74"]; } unset($read_count_comment); } } if ($with_counter) { foreach ($posts["\154\x69\x73\x74"] as $post_id => $row) { try { $sql = "\123\105\114\105\103\x54\40\x2a\x20\106\x52\x4f\x4d\40{$table_prefix}\143\157\x75\156\164\145\162\x73\40\x57\x48\105\122\x45\40\x70\157\163\164\137\151\x64\x20\x3d\x20{$post_id}\x20\x4f\x52\104\105\x52\x20\102\x59\x20\164\x79\x70\x65\40\x41\123\x43"; $read_records = $pdo->prepare($sql); $read_records->execute(); while ($record = $read_records->fetch(PDO::FETCH_ASSOC)) { $posts["\154\x69\x73\164"][$post_id]["\x63\x6f\165\156\164\x65\x72"][$record["\x74\171\x70\x65"]]["\x63\x6f\165\x6e\x74"] = $record["\143\157\165\x6e\164"]; $posts["\x6c\x69\x73\164"][$post_id]["\143\157\165\156\x74\x65\x72"][$record["\x74\x79\x70\145"]]["\x75\160\x64\x61\164\145\144\137\141\164"] = $record["\x75\160\144\141\164\x65\x64\137\141\164"]; } unset($read_records); } catch (PDOException $e) { var_dump($e->getMessage()); } } } } $posts["\154\x69\163\164"] = index_fromone($posts["\154\151\163\x74"]); return $posts; } goto LHt9U; xvssZ: function index_fromone_recursive($arr, $recursive_key = "\x63\150\x69\x6c\x64\162\145\x6e") { foreach ($arr as $key => $value) { if (is_array($value)) { $arr[$key] = index_fromone_recursive($value); } } if (isset($arr[$recursive_key])) { $arr[$recursive_key] = index_fromone($arr[$recursive_key]); } return $arr; } goto mKId6; WO03J: require_once dirname(__FILE__) . "\x2f\x2e\x2e\x2f\56\56\57\x2e\56\57\x63\x6c\141\163\x73\57\x48\x61\163\x68\x69\144\163\57\x48\141\163\x68\x69\144\x73\56\160\x68\160"; goto xnUSJ; jotgS: function get_comment_items($post_id, $config = array()) { global $database; global $pdo; global $table_prefix; global $comment_items; global $comment_items_label; $post_id = is_int($post_id) ? intval($post_id) : 0; $comment_id = !empty($config["\x63\157\155\155\x65\156\164\x5f\x69\x64"]) ? intval($config["\143\x6f\155\x6d\145\156\164\137\151\x64"]) : 0; $parent_id = !empty($config["\x70\141\162\x65\x6e\164\137\x69\x64"]) ? intval($config["\160\x61\x72\x65\x6e\164\137\151\x64"]) : 0; $type = !empty($config["\164\x79\x70\145"]) ? $config["\164\x79\x70\x65"] : 1; $excluded_items = !empty($config["\x65\x78\x63\154\x75\144\x65\x64\x5f\x69\x74\x65\155\x73"]) ? $config["\x65\x78\x63\154\165\144\x65\x64\137\x69\x74\x65\x6d\x73"] : array(); if ($post_id) { $site_id = 0; $posttype_id = 0; $sql = "\x53\105\x4c\105\x43\x54\x20\x73\x69\x74\145\x5f\151\x64\x2c\x20\x70\x6f\x73\164\164\x79\160\145\137\151\144\40\106\x52\x4f\x4d\40{$table_prefix}\160\157\x73\x74\163\x5f\142\141\x73\145\40\127\x48\105\122\x45\40\151\144\40\75\40{$post_id}"; $read_records = $pdo->prepare($sql); $read_records->execute(); if ($record = $read_records->fetch(PDO::FETCH_ASSOC)) { $site_id = $record["\163\151\x74\x65\x5f\151\x64"]; $posttype_id = $record["\x70\157\163\164\x74\x79\160\x65\x5f\151\144"]; } unset($read_records); if ($site_id && $posttype_id) { if (!empty($type) && !is_numeric($type)) { switch ($type) { case "\162\x65\x76\x69\x65\x77": $type = 2; break; case "\163\x75\142\160\x6f\x73\164": $type = 3; break; default: $type = 1; break; } } $use_flg = 0; try { $sql = "\12\x9\x9\11\x9\11\x9\x53\x45\114\105\x43\x54\x20\103\x4f\x55\116\x54\50\x2a\x29\40\101\123\x20\47\x75\x73\x65\47\xa\x9\11\x9\11\11\x9\106\x52\x4f\x4d\x20{$table_prefix}\160\157\x73\164\164\171\160\x65\163\x20\x41\123\40\x70\x74\xa\11\11\11\x9\11\11\11\x49\116\116\x45\122\x20\112\x4f\x49\116\40\50\123\x45\114\x45\103\x54\40\160\x6f\163\x74\x74\x79\160\145\x5f\151\x64\54\x20\166\141\x6c\x75\145\40\101\x53\40\47\143\x6f\155\x6d\x65\x6e\x74\137\164\x79\x70\x65\47\x20\106\122\x4f\115\x20{$table_prefix}\x63\x6f\x6e\x66\151\x67\x73\137\x70\157\163\x74\x74\171\x70\145\x20\127\x48\x45\122\105\x20\163\151\x74\x65\137\x69\x64\40\x3d\x20\x30\x20\x41\116\x44\40\151\x74\x65\x6d\40\75\x20\x27\143\157\x6d\x6d\145\156\164\137\x74\171\x70\x65\47\x29\40\x41\123\40\143\146\x70\12\11\x9\11\11\11\x9\x9\x9\x4f\x4e\40\x70\164\x2e\151\144\x20\x3d\x20\143\x66\160\56\160\x6f\163\x74\164\x79\x70\145\x5f\151\x64\xa\x9\11\x9\x9\11\11\127\x48\105\x52\x45\xa\x9\x9\x9\11\11\x9\11\160\x74\x2e\x69\144\x20\x3d\40{$posttype_id}\xa\x9\x9\x9\11\x9\11\11\x41\116\x44\40\143\x66\160\x2e\x63\157\x6d\x6d\145\156\x74\x5f\x74\171\160\145\x20\x4c\111\x4b\x45\x20\x27\x25{$type}\x25\47\xa\x9\x9\x9\x9\11\11\11\x41\116\104\x20\x70\x74\x2e\144\145\154\x65\x74\x65\x5f\x66\x6c\x67\40\x3d\x20\x30\12\x9\11\11\11\x9\x9\11\101\116\x44\40\160\x74\x2e\163\x74\x61\164\x75\163\x20\75\x20\x31\xa\11\x9\11\x9"; $check_use = $pdo->prepare($sql); $check_use->execute(); if ($record = $check_use->fetch(PDO::FETCH_ASSOC)) { $use_flg = $record["\165\x73\x65"]; } unset($check_use); } catch (PDOException $e) { var_dump($e->getMessage()); } $items = array(); if ($use_flg) { $i_item = 0; $temp_order_sort = array(); foreach ($comment_items as $key_item => $row) { if ($type != 2 && $row["\x69\164\x65\x6d"] == "\163\x63\157\x72\x65") { continue; } if (!in_array($row["\151\164\145\x6d"], $excluded_items)) { if (isset($comment_items_label[$row["\151\164\x65\155"]])) { $row["\x6c\141\x62\145\154"] = $comment_items_label[$row["\151\164\145\155"]]; } if ($row["\x69\164\145\x6d"] == "\160\157\x73\164\137\x69\x64") { $row["\144\145\146\141\165\154\x74\137\x76\x61\154\x75\145"] = $post_id; } if ($row["\151\x74\x65\x6d"] == "\x63\x6f\155\x6d\x65\156\164\137\151\x64") { $row["\x64\x65\146\141\x75\154\164\137\166\141\x6c\x75\x65"] = $comment_id; } if ($row["\x69\x74\x65\155"] == "\160\141\162\x65\156\x74\137\151\x64") { $row["\x64\x65\146\x61\x75\x6c\x74\137\166\x61\154\x75\145"] = $parent_id; } if ($row["\x69\x74\x65\155"] == "\x74\171\160\145") { $row["\x64\x65\146\141\165\x6c\x74\137\x76\x61\154\x75\x65"] = $type; } if ($row["\x69\164\x65\x6d"] == "\x73\151\x74\x65\137\151\x64") { $row["\144\145\x66\141\165\x6c\164\x5f\x76\x61\x6c\165\145"] = $site_id; } if ($row["\x69\164\145\155"] == "\160\x6f\x73\164\x74\171\160\x65\137\x69\144") { $row["\x64\x65\x66\x61\165\x6c\x74\x5f\x76\141\x6c\165\145"] = $posttype_id; } $temp_order_sort[] = $row["\x74\145\155\x70\x5f\157\162\x64\x65\162"]; $items[$i_item] = $row; $i_item++; } } array_multisort($temp_order_sort, SORT_NUMERIC, $items); foreach ($items as $key => $row) { unset($items[$key]["\x69\144"]); unset($items[$key]["\164\145\x6d\160\x5f\x6f\162\x64\145\x72"]); } } $items = index_fromone($items); return $items; } } return false; } goto Vd3vZ; vJ_nC: function get_comments($post_id, $config = array()) { global $database; global $pdo; global $table_prefix; if (intval($post_id)) { $type = !empty($config["\164\171\x70\145"]) ? intval($config["\x74\171\x70\x65"]) : 1; $limit = !empty($config["\154\x69\155\151\164"]) ? intval($config["\154\151\x6d\x69\164"]) : 10; $page = !empty($config["\160\141\147\x65"]) ? intval($config["\x70\x61\147\x65"]) : 1; $orderby = isset($config["\157\x72\x64\x65\x72\x62\171"]) ? intval($config["\x6f\x72\144\145\x72\142\171"]) : 1; $date_from = !empty($config["\x64\x61\164\x65\x5f\x66\162\x6f\155"]) ? $config["\144\x61\x74\145\137\x66\x72\157\155"] : null; $date_to = !empty($config["\x64\x61\164\x65\137\x74\157"]) ? $config["\144\141\164\x65\x5f\x74\157"] : null; $children = isset($config["\143\x68\151\x6c\144\162\145\156"]) ? intval($config["\x63\x68\151\154\x64\x72\145\156"]) : 1; $hierarchy = isset($config["\x68\151\x65\162\x61\x72\x63\x68\x79"]) ? intval($config["\150\x69\145\162\x61\x72\143\x68\171"]) : 1; $date_from = !empty($date_from) ? date("\131\55\155\x2d\x64", strtotime($date_from)) : null; $date_to = !empty($date_to) ? date("\131\55\155\x2d\144", strtotime($date_to) + 86400) : null; $offset = ($page - 1) * $limit; $orderby = empty($orderby) ? "\104\105\123\x43" : "\101\123\103"; $qsi_post_datetime = $database == 1 ? "\x53\x55\102\123\x54\122\50\x70\x6f\163\x74\x65\x64\137\x61\164\x2c\40\x31\54\x20\61\66\x29" : "\123\125\x42\x53\x54\x52\x49\116\107\50\x70\157\163\x74\x65\x64\137\141\164\54\x20\61\x2c\x20\x31\66\x29"; $qsi_post_date = $database == 1 ? "\123\x55\x42\x53\124\x52\x28\x70\x6f\x73\164\x65\144\137\141\x74\54\40\61\54\x20\x31\x30\51" : "\123\125\102\x53\x54\122\x49\116\107\x28\x70\157\x73\x74\145\144\x5f\141\164\x2c\x20\x31\x2c\x20\61\60\51"; $qsc_date_from = $date_from ? "\101\x4e\104\x20\160\x6f\163\x74\145\144\137\141\164\40\76\x3d\40\x27{$date_from}\47" : null; $qsc_date_to = $date_to ? "\x41\x4e\104\x20\160\157\x73\x74\145\x64\137\x61\x74\x20\74\40\x20\47{$date_to}\47" : null; $comments = array("\157\165\x74\x6c\x69\156\x65" => array(), "\154\151\163\164" => array()); try { $sql = "\12\11\x9\11\x9\11\123\105\x4c\105\103\124\40\x43\117\x55\x4e\124\x28\52\51\x20\101\x53\x20\x27\x63\157\165\x6e\164\47\12\x9\11\11\11\11\106\x52\x4f\x4d\40{$table_prefix}\x63\157\x6d\155\145\x6e\164\163\12\11\11\11\x9\11\127\x48\105\122\105\xa\x9\x9\11\11\11\11\x70\157\163\x74\137\151\x64\x20\x3d\x20{$post_id}\12\11\11\x9\11\x9\x9\101\116\x44\40\164\171\160\x65\40\75\x20{$type}\12\x9\11\11\11\x9\x9\x41\116\104\40\144\x65\154\145\x74\145\x5f\x66\x6c\147\40\75\x20\60\12\x9\11\11\11\11\11\x41\x4e\104\x20\163\164\x61\x74\x75\x73\40\x3d\40\x31\xa\11\11\11\x9\11\11\101\x4e\x44\x20\x63\157\x6d\155\x65\156\164\137\151\144\40\x3d\x20\60\12\11\11\x9\11\11\x9{$qsc_date_from}\12\11\x9\11\x9\x9\11{$qsc_date_to}\12\x9\11\11"; $read_count = $pdo->prepare($sql); $read_count->execute(); while ($record = $read_count->fetch(PDO::FETCH_ASSOC)) { $comments["\157\165\x74\154\x69\156\145"]["\143\157\165\156\164\x5f\x74\x6f\x74\x61\x6c"] = $record["\143\x6f\x75\x6e\164"]; $pages = ceil($record["\x63\157\165\x6e\164"] / $limit); $comments["\x6f\165\164\154\151\156\145"]["\x70\141\x67\x65\x73"] = $pages; } unset($read_count); } catch (PDOException $e) { var_dump($e->getMessage()); } try { $comments_parents = array(); $parent_ids = array(); $sql_parents = "\xa\x9\x9\11\11\x9\x53\105\114\x45\x43\x54\xa\11\11\11\11\11\x9\x69\144\x20\101\x53\40\47\x69\144\47\x2c\xa\x9\x9\11\x9\11\11\x70\x6f\x73\x74\145\x64\137\141\x74\x20\101\123\40\x27\x70\157\x73\x74\137\144\x61\164\x65\x74\151\x6d\145\x5f\157\162\x69\147\151\156\x61\154\47\x2c\xa\x9\11\x9\x9\x9\11{$qsi_post_datetime}\x20\x41\x53\40\47\x70\157\163\x74\137\x64\141\x74\145\164\x69\155\x65\x27\54\12\x9\x9\x9\x9\11\11{$qsi_post_date}\x20\x41\123\40\47\160\157\x73\164\137\x64\141\x74\x65\x27\54\12\11\11\11\x9\x9\11\x70\x6f\163\164\x5f\151\x64\x20\101\123\x20\47\160\x6f\x73\164\x5f\x69\x64\47\x2c\12\x9\11\11\x9\x9\11\x63\157\155\x6d\x65\156\x74\x5f\x69\x64\40\101\123\40\47\x63\x6f\x6d\155\145\x6e\x74\x5f\151\x64\x27\54\12\x9\x9\x9\11\x9\11\160\141\162\x65\156\164\x5f\151\144\40\101\x53\x20\x27\160\x61\162\x65\156\x74\x5f\151\144\47\x2c\12\11\x9\11\11\x9\x9\163\x69\x74\145\x5f\151\144\x20\x41\x53\x20\47\x73\151\x74\x65\x5f\x69\144\47\54\12\11\11\11\x9\11\11\x70\x6f\163\x74\164\171\160\x65\x5f\151\144\40\x41\x53\40\x27\x70\157\x73\x74\164\171\160\145\137\151\144\x27\54\xa\11\x9\x9\x9\11\x9\164\x79\x70\145\x20\x41\x53\40\47\x74\171\160\145\x27\x2c\xa\11\11\11\11\x9\11\x73\x63\x6f\162\x65\40\101\x53\40\x27\163\143\x6f\162\145\x27\54\12\11\x9\11\11\x9\11\x6e\151\143\x6b\x6e\141\x6d\x65\40\101\x53\x20\x27\156\x69\x63\x6b\156\141\155\x65\x27\54\xa\x9\x9\11\x9\x9\11\x65\155\141\151\154\40\101\x53\40\x27\x65\x6d\x61\x69\x6c\47\54\xa\11\11\x9\x9\x9\x9\145\x79\145\x63\x61\164\x63\150\40\101\x53\x20\47\145\171\x65\143\x61\164\x63\x68\x27\54\xa\11\x9\x9\11\11\x9\164\151\164\154\x65\x20\x41\123\x20\47\x74\x69\164\154\145\47\54\12\x9\11\11\x9\x9\x9\143\x6f\x6e\164\x65\x6e\x74\x20\x41\x53\40\47\x63\x6f\156\164\145\156\x74\47\x2c\12\11\11\x9\11\11\x9\151\x70\x5f\x61\144\144\162\x65\x73\x73\x20\x41\123\40\47\x69\x70\x5f\141\x64\144\x72\145\x73\x73\x27\x2c\xa\11\x9\x9\x9\11\11\x6e\157\x74\145\40\101\x53\40\47\x6e\157\164\x65\x27\12\11\11\11\11\11\106\x52\117\x4d\40{$table_prefix}\143\x6f\155\x6d\145\x6e\164\x73\xa\11\x9\x9\11\x9\127\x48\x45\122\105\xa\x9\x9\11\11\11\11\x70\157\x73\164\137\151\x64\x20\x3d\x20{$post_id}\12\x9\11\11\11\x9\x9\x41\x4e\x44\x20\164\x79\160\x65\40\x3d\x20{$type}\12\x9\x9\11\11\11\x9\101\x4e\104\x20\x64\145\x6c\x65\164\145\137\146\154\x67\40\x3d\40\x30\xa\x9\x9\11\11\x9\x9\x41\x4e\x44\x20\163\x74\141\x74\x75\x73\x20\x3d\40\61\12\x9\11\x9\11\11\11\x41\116\x44\40\x63\157\x6d\155\x65\x6e\x74\137\151\144\x20\75\x20\60\xa\x9\11\11\x9\11\x9{$qsc_date_from}\12\11\11\11\11\11\x9{$qsc_date_to}\12\x9\x9\11\x9\x9\117\122\104\x45\x52\x20\102\x59\x20\x70\x6f\x73\x74\x65\x64\x5f\x61\164\x20{$orderby}\x2c\x20\151\x64\40{$orderby}\12\x9\x9\11\x9\x9\114\111\115\x49\x54\40{$limit}\x20\x4f\106\106\x53\105\124\40{$offset}\xa\11\11\11"; $read_comments = $pdo->prepare($sql_parents); $read_comments->execute(); while ($record = $read_comments->fetch(PDO::FETCH_ASSOC)) { $comments_parents[$record["\x69\144"]] = $record; $parent_ids[] = $record["\x69\144"]; } unset($read_comments); $comments_children = array(); if ($children && !empty($parent_ids)) { $parent_ids = !empty($parent_ids) ? implode("\x2c", $parent_ids) : 0; $sql_children = "\xa\x9\11\11\11\11\x9\123\105\114\x45\x43\124\12\x9\x9\11\x9\x9\11\11\x69\144\40\x41\123\40\47\151\144\x27\54\12\11\11\11\x9\11\x9\11\160\x6f\x73\x74\145\x64\x5f\x61\x74\x20\x41\x53\x20\x27\x70\x6f\x73\164\x5f\x64\141\164\145\x74\151\x6d\145\x5f\x6f\162\151\147\151\x6e\x61\154\47\x2c\12\11\x9\x9\11\x9\x9\x9{$qsi_post_datetime}\40\x41\123\x20\x27\160\x6f\163\164\x5f\x64\141\x74\145\164\151\x6d\x65\x27\54\xa\x9\11\x9\11\x9\11\x9{$qsi_post_date}\x20\101\x53\40\47\x70\157\163\x74\x5f\144\141\x74\145\x27\x2c\xa\x9\11\x9\x9\11\11\11\160\157\163\x74\x5f\x69\144\40\x41\123\x20\47\x70\x6f\163\x74\x5f\x69\144\x27\54\xa\11\11\11\11\11\11\11\143\157\155\x6d\x65\x6e\x74\137\151\144\40\x41\123\40\x27\143\x6f\155\x6d\x65\156\164\137\x69\144\x27\x2c\xa\x9\11\x9\x9\x9\x9\11\160\141\162\x65\x6e\x74\x5f\151\x64\x20\101\123\40\x27\160\141\x72\x65\156\164\x5f\151\x64\x27\54\xa\11\11\x9\11\11\11\11\163\x69\x74\x65\137\151\144\40\101\x53\x20\47\x73\x69\x74\x65\137\151\x64\x27\54\12\x9\x9\11\11\x9\x9\11\160\157\163\x74\164\171\160\x65\x5f\151\144\x20\101\x53\x20\47\160\x6f\163\x74\x74\171\x70\145\x5f\x69\x64\x27\x2c\12\11\11\11\11\x9\x9\11\164\171\x70\x65\40\x41\123\40\x27\164\171\160\x65\47\54\12\11\x9\11\11\x9\x9\11\x73\143\157\162\145\x20\101\123\40\47\163\x63\x6f\x72\145\47\54\12\11\11\11\x9\11\x9\11\x6e\x69\x63\x6b\x6e\x61\155\145\40\x41\x53\x20\x27\156\x69\143\x6b\156\x61\x6d\x65\47\x2c\12\x9\x9\x9\x9\11\11\11\x65\155\x61\x69\x6c\40\x41\x53\x20\47\x65\155\141\151\x6c\x27\54\12\11\x9\11\11\11\11\x9\x65\171\x65\143\141\x74\143\x68\40\x41\x53\x20\47\x65\x79\145\143\x61\x74\143\150\47\54\xa\11\11\x9\11\11\11\x9\164\151\164\154\145\40\101\x53\40\47\x74\x69\164\154\145\47\x2c\12\11\11\11\11\11\x9\11\x63\157\156\164\x65\156\164\40\x41\x53\x20\47\143\x6f\156\164\145\x6e\x74\47\x2c\xa\11\x9\11\x9\11\x9\x9\x69\x70\x5f\x61\x64\x64\x72\x65\163\x73\x20\x41\x53\40\x27\x69\160\137\141\144\144\x72\145\x73\x73\x27\54\12\11\11\11\11\x9\11\11\156\x6f\x74\x65\x20\101\x53\40\x27\x6e\157\164\145\47\12\11\11\x9\11\x9\x9\11\x46\x52\x4f\x4d\40{$table_prefix}\143\157\155\155\x65\x6e\x74\163\12\11\x9\11\x9\11\x9\127\x48\105\x52\105\12\x9\x9\x9\11\11\11\11\x64\145\x6c\x65\x74\145\137\x66\x6c\x67\40\75\40\60\xa\x9\11\11\11\x9\11\x9\x41\x4e\x44\x20\x73\x74\x61\164\x75\x73\40\75\40\x31\12\11\11\x9\x9\x9\x9\11\x41\116\104\40\143\x6f\x6d\x6d\145\156\x74\137\151\144\40\x49\116\50{$parent_ids}\x29\12\x9\11\11\x9\11\x9\x4f\x52\x44\x45\x52\x20\102\131\40\x70\x61\x72\x65\x6e\x74\x5f\151\x64\x20\x44\x45\x53\103\x2c\x20\x70\157\163\164\145\x64\x5f\141\164\40{$orderby}\54\x20\151\x64\x20{$orderby}\xa\x9\11\11\11"; $read_comments = $pdo->prepare($sql_children); $read_comments->execute(); while ($record = $read_comments->fetch(PDO::FETCH_ASSOC)) { $comments_children[$record["\x69\144"]] = $record; } unset($read_comments); } $comments["\154\151\x73\164"] = $comments_children + $comments_parents; $comments_fixed = $comments; if ($hierarchy) { foreach ($comments["\154\x69\163\x74"] as $key => $row) { if (array_key_exists($row["\160\141\x72\x65\x6e\x74\x5f\151\x64"], $comments["\154\151\x73\164"])) { $comments_fixed["\x6c\151\x73\164"][$row["\x70\x61\x72\x65\156\x74\x5f\x69\x64"]]["\x63\150\x69\x6c\144\x72\145\156"][$key] = $comments_fixed["\154\151\x73\164"][$key]; unset($comments_fixed["\154\151\x73\164"][$key]); } } } } catch (PDOException $e) { var_dump($e->getMessage()); } $comments_fixed["\154\151\x73\x74"] = index_fromone($comments_fixed["\x6c\x69\x73\x74"]); $comments_fixed["\154\151\163\x74"] = index_fromone_recursive($comments_fixed["\x6c\151\163\164"]); return $comments_fixed; } return false; } goto BzMXE; Wfb0P: function get_contact($contact_id, $config = array()) { global $database; global $pdo; global $table_prefix; $contact_id = intval($contact_id); $language = !empty($config["\x6c\141\x6e\x67\x75\x61\147\x65"]) ? $config["\x6c\141\x6e\147\x75\x61\147\x65"] : null; $language_id = !empty($config["\154\141\x6e\147\165\141\147\145\x5f\151\x64"]) ? $config["\154\x61\x6e\147\165\141\x67\145\137\x69\144"] : 1; if (!empty($contact_id)) { if ($language) { $language_id = 9999; $sql = "\123\x45\114\105\x43\124\40\x69\x64\40\106\x52\117\x4d\40{$table_prefix}\x6c\x61\x6e\147\x75\141\147\145\163\40\x57\x48\105\x52\x45\x20\x73\x6c\x75\x67\x20\75\x20\x27{$language}\x27"; $read_records = $pdo->prepare($sql); $read_records->execute(); if ($record = $read_records->fetch(PDO::FETCH_ASSOC)) { $language_id = intval($record["\x69\144"]); } unset($read_records); } $contact_base = array(); try { $sql = "\xa\11\x9\11\x9\x9\123\x45\114\105\x43\x54\40\x63\x61\x74\x65\147\157\162\x79\x5f\151\144\x2c\40\x74\151\x74\x6c\x65\54\40\143\x6f\x6e\x74\x65\156\164\54\x20\x6e\x61\155\x65\54\40\145\x6d\141\x69\x6c\x2c\40\x74\x65\154\54\x20\143\x6f\156\x74\x61\x63\x74\x65\x64\137\x61\x74\xa\x9\x9\11\x9\11\x46\x52\117\x4d\40{$table_prefix}\x63\157\x6e\x74\141\143\164\163\137\x62\141\x73\x65\xa\11\x9\11\x9\11\x57\110\105\x52\x45\x20\151\x64\40\x3d\x20{$contact_id}\xa\x9\x9\x9"; $read_contact = $pdo->prepare($sql); $read_contact->execute(); if ($record = $read_contact->fetch(PDO::FETCH_ASSOC)) { $contact_base = $record; } unset($read_contact); } catch (PDOException $e) { var_dump($e->getMessage()); } $category_text = null; if (!empty($contact_base["\x63\x61\164\x65\147\x6f\162\x79\137\151\x64"])) { $category_id_arr = explode("\54", $contact_base["\143\x61\x74\145\147\157\x72\171\x5f\151\x64"]); foreach ($category_id_arr as $value) { $category_id = intval($value); $categories_arr = array(); try { $sql = "\12\11\x9\x9\x9\x9\x9\11\x53\x45\x4c\x45\103\124\x20\164\x6c\x2e\x6c\141\x62\x65\x6c\x20\x41\123\40\x6c\x61\142\145\x6c\xa\x9\x9\x9\11\x9\11\x9\x46\122\x4f\115\x20{$table_prefix}\x74\141\170\x6f\156\157\155\x69\x65\x73\x5f\x62\x61\163\145\40\x41\x53\x20\x74\x62\12\x9\11\11\x9\x9\11\11\11\111\x4e\x4e\x45\x52\x20\112\117\111\116\x20{$table_prefix}\x74\x61\x78\157\156\157\155\x69\145\163\x5f\154\141\142\145\x6c\40\x41\123\x20\164\x6c\xa\x9\11\11\x9\x9\11\11\11\x9\117\116\40\164\142\x2e\151\x64\40\75\x20\164\154\56\x62\141\x73\x65\x5f\x69\144\12\11\x9\x9\11\x9\11\x9\127\x48\x45\x52\x45\xa\11\11\11\11\x9\x9\11\11\164\x62\56\x69\x64\40\75\x20\x3a\x49\104\12\11\x9\x9\11\11\11\11\11\101\116\x44\x20\164\154\56\x6c\141\x6e\x67\x75\x61\x67\145\137\x69\x64\40\75\x20\x3a\x4c\101\116\107\125\101\x47\105\x5f\111\x44\xa\x9\x9\x9\x9\11"; $read_categories = $pdo->prepare($sql); $read_categories->bindValue("\72\x49\104", $category_id, PDO::PARAM_INT); $read_categories->bindValue("\72\114\x41\116\107\125\x41\107\x45\x5f\111\104", $language_id, PDO::PARAM_INT); $read_categories->execute(); while ($record = $read_categories->fetch(PDO::FETCH_ASSOC)) { $categories_arr[] = $record["\154\141\x62\145\154"]; } unset($read_categories); } catch (PDOException $e) { var_dump($e->getMessage()); } } $category_text = implode("\x2c", $categories_arr); $tmp_arr["\143\141\164\145\x67\157\x72\x79"] = $category_text; $contact_base = array_merge($tmp_arr, $contact_base); unset($contact_base["\x63\x61\x74\145\x67\157\162\171\137\151\x64"]); } $contact_custom = array(); try { $sql = "\xa\x9\x9\11\11\x9\123\105\114\105\103\124\12\11\11\x9\11\11\x9\x63\151\56\163\154\165\x67\40\x41\x53\40\163\x6c\x75\147\54\xa\x9\x9\x9\x9\11\11\143\143\x2e\x76\141\x6c\165\145\40\101\x53\40\166\x61\x6c\x75\x65\12\11\11\x9\x9\x9\x46\x52\117\x4d\x20{$table_prefix}\143\157\156\164\141\143\164\x73\x5f\143\x75\163\x74\157\x6d\x20\101\x53\x20\x63\143\12\x9\11\11\x9\x9\11\x49\x4e\116\105\122\40\x4a\x4f\111\x4e\40{$table_prefix}\x63\165\x73\x74\x6f\155\x5f\x69\x74\x65\x6d\x73\x20\x41\x53\40\143\x69\12\x9\11\x9\11\11\x9\x9\117\x4e\40\40\143\143\x2e\143\165\x73\164\x6f\x6d\x5f\x69\x74\x65\155\137\151\x64\x20\75\40\143\x69\x2e\x69\x64\12\11\11\x9\x9\11\x57\110\x45\122\x45\12\x9\x9\11\11\x9\x9\143\x63\56\142\x61\163\x65\x5f\x69\x64\40\75\x20{$contact_id}\12\x9\11\11"; $read_contact_custom = $pdo->prepare($sql); $read_contact_custom->execute(); while ($record = $read_contact_custom->fetch(PDO::FETCH_ASSOC)) { $contact_custom[$record["\163\154\165\147"]] = $record["\x76\141\x6c\x75\145"]; } unset($read_contact_custom); } catch (PDOException $e) { var_dump($e->getMessage()); } $contact = array_merge($contact_base, $contact_custom); return $contact; } return false; } goto ER59W; xnUSJ: function index_fromone($arr) { if (is_array($arr)) { array_unshift($arr, 0); unset($arr[0]); } return $arr; } goto xvssZ; ca1_i: function get_image_frames($config = array()) { global $database; global $pdo; global $table_prefix; $type = !empty($config["\x74\x79\160\x65"]) ? $config["\x74\171\x70\x65"] : null; try { $sql = "\xa\11\x9\11\11\x53\105\x4c\105\x43\x54\xa\11\11\11\11\x9\x70\141\x72\145\156\164\137\144\x69\162\40\x41\x53\40\47\160\x61\162\145\x6e\164\x5f\144\x69\x72\47\x2c\xa\x9\11\11\11\x9\x63\x68\x69\x6c\x64\x5f\x64\x69\x72\x20\101\x53\40\x27\143\x68\x69\154\x64\137\x64\x69\x72\x27\54\xa\11\x9\11\x9\11\x74\x79\x70\x65\40\101\x53\40\47\164\x79\x70\x65\x27\x2c\12\11\11\11\11\11\167\151\144\x74\x68\x20\101\x53\40\x27\167\x69\x64\164\150\x27\x2c\xa\x9\11\x9\x9\x9\150\x65\151\x67\150\x74\x20\x41\123\x20\x27\150\145\151\147\150\164\x27\54\12\x9\11\11\x9\11\x63\x6f\155\155\x65\x6e\164\x20\x41\123\x20\x27\143\x6f\x6d\155\x65\156\x74\47\xa\11\11\11\11\106\122\117\x4d\x20{$table_prefix}\151\155\x61\x67\145\x5f\146\162\x61\x6d\145\163\12\11\x9\x9\11\127\x48\x45\122\x45\12\11\11\x9\11\x9\x73\164\x61\x74\165\163\40\x3d\40\61\12\11\x9\x9\11\11\x41\116\x44\x20\x70\141\x72\x65\x6e\164\x5f\x64\x69\x72\40\74\x3e\x20\x27\146\x72\x5f\x61\144\x6d\x69\x6e\x27\xa\11\11\x9\11\x9\x41\x4e\x44\40\x74\171\x70\145\x20\114\111\113\x45\40\47\x25{$type}\45\47\xa\x9\x9\x9\x9\x4f\122\x44\x45\x52\40\102\131\40\160\141\162\x65\156\164\x5f\144\x69\x72\54\x20\x63\x68\x69\x6c\x64\137\144\151\162\40\101\123\103\12\11\11"; $read_image_frames = $pdo->prepare($sql); $read_image_frames->execute(); while ($record = $read_image_frames->fetch(PDO::FETCH_ASSOC)) { $key = $record["\x70\x61\162\x65\156\164\137\x64\151\162"] . "\57" . $record["\x63\x68\151\154\x64\137\144\151\162"]; $image_frames[$key] = $record; } unset($read_image_frames); } catch (PDOException $e) { var_dump($e->getMessage()); } return $image_frames; } goto jotgS; ZB2Y5: function reset_items($items, $targets = array()) { $items_reset = array(); $items_hidden = array(); if (!empty($items) && !empty($targets)) { foreach ($items as $key => $row) { if ($row["\164\x79\160\145"] != "\x68\x69\x64\x64\x65\x6e") { $i_targets = 0; foreach ($targets as $key_target => $label) { if ($key_target == $row["\151\164\x65\155"] && $row["\164\171\160\x65"] != "\x68\x69\x64\x64\x65\156") { $items_reset[$i_targets] = $items[$key]; if (!empty($label)) { $items_reset[$i_targets]["\154\x61\142\145\x6c"] = $label; } break; } $i_targets++; } } else { $items_hidden[] = $items[$key]; } } ksort($items_reset); $items_return = array_merge($items_reset, $items_hidden); $items_return = index_fromone($items_return); return $items_return; } elseif (!empty($items) && empty($targets)) { return $items; } return false; } goto GCO8h; GCO8h: function send_mail($config, $contact = array()) { $php_version = ''; $php_version_arr = explode("\x2e", phpversion()); for ($i = 0; $i < 3; $i++) { $version_string = isset($php_version_arr[$i]) ? sprintf("\45\60\x32\x64", $php_version_arr[$i]) : "\x30\60"; $php_version .= $version_string; } if (!empty($config) && !empty($config["\146\x72\157\155"]) && !empty($config["\164\x6f"])) { $from_name = !empty($config["\146\x72\x6f\155\x5f\156\x61\x6d\145"]) ? $config["\x66\162\x6f\x6d\137\x6e\141\155\145"] : null; $to_name = !empty($config["\164\157\137\156\141\155\145"]) ? $config["\164\x6f\137\156\x61\155\145"] : null; $from = !empty($config["\x66\x72\x6f\155"]) ? $config["\x66\162\x6f\x6d"] : null; $to = !empty($config["\x74\157"]) ? $config["\164\x6f"] : null; $cc = !empty($config["\143\x63"]) ? $config["\143\143"] : null; $bcc = !empty($config["\142\143\143"]) ? $config["\x62\x63\143"] : null; $replyto = !empty($config["\162\145\x70\154\171\x74\157"]) ? $config["\162\x65\x70\154\x79\164\157"] : null; $subject = !empty($config["\x73\165\x62\x6a\145\143\x74"]) ? $config["\163\165\142\152\x65\143\x74"] : null; $body_head = !empty($config["\142\157\x64\171\x5f\150\145\141\x64"]) ? $config["\142\x6f\144\x79\137\150\x65\141\x64"] : null; $body_main = !empty($config["\x62\x6f\x64\171\137\155\141\151\156"]) ? $config["\x62\x6f\x64\171\137\155\141\x69\x6e"] : null; $body_bottom = !empty($config["\142\157\144\x79\137\142\x6f\164\x74\157\155"]) ? $config["\x62\x6f\144\x79\x5f\142\157\x74\164\157\155"] : null; $signature = !empty($config["\163\151\x67\156\x61\164\x75\x72\145"]) ? $config["\163\x69\x67\x6e\x61\164\165\x72\145"] : null; if (!empty($to) && is_array($to)) { $to = implode("\x2c", $to); } if (!empty($cc) && is_array($cc)) { $cc = implode("\x2c", $cc); } if (!empty($bcc) && is_array($bcc)) { $bcc = implode("\54", $bcc); } if (!empty($config["\154\141\x6e\x67\x75\x61\x67\145"])) { switch (mb_strtolower($config["\x6c\x61\156\x67\x75\x61\x67\x65"])) { case "\165\x6e\x69\143\x6f\x64\x65": $language = "\165\156\151"; $encoding = "\x55\124\x46\x2d\x38"; break; case "\165\156\151": $language = "\x75\156\151"; $encoding = "\x55\124\106\55\x38"; break; case "\165\164\146": $language = "\165\x6e\151"; $encoding = "\125\x54\106\x2d\70"; break; case "\x65\x6e\147\x6c\151\163\x68": $language = "\x65\x6e"; $encoding = "\x49\x53\117\x2d\x38\70\x35\x39\x2d\x31"; break; case "\x65\156": $language = "\145\x6e"; $encoding = "\111\123\x4f\55\70\x38\x35\x39\55\x31"; break; case "\x65\x6e\x5f\x65\x6e": $language = "\x65\156"; $encoding = "\111\x53\x4f\55\x38\x38\x35\71\x2d\x31"; break; case "\147\x65\162\155\x61\x6e": $language = "\145\x6e"; $encoding = "\111\123\x4f\55\70\70\65\x39\55\x31"; break; case "\144\145": $language = "\145\x6e"; $encoding = "\x49\x53\117\x2d\70\x38\x35\x39\x2d\61"; break; case "\x64\145\137\x64\145": $language = "\x65\156"; $encoding = "\111\123\117\x2d\x38\x38\65\71\x2d\61"; break; case "\146\x72\145\156\x63\150": $language = "\x65\156"; $encoding = "\111\x53\x4f\55\x38\70\65\x39\55\x31"; break; case "\146\162": $language = "\145\156"; $encoding = "\x49\x53\x4f\55\70\70\x35\71\x2d\x31"; break; case "\146\162\137\146\162": $language = "\145\x6e"; $encoding = "\x49\x53\117\x2d\70\70\65\71\x2d\61"; break; case "\163\x70\141\x6e\151\163\150": $language = "\x65\x6e"; $encoding = "\111\x53\117\55\x38\x38\65\71\x2d\61"; break; case "\145\x73": $language = "\145\x6e"; $encoding = "\111\123\x4f\55\70\x38\x35\71\x2d\61"; break; case "\145\163\x5f\145\163": $language = "\x65\156"; $encoding = "\x49\x53\117\x2d\x38\70\65\71\55\61"; break; case "\151\164\x61\x6c\x69\141\156": $language = "\x65\156"; $encoding = "\111\x53\x4f\55\70\x38\65\x39\55\x31"; break; case "\151\164": $language = "\x65\x6e"; $encoding = "\111\x53\x4f\x2d\70\x38\65\71\x2d\61"; break; case "\151\x74\x5f\x69\164": $language = "\145\156"; $encoding = "\x49\123\117\x2d\x38\70\x35\x39\55\x31"; break; case "\x6a\141\160\141\x6e\145\x73\145": $language = "\152\x61"; $encoding = "\x49\123\x4f\55\62\x30\x32\62\x2d\x4a\x50"; break; case "\152\160": $language = "\152\x61"; $encoding = "\111\x53\117\55\x32\60\x32\x32\x2d\112\x50"; break; case "\x6a\141\x5f\152\x70": $language = "\x6a\x61"; $encoding = "\111\x53\x4f\x2d\x32\x30\x32\62\55\112\x50"; break; case "\152\141": $language = "\x6a\x61"; $encoding = "\x49\123\x4f\55\x32\60\x32\62\x2d\x4a\x50"; break; } } else { $language = "\165\x6e\151"; $encoding = "\125\124\106\55\70"; } if (intval($php_version) >= 50201 && $encoding == "\x49\123\x4f\x2d\62\x30\x32\62\x2d\x4a\x50") { $encoding = "\111\123\117\55\x32\x30\62\62\x2d\x4a\120\x2d\x4d\x53"; } mb_language($language); mb_internal_encoding($encoding); $body = null; if ($to_name) { $body .= $to_name . "\xd\12" . "\15\12"; } if ($body_head) { $body .= $body_head . "\xd\12" . "\xd\xa"; } if ($body_main) { $body .= $body_main . "\xd\xa" . "\15\12"; } if (!empty($contact) && is_array($contact)) { $body .= "\x2d\55\55" . "\xd\xa"; foreach ($contact as $key => $value) { $body .= $key . "\x20\72\40" . $value . "\15\12"; } $body .= "\55\55\x2d" . "\15\12" . "\15\12"; } if ($body_bottom) { $body .= $body_bottom . "\15\xa" . "\15\12" . "\xd\xa"; } if ($signature) { $body .= $signature . "\xd\12" . "\15\xa" . "\15\12"; } $headers = "\x4d\x49\115\105\x2d\126\145\x72\163\x69\157\x6e\72\40\x31\x2e\60\40" . "\15\12"; $headers .= "\x43\157\156\x74\145\156\x74\x2d\x54\x79\160\145\72\x20\164\145\x78\164\x2f\160\154\x61\151\156\x3b\143\x68\141\162\x73\145\164\x3d{$encoding}\40" . "\xd\xa"; $headers .= "\x46\162\x6f\155\72\40" . mb_encode_mimeheader(mb_convert_encoding($from_name, $encoding, "\101\x55\124\117")) . "\x20\x3c" . $from . "\x3e\x20" . "\xd\12"; if (!empty($cc)) { $headers .= "\x43\143\x3a\40" . $cc . "\15\xa"; } if (!empty($bcc)) { $headers .= "\102\x63\x63\x3a\40" . $bcc . "\15\xa"; } if (!empty($replyto)) { $headers .= "\x52\145\160\x6c\x79\55\124\157\72\x20" . $replyto . "\xd\12"; } $subject = mb_encode_mimeheader(mb_convert_encoding($subject, $encoding, "\x41\125\x54\117")); $body = mb_convert_encoding($body, $encoding, "\x41\125\124\x4f"); $result = mail($to, $subject, $body, $headers); if ($result) { return array("\x72\145\x73\165\154\164" => 1, "\150\x74\x74\x70\137\x73\164\141\x74\x75\x73\x5f\x63\x6f\144\x65" => 200, "\145\x72\x72\x6f\x72\137\x70\x6f\151\x6e\x74" => "\x6e\157\x6e\145"); } else { return array("\x72\145\x73\165\x6c\x74" => 0, "\x68\164\x74\x70\137\163\x74\141\164\x75\x73\x5f\x63\x6f\144\145" => 400, "\x65\x72\x72\x6f\162\x5f\x70\x6f\x69\x6e\x74" => "\x73\145\156\144\137\155\141\151\154"); } } return array("\162\145\163\x75\x6c\x74" => 0, "\x68\x74\x74\x70\x5f\163\x74\141\x74\x75\x73\x5f\143\157\x64\x65" => 400, "\145\162\x72\x6f\162\137\160\157\x69\x6e\164" => "\155\x69\x73\x73\151\156\x67\x5f\160\x61\162\x61\155\x73"); } goto Ht8zO; JrWHX: require_once dirname(__FILE__) . "\57\x2e\56\x2f\x2e\56\x2f\x2e\56\x2f\x63\x6c\141\163\x73\57\120\110\x50\115\141\151\154\145\x72\x2f\120\x48\120\x4d\141\x69\154\145\x72\101\x75\164\x6f\154\x6f\x61\144\x2e\160\150\x70"; goto gT5L8; d1jsP: function get_tags($config = array()) { global $database; global $pdo; global $table_prefix; $site = !empty($config["\x73\x69\x74\x65"]) ? $config["\163\151\164\145"] : null; $site_id = isset($config["\163\x69\x74\x65\x5f\x69\x64"]) ? intval($config["\x73\x69\164\145\137\151\x64"]) : 1; $posttype = !empty($config["\160\157\x73\164\164\x79\x70\145"]) ? $config["\x70\157\x73\x74\x74\x79\x70\x65"] : null; $posttype_id = isset($config["\x70\157\x73\164\x74\x79\160\x65\x5f\x69\x64"]) ? $config["\160\157\x73\164\x74\x79\160\145\x5f\x69\x64"] : 1; $language = !empty($config["\x6c\x61\x6e\147\165\141\x67\x65"]) ? $config["\154\x61\156\147\165\x61\x67\145"] : null; $language_id = isset($config["\154\141\x6e\147\x75\x61\147\x65\x5f\151\x64"]) ? intval($config["\x6c\141\156\147\x75\x61\147\x65\x5f\x69\144"]) : 1; $with_count = isset($config["\x77\x69\x74\150\x5f\x63\x6f\165\x6e\164"]) ? intval($config["\x77\x69\x74\150\137\x63\157\x75\x6e\x74"]) : 1; $preview = isset($config["\x70\162\145\166\x69\x65\x77"]) ? intval($config["\x70\x72\x65\x76\x69\x65\x77"]) : 0; $in_use = isset($config["\151\x6e\x5f\x75\x73\x65"]) ? intval($config["\151\156\137\x75\x73\x65"]) : 1; $key_by = !empty($config["\x6b\x65\171\x5f\x62\x79"]) ? $config["\153\x65\171\x5f\x62\x79"] : null; if ($site) { $site_id = 9999; $sql = "\x53\x45\x4c\x45\x43\124\40\x69\x64\40\106\x52\117\x4d\x20{$table_prefix}\x73\x69\164\145\x73\40\127\x48\105\122\x45\x20\144\x65\x6c\x65\164\145\x5f\146\x6c\x67\x20\x3d\x20\60\40\101\116\x44\x20\x73\x74\x61\x74\x75\x73\40\x3d\x20\x31\x20\x41\x4e\x44\40\x73\154\165\147\x20\x3d\40\47{$site}\x27"; $read_records = $pdo->prepare($sql); $read_records->execute(); if ($record = $read_records->fetch(PDO::FETCH_ASSOC)) { $site_id = intval($record["\151\x64"]); } unset($read_records); } if ($posttype) { $posttype_id = 9999; $sql = "\123\105\114\x45\x43\x54\x20\151\x64\x20\x46\122\x4f\x4d\x20{$table_prefix}\160\157\163\164\164\171\160\x65\x73\x20\x57\110\105\x52\x45\x20\x64\x65\154\145\x74\x65\x5f\146\x6c\x67\40\x3d\40\x30\40\x41\x4e\104\x20\x73\164\141\164\165\x73\x20\x3d\40\61\x20\x41\x4e\104\x20\163\154\165\147\x20\75\40\x27{$posttype}\x27"; $read_records = $pdo->prepare($sql); $read_records->execute(); if ($record = $read_records->fetch(PDO::FETCH_ASSOC)) { $posttype_id = intval($record["\x69\144"]); } unset($read_records); } if ($language) { $language_id = 9999; $sql = "\123\105\114\105\103\x54\x20\151\x64\x20\106\x52\117\115\x20{$table_prefix}\x6c\141\156\x67\x75\x61\147\145\x73\40\127\x48\105\122\105\x20\163\154\x75\x67\40\75\40\47{$language}\47"; $read_records = $pdo->prepare($sql); $read_records->execute(); if ($record = $read_records->fetch(PDO::FETCH_ASSOC)) { $language_id = intval($record["\x69\x64"]); } unset($read_records); } $qsc_posttype_id = null; $qsc_posttype_id_post = null; if (!is_numeric($posttype_id) && strpos($posttype_id, "\x2c") !== false) { $posttype_ids = explode("\x2c", $posttype_id); foreach ($posttype_ids as $key => $value) { $posttype_ids[$key] = intval($value); } $posttype_id = implode("\x2c", $posttype_ids); $qsc_posttype_id = "\x41\116\104\40\x74\142\56\x70\157\163\x74\164\171\x70\145\137\151\x64\40\111\x4e\x20\x28{$posttype_id}\51"; $qsc_posttype_id_post = "\x41\x4e\x44\x20\160\x6f\163\x74\x74\171\x70\145\x5f\x69\x64\40\x49\x4e\x20\x28{$posttype_id}\x29"; } elseif (is_numeric($posttype_id)) { $posttype_id = intval($posttype_id); $qsc_posttype_id = "\x41\x4e\104\x20\x74\x62\56\x70\157\x73\164\164\x79\160\x65\137\151\144\40\x3d\40{$posttype_id}"; $qsc_posttype_id_post = "\101\116\x44\40\160\x6f\x73\x74\x74\171\x70\145\137\x69\144\x20\75\40{$posttype_id}"; } $tags = array(); try { $sql = "\xa\11\11\x9\x9\123\x45\x4c\105\103\x54\12\x9\x9\11\x9\11\x74\x62\56\x69\144\x20\x41\x53\x20\47\151\x64\x27\54\12\11\x9\11\11\x9\x74\142\56\x73\154\165\147\x20\101\123\x20\47\163\x6c\165\x67\47\54\xa\11\11\11\11\11\x74\x6c\x2e\154\x61\142\145\x6c\40\101\x53\x20\47\154\141\x62\145\x6c\x27\x2c\xa\11\11\x9\x9\11\x63\166\56\143\x6f\x76\145\162\x5f\x69\155\141\147\145\12\11\x9\11\11\x46\x52\117\115\40{$table_prefix}\164\x61\170\x6f\x6e\157\x6d\151\145\x73\x5f\142\x61\x73\145\40\x41\123\x20\x74\x62\12\x9\11\x9\x9\x9\114\105\x46\x54\x20\x4f\125\x54\x45\x52\40\x4a\117\111\116\40{$table_prefix}\164\x61\x78\x6f\x6e\157\155\151\x65\x73\137\154\141\142\x65\x6c\40\101\123\40\164\x6c\xa\x9\11\x9\x9\11\x9\117\x4e\40\x74\x62\56\151\144\x20\75\40\164\x6c\56\142\141\x73\145\137\x69\144\12\x9\x9\x9\x9\11\114\105\106\x54\40\117\125\124\x45\x52\40\x4a\117\x49\116\x20\50\x53\105\x4c\105\x43\124\40\52\x20\x46\122\117\x4d\40{$table_prefix}\x63\157\166\145\x72\x73\x20\127\110\105\122\x45\x20\145\x6e\164\151\x74\x79\137\x63\x6f\144\x65\x20\x3d\x20\65\x29\40\101\x53\40\x63\x76\xa\x9\x9\x9\x9\x9\x9\x4f\x4e\x20\x74\142\56\151\x64\40\x3d\40\x63\x76\x2e\145\156\164\151\164\x79\x5f\x69\144\12\11\x9\x9\x9\127\x48\x45\x52\x45\xa\x9\11\11\11\11\164\x62\x2e\144\145\x6c\145\x74\x65\x5f\146\154\147\x20\75\40\x30\12\11\11\x9\11\11\101\x4e\x44\40\x74\x62\56\163\164\141\x74\165\x73\x20\x3d\40\x31\12\11\x9\11\x9\x9\x41\116\x44\x20\164\x62\56\x63\x6c\141\163\163\x69\146\x69\x63\141\164\x69\157\x6e\x20\x3d\x20\62\12\11\11\x9\x9\11\x41\x4e\x44\40\x74\x6c\56\154\141\156\x67\165\141\147\145\x5f\151\x64\40\x3d\x20\x3a\114\101\x4e\107\x55\x41\x47\105\137\111\x44\xa\x9\11\x9\x9\x9{$qsc_posttype_id}\12\x9\x9\11\11\x4f\x52\104\105\x52\40\x42\x59\40\x74\x62\56\x70\141\162\x65\156\164\137\x69\x64\40\101\x53\x43\54\40\164\142\56\154\151\156\x65\x5f\x6f\x72\x64\x65\162\x20\x41\123\x43\12\11\11"; } catch (PDOException $e) { var_dump($e->getMessage()); } $read_tags = $pdo->prepare($sql); $read_tags->bindValue("\x3a\x4c\x41\x4e\107\x55\x41\107\105\x5f\111\104", $language_id, PDO::PARAM_INT); $read_tags->execute(); while ($record = $read_tags->fetch(PDO::FETCH_ASSOC)) { $tags[$record["\163\154\x75\147"]] = $record; } if ($with_count || $in_use) { foreach ($tags as $key => $tag) { $now = date("\x59\55\x6d\x2d\144\40\110\x3a\x69\72\x73"); $qsc_status = !$preview ? "\x41\x4e\104\40\163\x74\x61\x74\x75\x73\x20\75\x20\x31" : "\x41\116\104\40\163\x74\141\x74\x75\163\40\x3c\x3d\x20\x32"; $qsc_publish_datetime = !$preview ? "\101\x4e\x44\x20\x70\x75\x62\x6c\151\x73\x68\x5f\x64\x61\164\145\x74\x69\x6d\145\40\74\x3d\40\47{$now}\x27" : null; $qsc_publish_end_at = !$preview ? "\x41\116\x44\x20\x28\x70\x75\x62\x6c\x69\x73\150\137\x65\x6e\144\x5f\x61\x74\x20\76\40\47{$now}\x27\x20\117\122\x20\160\165\142\154\151\x73\x68\137\x65\x6e\x64\x5f\x61\164\x20\x49\x53\x20\x4e\125\x4c\114\x29" : null; $tag_id_text = sprintf("\x25\x30\64\x64", $tag["\x69\x64"]); $sql = "\12\x9\11\11\x9\x9\123\x45\114\x45\103\x54\40\x43\x4f\x55\x4e\124\x28\52\x29\40\x41\x53\40\x63\x6f\165\156\164\12\x9\x9\x9\x9\x9\x46\x52\117\115\x20{$table_prefix}\x70\157\163\x74\163\x5f\142\141\163\145\xa\x9\x9\x9\x9\11\x57\110\x45\x52\105\12\11\x9\x9\11\x9\11\x63\165\162\162\x65\156\164\x5f\146\x6c\147\x20\x3d\40\61\xa\11\x9\11\x9\11\x9\x41\x4e\104\x20\x70\141\162\145\156\164\137\x69\x64\x20\x3d\x20\60\xa\11\x9\11\x9\11\x9\x41\116\104\x20\x64\145\x6c\145\x74\145\x5f\x66\154\147\x20\x3d\x20\60\xa\11\11\x9\11\11\11{$qsc_status}\xa\x9\11\x9\11\x9\11{$qsc_publish_datetime}\12\11\11\11\x9\x9\11{$qsc_publish_end_at}\12\x9\x9\x9\11\x9\11\101\116\104\x20\x73\151\x74\x65\x5f\x69\144\x20\75\x20{$site_id}\12\x9\x9\11\x9\11\11\101\116\104\x20\x74\x61\x67\x5f\x69\x64\40\114\x49\x4b\105\x20\x27\x25{$tag_id_text}\x25\47\12\x9\11\11\x9\x9\x9{$qsc_posttype_id_post}\xa\x9\11\x9"; $read_count = $pdo->prepare($sql); $read_count->execute(); if ($record = $read_count->fetch(PDO::FETCH_ASSOC)) { if ($with_count) { $tags[$key]["\x63\x6f\165\156\x74"] = $record["\x63\x6f\x75\x6e\x74"]; } if ($in_use && $record["\143\x6f\x75\x6e\x74"] == 0) { unset($tags[$key]); } } } } $tags_fixed = array(); if (!empty($key_by)) { if ($key_by == "\151\x64") { foreach ($tags as $row) { $tags_fixed[$row["\x69\x64"]] = $row; } } elseif ($key_by == "\x6c\141\142\x65\x6c") { foreach ($tags as $row) { $tags_fixed[$row["\154\141\142\145\154"]] = $row; } } elseif ($key_by == "\x6e\165\155\x62\145\x72") { $tags_fixed = index_fromone($tags); } else { foreach ($tags as $row) { $tags_fixed[$row["\163\154\165\147"]] = $row; } } } else { foreach ($tags as $row) { $tags_fixed[$row["\163\154\165\x67"]] = $row; } } return $tags_fixed; } goto eORR_; eORR_: function get_sites($config = array()) { global $database; global $pdo; global $table_prefix; $key_by = !empty($config["\153\145\x79\x5f\x62\x79"]) ? $config["\153\145\171\137\x62\x79"] : null; $sites = array(); try { $sql = "\12\x9\x9\x9\x9\x53\105\x4c\105\103\124\12\x9\11\x9\x9\x9\x73\x74\56\x69\144\x20\x41\123\40\x27\x69\x64\47\54\12\11\11\11\x9\11\163\x74\56\156\x61\x6d\x65\x20\x41\x53\40\47\x6c\141\142\145\x6c\47\54\xa\11\x9\x9\x9\11\163\x74\x2e\163\x6c\x75\x67\x20\101\123\x20\x27\163\x6c\165\147\x27\54\xa\x9\11\x9\x9\11\x63\x76\x2e\143\157\x76\x65\x72\x5f\x69\x6d\x61\147\x65\12\x9\x9\11\11\106\122\117\115\40{$table_prefix}\163\151\x74\x65\x73\x20\101\123\x20\163\x74\xa\11\x9\x9\11\11\x4c\105\x46\x54\x20\x4f\125\124\105\122\40\x4a\x4f\x49\x4e\40\x28\123\x45\x4c\105\x43\124\x20\x2a\40\x46\122\x4f\x4d\x20{$table_prefix}\143\x6f\x76\x65\x72\163\x20\127\110\105\122\105\40\x65\156\x74\151\164\x79\x5f\x63\x6f\144\145\x20\x3d\x20\61\x29\40\101\x53\40\143\x76\xa\11\11\x9\11\x9\11\117\116\40\163\164\56\151\144\x20\75\40\x63\166\56\145\156\164\151\164\x79\137\x69\x64\xa\x9\x9\x9\11\127\110\105\x52\x45\12\x9\11\11\11\11\x73\x74\56\x64\145\x6c\x65\164\x65\137\146\x6c\147\40\x3d\x20\x30\12\x9\x9\11\11\x9\x41\116\104\x20\x73\x74\x2e\163\x74\x61\164\x75\163\40\x3d\40\x31\xa\x9\11\11\11\117\x52\104\x45\122\x20\x42\x59\40\x73\164\56\x6c\x69\x6e\145\137\157\x72\144\x65\x72\40\x41\123\x43\xa\11\11"; $read_sites = $pdo->prepare($sql); $read_sites->execute(); while ($record = $read_sites->fetch(PDO::FETCH_ASSOC)) { $sites[] = $record; } unset($read_sites); } catch (PDOException $e) { var_dump($e->getMessage()); } $sites_fixed = array(); if (!empty($key_by)) { if ($key_by == "\x69\144") { foreach ($sites as $row) { $sites_fixed[$row["\151\x64"]] = $row; } } elseif ($key_by == "\x6c\141\142\x65\154") { foreach ($sites as $row) { $sites_fixed[$row["\154\x61\142\145\x6c"]] = $row; } } elseif ($key_by == "\x6e\x75\x6d\x62\145\162") { $sites_fixed = index_fromone($sites); } else { foreach ($sites as $row) { $sites_fixed[$row["\x73\x6c\x75\x67"]] = $row; } } } else { foreach ($sites as $row) { $sites_fixed[$row["\163\x6c\x75\x67"]] = $row; } } return $sites_fixed; } goto giBAt; BzMXE: function get_archives($config = array()) { global $database; global $pdo; global $table_prefix; $site = !empty($config["\x73\x69\164\145"]) ? $config["\x73\151\164\145"] : null; $site_id = isset($config["\163\151\164\x65\137\151\144"]) ? intval($config["\163\x69\164\x65\x5f\151\x64"]) : 1; $posttype = !empty($config["\160\157\163\x74\x74\x79\160\145"]) ? $config["\x70\157\163\x74\164\171\x70\x65"] : null; $posttype_id = isset($config["\160\157\x73\x74\164\171\x70\x65\x5f\151\x64"]) ? $config["\x70\157\x73\x74\x74\x79\160\145\x5f\x69\144"] : 1; $category = !empty($config["\143\x61\164\145\147\x6f\162\171"]) ? $config["\x63\141\x74\145\147\157\x72\171"] : null; $category_id = !empty($config["\x63\x61\x74\145\147\x6f\162\x79\x5f\151\144"]) ? $config["\143\141\164\x65\x67\157\162\x79\x5f\151\x64"] : null; $tag = !empty($config["\164\x61\x67"]) ? $config["\164\x61\x67"] : null; $tag_id = !empty($config["\164\x61\147\x5f\151\x64"]) ? $config["\164\x61\x67\x5f\x69\144"] : null; $exclude_category = !empty($config["\145\170\143\x6c\x75\144\145\x5f\x63\x61\164\x65\147\157\x72\171"]) ? $config["\x65\170\143\154\165\x64\145\137\x63\x61\164\x65\x67\x6f\162\x79"] : null; $exclude_category_id = !empty($config["\145\x78\143\154\165\x64\145\x5f\143\x61\x74\145\147\x6f\x72\171\x5f\151\144"]) ? $config["\x65\170\143\x6c\x75\144\145\137\143\x61\x74\x65\147\x6f\x72\171\x5f\151\x64"] : null; $exclude_tag = !empty($config["\x65\x78\x63\154\x75\144\x65\137\164\x61\x67"]) ? $config["\x65\x78\x63\154\165\144\x65\137\x74\x61\147"] : null; $exclude_tag_id = !empty($config["\x65\x78\143\154\x75\144\x65\x5f\164\x61\x67\x5f\151\144"]) ? $config["\145\x78\143\x6c\x75\x64\x65\x5f\164\141\x67\137\151\144"] : null; $date_from = !empty($config["\144\x61\164\145\x5f\x66\x72\157\x6d"]) ? $config["\144\141\164\x65\137\x66\x72\157\155"] : null; $date_to = !empty($config["\144\141\164\145\137\x74\x6f"]) ? $config["\x64\x61\164\x65\137\164\x6f"] : null; $orderby = isset($config["\157\162\144\145\162\x62\171"]) ? $config["\x6f\162\144\x65\x72\x62\x79"] : 0; $unit = !empty($config["\165\156\x69\x74"]) ? $config["\165\x6e\x69\164"] : null; $preview = isset($config["\160\162\145\x76\x69\x65\167"]) ? intval($config["\160\x72\x65\x76\151\145\167"]) : 0; if ($site) { $site_id = 9999; $sql = "\123\105\114\x45\x43\124\x20\x69\144\40\106\122\117\115\40{$table_prefix}\163\151\x74\145\x73\40\x57\110\x45\x52\x45\x20\144\x65\154\x65\x74\145\137\146\x6c\x67\x20\x3d\x20\x30\40\x41\116\104\40\163\164\141\164\x75\163\40\x3d\x20\61\x20\x41\x4e\x44\40\x73\x6c\x75\147\40\75\40\47{$site}\47"; $read_records = $pdo->prepare($sql); $read_records->execute(); if ($record = $read_records->fetch(PDO::FETCH_ASSOC)) { $site_id = intval($record["\151\144"]); } unset($read_records); } if ($posttype) { $posttype_id = 9999; $sql = "\123\x45\x4c\x45\x43\x54\40\x69\144\x20\x46\122\x4f\x4d\40{$table_prefix}\160\x6f\x73\164\164\x79\160\145\x73\x20\127\x48\105\122\105\x20\x64\x65\154\x65\x74\145\137\x66\x6c\x67\40\75\40\60\x20\101\x4e\x44\40\163\164\141\164\x75\163\x20\x3d\40\61\x20\x41\x4e\104\x20\x73\154\165\147\x20\75\x20\47{$posttype}\47"; $read_records = $pdo->prepare($sql); $read_records->execute(); if ($record = $read_records->fetch(PDO::FETCH_ASSOC)) { $posttype_id = intval($record["\x69\x64"]); } unset($read_records); } $category_ids = array(); if ($category_id) { if (!is_array($category_id)) { $category_id_arr = array_map("\151\156\x74\166\141\x6c", array_map("\x74\162\x69\155", explode("\x2c", $category_id))); foreach ($category_id_arr as $category_id) { $category_ids[] = sprintf("\45\x30\64\x64", $category_id); } } } if ($category) { if (!is_array($category)) { $category_arr = array_map("\164\162\151\155", explode("\x2c", $category)); } else { $category_arr = $category; } foreach ($category_arr as $category) { $sql = "\123\105\x4c\x45\103\x54\40\x69\x64\x20\106\122\117\115\40{$table_prefix}\x74\x61\x78\x6f\156\157\x6d\x69\x65\x73\137\142\141\163\145\x20\x57\110\x45\x52\105\40\x64\x65\x6c\145\x74\145\x5f\x66\154\147\x20\75\x20\60\x20\x41\x4e\x44\40\163\164\x61\x74\165\x73\x20\75\40\x31\40\101\116\104\x20\143\154\x61\x73\163\151\x66\x69\143\x61\164\151\x6f\156\x20\x3d\40\x31\x20\x41\116\104\x20\160\x6f\163\x74\164\x79\160\x65\x5f\151\144\x20\75\40{$posttype_id}\40\x41\116\x44\40\163\x6c\x75\x67\40\x3d\x20\47{$category}\x27"; $read_records = $pdo->prepare($sql); $read_records->execute(); if ($record = $read_records->fetch(PDO::FETCH_ASSOC)) { $category_ids[] = sprintf("\45\60\x34\144", $record["\x69\144"]); } } unset($read_records); } $tag_ids = array(); if ($tag_id) { if (!is_array($tag_id)) { $tag_id_arr = array_map("\151\156\164\x76\x61\154", array_map("\164\x72\x69\x6d", explode("\54", $tag_id))); foreach ($tag_id_arr as $tag_id) { $tag_ids[] = sprintf("\x25\x30\x34\144", $tag_id); } } } if ($tag) { if (!is_array($tag)) { $tag_arr = array_map("\164\162\151\155", explode("\54", $tag)); } else { $tag_arr = $tag; } foreach ($tag_arr as $tag) { $sql = "\123\105\114\x45\x43\x54\x20\151\144\40\106\x52\117\115\x20{$table_prefix}\164\x61\170\x6f\x6e\157\155\x69\145\163\137\x62\141\x73\x65\x20\127\x48\105\122\105\40\x64\145\x6c\x65\x74\145\x5f\x66\x6c\147\40\x3d\x20\60\x20\101\x4e\x44\40\x73\x74\x61\164\x75\163\40\75\40\61\40\x41\x4e\104\40\x63\x6c\141\163\x73\x69\x66\x69\143\141\164\151\157\x6e\40\75\x20\x32\40\101\116\x44\40\160\x6f\163\164\x74\171\160\x65\x5f\151\144\40\75\40{$posttype_id}\x20\x41\116\x44\x20\x73\x6c\165\147\x20\75\40\47{$tag}\x27"; $read_records = $pdo->prepare($sql); $read_records->execute(); if ($record = $read_records->fetch(PDO::FETCH_ASSOC)) { $tag_ids[] = sprintf("\x25\x30\64\x64", $record["\151\144"]); } } unset($read_records); } $exclude_category_ids = array(); if ($exclude_category_id) { if (!is_array($exclude_category_id)) { $exclude_category_id_arr = array_map("\151\x6e\x74\x76\141\x6c", array_map("\164\162\151\x6d", explode("\54", $exclude_category_id))); foreach ($exclude_category_id_arr as $exclude_category_id) { $exclude_category_ids[] = sprintf("\45\x30\64\144", $exclude_category_id); } } } if ($exclude_category) { if (!is_array($exclude_category)) { $exclude_category_arr = array_map("\164\x72\151\155", explode("\54", $exclude_category)); } else { $exclude_category_arr = $exclude_category; } foreach ($exclude_category_arr as $exclude_category) { $sql = "\x53\x45\114\x45\x43\124\x20\x69\144\x20\x46\122\x4f\115\x20{$table_prefix}\164\x61\x78\157\156\x6f\155\151\145\163\137\142\141\x73\145\40\127\110\105\x52\105\x20\144\x65\154\145\164\x65\x5f\x66\154\147\x20\75\x20\x30\40\x41\x4e\x44\40\x73\164\141\164\165\163\x20\75\40\61\x20\x41\116\x44\x20\x63\x6c\141\x73\163\151\x66\151\143\141\x74\x69\157\156\x20\75\40\x31\40\101\x4e\x44\40\x70\x6f\x73\164\164\x79\x70\145\137\151\144\x20\75\40{$posttype_id}\x20\x41\116\x44\40\163\x6c\165\x67\x20\x3d\40\x27{$exclude_category}\x27"; $read_records = $pdo->prepare($sql); $read_records->execute(); if ($record = $read_records->fetch(PDO::FETCH_ASSOC)) { $exclude_category_ids[] = sprintf("\45\60\x34\x64", $record["\x69\x64"]); } } unset($read_records); } $exclude_tag_ids = array(); if ($exclude_tag_id) { if (!is_array($exclude_tag_id)) { $exclude_tag_id_arr = array_map("\151\156\164\x76\x61\x6c", array_map("\x74\162\x69\155", explode("\x2c", $exclude_tag_id))); foreach ($exclude_tag_id_arr as $exclude_tag_id) { $exclude_tag_ids[] = sprintf("\x25\60\x34\144", $exclude_tag_id); } } } if ($exclude_tag) { if (!is_array($exclude_tag)) { $exclude_tag_arr = array_map("\164\162\x69\x6d", explode("\x2c", $exclude_tag)); } else { $exclude_tag_arr = $exclude_tag; } foreach ($exclude_tag_arr as $exclude_tag) { $sql = "\123\x45\x4c\105\103\124\40\x69\144\x20\106\x52\117\115\x20{$table_prefix}\x74\141\x78\x6f\x6e\157\x6d\151\145\x73\137\142\x61\x73\x65\40\x57\x48\105\x52\x45\x20\144\145\154\x65\x74\145\137\146\154\x67\40\75\40\60\40\101\116\104\x20\163\x74\x61\164\x75\x73\x20\75\40\x31\40\x41\116\104\x20\143\x6c\141\x73\x73\151\146\151\x63\x61\164\x69\x6f\156\40\75\40\x32\x20\101\116\x44\x20\160\157\x73\x74\x74\171\x70\x65\137\151\x64\40\75\40{$posttype_id}\40\101\116\x44\40\163\x6c\165\x67\40\75\x20\x27{$exclude_tag}\x27"; $read_records = $pdo->prepare($sql); $read_records->execute(); if ($record = $read_records->fetch(PDO::FETCH_ASSOC)) { $exclude_tag_ids[] = sprintf("\x25\60\x34\144", $record["\x69\144"]); } } unset($read_records); } if ($orderby) { if (strtoupper($orderby) === "\101\123\x43") { $orderby = 1; } elseif (strtoupper($orderby) === "\x44\x45\123\x43") { $orderby = 0; } elseif (intval($orderby) > 0) { $orderby = 1; } else { $orderby = 0; } } $qsc_posttype_id = null; if (!is_numeric($posttype_id) && strpos($posttype_id, "\x2c") !== false) { $posttype_ids = explode("\x2c", $posttype_id); foreach ($posttype_ids as $key => $value) { $posttype_ids[$key] = intval($value); } $posttype_id = implode("\x2c", $posttype_ids); $qsc_posttype_id = "\x41\x4e\x44\x20\160\157\x73\x74\164\171\x70\145\137\x69\144\x20\111\x4e\x20\50{$posttype_id}\x29"; } elseif (is_numeric($posttype_id)) { $posttype_id = intval($posttype_id); $qsc_posttype_id = "\101\116\104\x20\x70\157\163\x74\164\171\x70\x65\137\151\144\40\75\x20{$posttype_id}"; } $date_from = !empty($date_from) ? date("\131\x2d\155\55\144\40\x48\x3a\x69\x3a\163", strtotime($date_from)) : null; $date_to = !empty($date_to) ? date("\131\x2d\x6d\55\x64\40\x48\x3a\x69\72\163", strtotime($date_to)) : date("\x59\55\x6d\55\144\40\x48\72\151\x3a\163"); $qsi_publish_year = $database == 1 ? "\123\x54\x52\106\x54\111\x4d\x45\50\x27\45\x59\47\x2c\40\x70\x75\x62\154\x69\163\x68\137\x64\141\x74\x65\164\151\155\x65\x29" : "\131\105\x41\x52\50\160\165\142\x6c\x69\163\150\137\x64\x61\x74\145\164\x69\155\x65\x29"; $qsi_publish_month = $database == 1 ? "\x53\125\x42\x53\124\x52\50\47\60\47\174\x7c\x53\x54\122\x46\x54\111\115\x45\x28\47\45\155\x27\54\x20\160\x75\142\x6c\151\x73\x68\137\144\x61\x74\x65\164\x69\155\145\51\x2c\40\x2d\62\54\40\62\x29" : "\114\x50\101\x44\50\115\117\116\x54\110\x28\160\165\x62\x6c\151\163\150\137\144\x61\x74\x65\x74\151\155\x65\51\x2c\40\x32\x2c\40\x30\x29"; $qsi_publish_day = $database == 1 ? "\123\x55\102\123\x54\x52\50\47\60\x27\x7c\174\x53\x54\122\106\x54\x49\115\x45\50\x27\x25\x64\x27\x2c\40\160\x75\x62\x6c\x69\163\150\x5f\x64\141\x74\x65\164\151\155\x65\x29\x2c\x20\x2d\x32\54\40\x32\51" : "\x4c\x50\x41\104\x28\104\101\x59\50\160\165\x62\154\x69\x73\x68\137\x64\x61\164\x65\164\x69\155\145\51\x2c\40\62\x2c\40\x30\51"; $qsc_category_id = null; if (count($category_ids)) { $qsc_category_id = "\x41\116\104\40\50"; foreach ($category_ids as $key => $category_id) { if ($key > 0) { $qsc_category_id .= "\x20\117\x52\40"; } $qsc_category_id .= "\x63\141\164\145\x67\157\162\x79\137\x69\x64\40\114\x49\x4b\105\40\x27\45{$category_id}\45\x27"; } $qsc_category_id .= "\x29"; } $qsc_tag_id = null; if (count($tag_ids)) { $qsc_tag_id = "\x41\x4e\104\x20\x28"; foreach ($tag_ids as $key => $tag_id) { if ($key > 0) { $qsc_tag_id .= "\40\x4f\122\40"; } $qsc_tag_id .= "\164\x61\147\137\151\x64\40\x4c\x49\x4b\x45\x20\x27\x25{$tag_id}\45\x27"; } $qsc_tag_id .= "\x29"; } $qsc_exclude_category_id = null; if (count($exclude_category_ids)) { $qsc_exclude_category_id = "\101\x4e\x44\40\x28"; foreach ($exclude_category_ids as $key => $exclude_category_id) { if ($key > 0) { $qsc_exclude_category_id .= "\40\101\x4e\104\40"; } $qsc_exclude_category_id .= "\x63\x61\164\145\147\x6f\162\x79\137\151\144\x20\116\117\x54\40\x4c\x49\x4b\x45\x20\47\45{$exclude_category_id}\x25\x27"; } $qsc_exclude_category_id .= "\x29"; } $qsc_exclude_tag_id = null; if (count($exclude_tag_ids)) { $qsc_exclude_tag_id = "\x41\x4e\104\x20\50"; foreach ($exclude_tag_ids as $key => $exclude_tag_id) { if ($key > 0) { $qsc_exclude_tag_id .= "\x20\x41\116\104\x20"; } $qsc_exclude_tag_id .= "\164\141\147\x5f\x69\x64\x20\116\x4f\x54\40\114\x49\x4b\105\40\x27\45{$exclude_tag_id}\45\x27"; } $qsc_exclude_tag_id .= "\51"; } $qsc_date_from = !empty($date_from) ? "\101\116\104\40\x70\165\142\x6c\x69\163\x68\137\144\x61\164\x65\x74\x69\x6d\145\40\x3e\x3d\40\x27{$date_from}\x27" : null; $qsc_date_to = !empty($date_to) ? "\x41\116\104\40\160\x75\x62\154\x69\163\x68\137\144\141\x74\145\164\x69\155\x65\x20\74\75\x20\47{$date_to}\47" : null; $orderby = empty($orderby) ? "\x44\x45\123\x43" : "\101\x53\x43"; $now = date("\x59\55\155\x2d\144\40\x48\x3a\151\72\x73"); $qsc_status = !$preview ? "\101\116\x44\40\163\x74\141\x74\x75\163\40\x3d\x20\x31" : "\101\116\104\40\x73\164\x61\164\165\x73\40\74\75\x20\62"; $qsc_publish_datetime = !$preview ? "\x41\116\104\40\160\165\x62\x6c\x69\163\x68\137\144\x61\164\145\164\151\x6d\x65\40\74\x3d\x20\47{$now}\47" : null; $qsc_publish_end_at = !$preview ? "\101\116\x44\x20\x28\x70\x75\142\x6c\x69\163\150\137\x65\x6e\144\137\141\x74\40\76\x20\47{$now}\47\x20\x4f\122\x20\160\x75\142\154\x69\x73\150\137\145\156\x64\x5f\141\x74\40\111\x53\40\x4e\x55\x4c\114\x29" : null; $archives = array(); try { $sql = "\12\x9\11\11\11\x53\x45\x4c\105\103\x54\xa\x9\x9\11\x9\x9\x43\117\x55\x4e\124\50\160\x75\142\x6c\x69\x73\150\x5f\x64\x61\164\145\x74\x69\x6d\145\x29\x20\x41\123\x20\x27\x63\x6f\165\x6e\164\47\x2c\xa\x9\x9\x9\11\11{$qsi_publish_year}\x20\x41\x53\40\47\x79\x65\x61\x72\47\x2c\xa\x9\x9\11\11\11{$qsi_publish_month}\x20\x41\123\40\x27\x6d\x6f\x6e\164\x68\x27\54\12\x9\x9\11\11\11{$qsi_publish_day}\40\x41\123\40\x27\x64\x61\x79\47\x2c\12\x9\11\11\11\x9\x44\x41\x54\x45\x28\160\x75\x62\154\151\163\x68\x5f\144\x61\164\145\x74\151\155\145\51\x20\x41\x53\40\47\144\x61\x74\x65\47\xa\x9\11\11\11\x46\122\117\x4d\x20{$table_prefix}\x70\157\x73\x74\x73\x5f\142\x61\x73\145\xa\x9\x9\11\11\127\110\105\x52\x45\xa\x9\x9\x9\11\x9\143\165\x72\x72\x65\x6e\164\137\x66\x6c\x67\40\x3d\x20\x31\12\11\11\x9\11\x9\x41\x4e\x44\x20\x64\x65\x6c\x65\x74\x65\x5f\x66\154\147\40\x3d\x20\x30\xa\x9\x9\11\x9\x9{$qsc_status}\12\11\x9\x9\11\x9{$qsc_publish_datetime}\12\x9\11\x9\x9\11{$qsc_publish_end_at}\12\x9\11\x9\x9\11\x41\x4e\104\40\160\x61\x72\145\x6e\164\137\x69\144\40\75\40\60\12\x9\x9\11\11\x9\101\x4e\104\40\163\x69\x74\145\x5f\151\x64\x20\75\40\x3a\123\111\124\105\137\x49\x44\xa\x9\11\11\11\11{$qsc_posttype_id}\12\x9\11\11\11\x9{$qsc_category_id}\12\x9\x9\x9\11\x9{$qsc_tag_id}\12\11\11\x9\11\11{$qsc_exclude_category_id}\12\x9\x9\x9\11\x9{$qsc_exclude_tag_id}\12\11\11\x9\11\11{$qsc_date_from}\12\11\x9\x9\11\11{$qsc_date_to}\12\x9\11\x9\x9\x47\122\117\x55\x50\x20\102\x59\x20\x79\x65\141\162\x2c\40\155\157\x6e\164\x68\54\x20\144\141\x79\54\x20\x64\141\x74\x65\xa\x9\11\11\x9\x4f\x52\104\x45\122\x20\102\x59\40\x70\x75\142\154\x69\163\150\137\144\141\164\x65\164\151\155\145\x20{$orderby}\xa\11\x9"; $read_archives = $pdo->prepare($sql); $read_archives->bindValue("\x3a\123\111\124\x45\137\111\x44", $site_id, PDO::PARAM_INT); $read_archives->execute(); while ($record = $read_archives->fetch(PDO::FETCH_ASSOC)) { $this_year = sprintf("\x25\x30\x34\144", $record["\171\145\x61\162"]); $this_month = sprintf("\x25\x30\62\144", $record["\155\157\x6e\164\x68"]); $this_day = sprintf("\45\x30\62\144", $record["\144\x61\x79"]); if (!isset($archives[$this_year]["\143\x6f\165\x6e\x74"])) { $archives[$this_year]["\x64\141\164\x65\137\154\x61\x62\145\154"] = $record["\x79\145\141\x72"]; $archives[$this_year]["\x79\145\x61\162"] = $record["\171\x65\x61\x72"]; $archives[$this_year]["\143\157\x75\x6e\x74"] = $record["\143\157\x75\156\164"]; } else { $archives[$this_year]["\143\157\165\x6e\164"] += $record["\x63\157\x75\x6e\x74"]; } if (!isset($archives[$this_year]["\x6d\157\x6e\164\150\x73"][$this_month]["\x63\x6f\165\x6e\164"])) { $archives[$this_year]["\x6d\157\x6e\164\150\163"][$this_month]["\144\x61\164\145\137\154\x61\142\x65\154"] = $record["\x79\145\141\162"] . "\x2d" . $record["\155\x6f\x6e\x74\150"]; $archives[$this_year]["\155\157\156\x74\x68\163"][$this_month]["\171\x65\x61\162"] = $record["\x79\145\141\162"]; $archives[$this_year]["\155\157\x6e\x74\150\x73"][$this_month]["\x6d\x6f\156\x74\x68"] = $record["\x6d\157\156\164\150"]; $archives[$this_year]["\x6d\x6f\x6e\164\150\x73"][$this_month]["\x63\x6f\x75\x6e\164"] = $record["\143\157\165\156\164"]; } else { $archives[$this_year]["\x6d\157\x6e\164\150\163"][$this_month]["\x63\x6f\165\x6e\164"] += $record["\x63\x6f\165\x6e\164"]; } $archives[$this_year]["\155\157\x6e\x74\150\x73"][$this_month]["\144\141\x79\163"][$this_day]["\x64\x61\x74\x65\x5f\154\x61\x62\x65\x6c"] = $record["\x64\141\x74\x65"]; $archives[$this_year]["\155\x6f\156\x74\150\163"][$this_month]["\144\x61\x79\163"][$this_day]["\x79\145\x61\162"] = $record["\x79\145\x61\162"]; $archives[$this_year]["\155\x6f\156\164\x68\163"][$this_month]["\x64\141\x79\163"][$this_day]["\x6d\157\156\164\x68"] = $record["\x6d\x6f\156\x74\150"]; $archives[$this_year]["\155\x6f\x6e\x74\150\x73"][$this_month]["\144\141\171\163"][$this_day]["\x64\141\171"] = $record["\144\x61\171"]; $archives[$this_year]["\155\157\x6e\164\150\163"][$this_month]["\x64\x61\x79\x73"][$this_day]["\x63\157\165\x6e\164"] = $record["\143\x6f\165\156\x74"]; } unset($read_archives); } catch (PDOException $e) { var_dump($e->getMessage()); } if (!empty($archives) && !empty($unit)) { $archives_formatted = array(); if ($unit == "\155\x6f\156\x74\150") { foreach ($archives as $year => $years) { foreach ($years["\155\157\x6e\164\x68\x73"] as $month => $months) { $key = $year . "\55" . $month; $archives_formatted[$key] = $months; } } return $archives_formatted; } if ($unit == "\144\x61\171") { foreach ($archives as $year => $years) { foreach ($years["\x6d\x6f\x6e\164\x68\163"] as $month => $months) { foreach ($months["\x64\x61\171\x73"] as $day => $days) { $key = $year . "\x2d" . $month . "\55" . $day; $archives_formatted[$key] = $days; } } } return $archives_formatted; } } return $archives; } goto HAeJA; mKId6: function substructString($string, $number, $continue_string = "\x2e\56\56") { if (!empty($string) && $number > 0) { $string = preg_replace("\57\134\x72\134\156\x7c\x5c\162\x7c\x5c\156\x2f", '', html_entity_decode(strip_tags($string))); $strlen = mb_strlen($string, "\x55\124\106\x2d\x38"); if ($strlen > $number) { $subtracted_string = mb_substr($string, 0, $number, "\x55\x54\106\x2d\70") . $continue_string; return $subtracted_string; } } return $string; } goto IEopu; HAeJA: function get_categories($config = array()) { global $database; global $pdo; global $table_prefix; $site = !empty($config["\x73\x69\x74\145"]) ? $config["\x73\151\164\145"] : null; $site_id = isset($config["\x73\x69\x74\x65\137\x69\144"]) ? intval($config["\x73\151\164\x65\x5f\x69\x64"]) : 1; $posttype = !empty($config["\x70\x6f\163\164\164\x79\x70\x65"]) ? $config["\x70\157\163\164\164\x79\160\x65"] : null; $posttype_id = isset($config["\160\157\163\164\164\x79\160\145\137\x69\144"]) ? $config["\x70\157\163\164\x74\x79\x70\145\137\151\x64"] : 1; $language = !empty($config["\x6c\x61\x6e\x67\165\141\147\145"]) ? $config["\x6c\141\156\147\x75\x61\x67\x65"] : null; $language_id = isset($config["\x6c\141\x6e\147\165\141\147\x65\137\x69\x64"]) ? intval($config["\x6c\141\156\147\x75\x61\147\x65\137\x69\144"]) : 1; $parent = !empty($config["\160\x61\162\145\156\164"]) ? $config["\x70\141\162\145\156\164"] : null; $parent_id = isset($config["\x70\x61\162\145\156\164\137\151\x64"]) ? intval($config["\x70\x61\162\145\156\164\137\x69\x64"]) : null; $with_count = isset($config["\x77\x69\164\x68\137\x63\157\165\156\164"]) ? intval($config["\x77\x69\164\x68\137\x63\157\x75\156\x74"]) : 1; $preview = isset($config["\x70\x72\145\x76\151\145\167"]) ? intval($config["\160\162\145\166\x69\145\167"]) : 0; $in_use = isset($config["\x69\x6e\137\x75\163\x65"]) ? intval($config["\x69\156\x5f\165\163\145"]) : 1; $key_by = !empty($config["\x6b\x65\171\x5f\x62\171"]) ? $config["\153\145\x79\137\x62\x79"] : null; if ($site) { $site_id = 9999; $sql = "\123\x45\x4c\105\x43\124\x20\151\144\x20\106\x52\x4f\115\x20{$table_prefix}\x73\x69\164\x65\163\x20\127\x48\105\122\x45\40\144\145\x6c\x65\x74\x65\137\146\154\x67\40\x3d\40\x30\40\x41\116\x44\x20\163\164\141\164\x75\x73\40\75\x20\x31\x20\x41\116\104\40\x73\x6c\165\147\40\75\x20\x27{$site}\47"; $read_records = $pdo->prepare($sql); $read_records->execute(); if ($record = $read_records->fetch(PDO::FETCH_ASSOC)) { $site_id = intval($record["\x69\144"]); } unset($read_records); } if ($posttype) { $posttype_id = 9999; $sql = "\x53\105\x4c\x45\x43\124\x20\x69\144\x20\x46\122\117\x4d\40{$table_prefix}\160\x6f\x73\164\164\171\x70\x65\x73\40\127\110\x45\x52\x45\x20\144\145\x6c\145\164\x65\x5f\146\x6c\x67\x20\x3d\x20\60\40\101\116\x44\x20\163\x74\x61\164\x75\163\x20\75\x20\x31\x20\x41\x4e\104\x20\x73\x6c\165\147\40\75\x20\47{$posttype}\47"; $read_records = $pdo->prepare($sql); $read_records->execute(); if ($record = $read_records->fetch(PDO::FETCH_ASSOC)) { $posttype_id = intval($record["\x69\x64"]); } unset($read_records); } if ($language) { $language_id = 9999; $sql = "\123\105\114\x45\103\124\x20\x69\144\x20\x46\x52\x4f\115\40{$table_prefix}\154\x61\156\147\x75\141\x67\x65\x73\x20\127\110\x45\122\x45\40\x73\154\x75\x67\x20\x3d\x20\47{$language}\47"; $read_records = $pdo->prepare($sql); $read_records->execute(); if ($record = $read_records->fetch(PDO::FETCH_ASSOC)) { $language_id = intval($record["\151\144"]); } unset($read_records); } if ($parent) { $sql = "\x53\x45\x4c\105\103\124\40\151\x64\40\106\122\117\115\40{$table_prefix}\x74\141\x78\x6f\x6e\157\155\x69\145\x73\137\142\141\163\145\x20\127\x48\x45\x52\105\x20\x64\x65\x6c\145\164\x65\x5f\x66\154\x67\40\75\x20\60\x20\101\116\104\40\x73\x74\141\164\x75\x73\x20\75\x20\61\x20\101\x4e\104\40\x63\x6c\141\x73\x73\x69\x66\x69\143\x61\x74\151\x6f\x6e\x20\x3d\40\x31\40\x41\x4e\x44\x20\163\154\x75\147\x20\x3d\x20\47{$parent}\47"; $read_records = $pdo->prepare($sql); $read_records->execute(); if ($record = $read_records->fetch(PDO::FETCH_ASSOC)) { $parent_id = intval($record["\151\x64"]); } unset($read_records); } $qsc_posttype_id = null; $qsc_posttype_id_post = null; if (!is_numeric($posttype_id) && strpos($posttype_id, "\54") !== false) { $posttype_ids = explode("\54", $posttype_id); foreach ($posttype_ids as $key => $value) { $posttype_ids[$key] = intval($value); } $posttype_id = implode("\x2c", $posttype_ids); $qsc_posttype_id = "\101\116\104\40\164\142\56\x70\157\x73\164\164\x79\x70\x65\x5f\x69\x64\x20\x49\x4e\40\50{$posttype_id}\51"; $qsc_posttype_id_post = "\101\116\x44\40\160\x6f\x73\164\164\171\160\145\137\x69\144\40\111\x4e\x20\50{$posttype_id}\x29"; } elseif (is_numeric($posttype_id)) { $posttype_id = intval($posttype_id); $qsc_posttype_id = "\101\116\x44\40\164\x62\56\160\x6f\x73\164\164\171\x70\145\137\151\x64\x20\x3d\40{$posttype_id}"; $qsc_posttype_id_post = "\x41\x4e\104\40\160\x6f\x73\x74\x74\171\x70\145\x5f\x69\x64\x20\75\x20{$posttype_id}"; } $qsc_parent_id = $parent_id !== null && is_int($parent_id) ? "\x41\116\x44\40\x74\x62\x2e\x70\x61\162\145\156\164\137\151\144\x20\x3d\x20{$parent_id}" : null; $categories = array(); try { $sql = "\12\x9\x9\11\x9\x53\105\x4c\105\103\124\12\x9\11\11\11\11\164\142\x2e\151\144\40\x41\x53\40\x27\x69\x64\47\x2c\xa\x9\x9\11\x9\x9\164\142\x2e\x70\141\162\x65\x6e\x74\x5f\151\x64\x20\101\123\x20\x27\x70\x61\x72\145\x6e\x74\137\x69\144\x27\x2c\xa\x9\x9\11\x9\11\x74\x62\56\163\x6c\x75\147\40\x41\123\x20\47\163\154\165\147\47\54\xa\11\x9\11\x9\11\164\154\56\x6c\141\142\145\154\40\101\x53\x20\x27\x6c\x61\142\145\154\x27\54\xa\x9\x9\11\x9\x9\143\166\56\x63\x6f\166\145\x72\x5f\x69\x6d\141\x67\x65\xa\11\11\x9\11\x46\x52\117\x4d\40{$table_prefix}\164\x61\170\x6f\156\x6f\155\151\145\x73\x5f\x62\x61\163\145\x20\101\x53\x20\164\x62\xa\11\x9\11\11\11\x4c\105\x46\x54\x20\x4f\x55\x54\105\x52\40\112\x4f\x49\x4e\x20{$table_prefix}\164\141\x78\x6f\x6e\x6f\x6d\x69\x65\x73\137\x6c\141\142\x65\154\x20\101\x53\40\x74\154\12\11\x9\11\11\x9\x9\x4f\116\x20\164\x62\56\151\x64\40\75\x20\x74\x6c\56\x62\x61\x73\x65\x5f\x69\x64\xa\x9\11\x9\11\11\x4c\x45\106\124\40\117\125\x54\x45\x52\40\x4a\x4f\x49\x4e\x20\x28\123\105\114\x45\103\x54\x20\x2a\x20\106\x52\x4f\115\x20{$table_prefix}\143\157\x76\x65\162\163\40\x57\x48\105\x52\x45\x20\145\156\x74\x69\x74\171\137\x63\x6f\144\x65\x20\x3d\40\64\x29\x20\x41\123\x20\x63\166\12\x9\x9\11\11\x9\11\117\116\40\164\142\56\x69\x64\40\75\40\143\166\x2e\x65\156\x74\151\164\x79\x5f\x69\x64\12\x9\x9\11\x9\x57\110\105\x52\x45\xa\x9\x9\x9\x9\x9\164\142\x2e\144\145\154\145\x74\145\x5f\x66\154\x67\40\75\x20\x30\12\x9\x9\11\11\11\101\116\104\x20\x74\142\x2e\163\164\141\x74\165\163\40\75\x20\x31\12\11\11\x9\11\11\101\116\104\40\164\x62\56\143\x6c\141\x73\x73\x69\x66\x69\143\x61\164\x69\157\x6e\40\x3d\x20\x31\12\11\11\11\x9\x9\x41\116\x44\40\x74\154\56\154\x61\x6e\147\165\x61\x67\x65\137\x69\x64\x20\x3d\x20\x3a\x4c\x41\x4e\x47\x55\x41\x47\105\x5f\x49\x44\xa\11\11\x9\x9\11{$qsc_posttype_id}\12\x9\11\x9\11\x9{$qsc_parent_id}\12\x9\11\x9\x9\x4f\122\x44\x45\x52\40\x42\x59\40\x74\142\x2e\160\x61\x72\x65\x6e\164\137\151\x64\x20\x41\x53\103\x2c\40\164\142\x2e\x6c\x69\x6e\x65\x5f\x6f\162\x64\x65\162\40\101\x53\x43\xa\11\11"; } catch (PDOException $e) { var_dump($e->getMessage()); } $read_categories = $pdo->prepare($sql); $read_categories->bindValue("\72\114\x41\x4e\107\125\101\x47\x45\137\111\x44", $language_id, PDO::PARAM_INT); $read_categories->execute(); while ($record = $read_categories->fetch(PDO::FETCH_ASSOC)) { if ($record["\x70\x61\162\x65\156\x74\137\151\144"] == 0 || $parent_id !== null) { $categories[$record["\151\144"]] = $record; } else { $categories[$record["\x70\141\162\145\156\164\137\x69\x64"]]["\x63\150\x69\x6c\144\x72\145\x6e"][$record["\151\144"]] = $record; } } if ($with_count || $in_use) { foreach ($categories as $parent_id => $parent) { $now = date("\x59\55\155\x2d\x64\x20\110\x3a\x69\72\163"); $qsc_status = !$preview ? "\101\x4e\x44\x20\163\x74\141\x74\165\163\x20\75\x20\61" : "\x41\x4e\x44\x20\x73\164\x61\164\165\x73\40\74\x3d\40\x32"; $qsc_publish_datetime = !$preview ? "\101\116\x44\x20\160\x75\x62\154\151\x73\150\x5f\x64\x61\x74\x65\x74\x69\155\x65\40\x3c\75\x20\x27{$now}\x27" : null; $qsc_publish_end_at = !$preview ? "\x41\x4e\104\40\x28\x70\165\142\154\151\x73\150\x5f\x65\x6e\144\x5f\x61\x74\40\x3e\x20\47{$now}\x27\40\x4f\x52\x20\160\165\x62\154\x69\x73\150\137\x65\x6e\x64\137\x61\x74\40\111\123\x20\116\x55\x4c\114\x29" : null; $category_id_text = sprintf("\45\60\x34\144", $parent_id); try { $now = date("\131\55\x6d\55\x64\40\x48\72\151\72\163"); $sql = "\xa\11\x9\11\11\11\x9\x53\x45\114\x45\103\x54\40\103\x4f\125\116\x54\x28\x2a\51\x20\x41\123\40\143\157\165\156\x74\12\11\11\x9\11\11\11\106\122\x4f\x4d\40{$table_prefix}\x70\x6f\x73\x74\x73\x5f\142\141\x73\x65\12\11\11\x9\11\x9\11\127\110\x45\x52\105\12\x9\11\x9\11\x9\11\x9\143\x75\x72\162\145\156\x74\x5f\x66\x6c\147\x20\x3d\x20\x31\xa\x9\11\x9\11\x9\x9\x9\x41\x4e\104\x20\x70\x61\162\145\156\164\137\x69\144\40\75\40\x30\xa\11\11\x9\11\x9\x9\11\101\116\x44\x20\144\145\x6c\145\x74\145\x5f\x66\154\147\40\75\x20\60\xa\11\11\x9\11\x9\11\11{$qsc_status}\xa\11\x9\x9\11\x9\11\11{$qsc_publish_datetime}\12\x9\11\11\x9\x9\x9\11{$qsc_publish_end_at}\12\11\x9\11\x9\11\x9\11\101\116\104\x20\163\x69\x74\145\x5f\151\x64\x20\75\40{$site_id}\xa\x9\11\11\11\11\11\11\101\116\x44\40\143\141\x74\145\x67\x6f\x72\171\137\x69\x64\x20\x4c\x49\113\x45\x20\47\45{$category_id_text}\x25\x27\xa\11\x9\x9\x9\11\x9\x9{$qsc_posttype_id_post}\12\11\x9\x9\x9"; $read_count = $pdo->prepare($sql); $read_count->execute(); if ($record = $read_count->fetch(PDO::FETCH_ASSOC)) { if ($with_count) { $categories[$parent_id]["\143\157\165\156\x74"] = $record["\143\157\165\156\x74"]; } if ($in_use && $record["\x63\x6f\165\x6e\x74"] == 0) { unset($categories[$parent_id]); } else { if (!empty($parent["\143\150\151\x6c\x64\162\x65\x6e"])) { foreach ($parent["\143\x68\151\154\144\162\145\156"] as $child_id => $child) { $category_id_text = sprintf("\45\60\64\144", $child_id); $sql = "\xa\11\x9\11\11\11\11\11\x9\11\11\123\x45\x4c\x45\x43\124\40\103\117\125\116\x54\50\x2a\x29\x20\101\x53\40\x63\157\x75\156\164\xa\x9\x9\x9\x9\x9\11\x9\x9\11\11\x46\122\117\115\40{$table_prefix}\x70\157\x73\x74\x73\x5f\x62\x61\x73\145\xa\11\11\x9\11\11\x9\11\11\x9\x9\x57\x48\105\122\105\xa\x9\x9\11\11\11\x9\x9\11\x9\11\x9\143\x75\x72\162\145\x6e\164\x5f\x66\x6c\147\40\75\40\61\xa\11\11\11\11\x9\x9\11\11\x9\11\x9\x41\116\104\40\160\x61\x72\145\156\164\x5f\151\x64\x20\x3d\x20\x30\xa\11\x9\x9\x9\11\x9\11\x9\x9\11\11\x41\116\104\x20\144\145\154\145\164\x65\x5f\x66\x6c\x67\40\75\x20\x30\xa\11\11\11\11\x9\x9\x9\11\11\x9\11{$qsc_status}\xa\11\11\11\11\x9\11\11\11\11\x9\11{$qsc_publish_datetime}\12\11\x9\11\11\11\11\11\11\x9\x9\x9\x41\116\104\40\163\x69\164\x65\137\x69\144\40\75\40{$site_id}\12\11\x9\11\11\11\x9\11\11\11\x9\11\x41\x4e\104\40\x63\141\164\x65\147\157\x72\x79\137\x69\x64\40\114\111\x4b\105\40\47\45{$category_id_text}\45\47\xa\11\x9\11\11\11\11\11\11\x9\x9\x9{$qsc_posttype_id_post}\12\x9\11\x9\x9\11\x9\x9\11"; $read_count = $pdo->prepare($sql); $read_count->execute(); if ($record = $read_count->fetch(PDO::FETCH_ASSOC)) { if ($with_count) { $categories[$parent_id]["\x63\150\151\x6c\144\x72\145\x6e"][$child_id]["\x63\x6f\x75\x6e\164"] = $record["\x63\x6f\165\x6e\164"]; } if ($in_use && $record["\143\157\x75\x6e\x74"] == 0) { unset($categories[$parent_id]["\x63\150\x69\x6c\x64\162\145\156"][$child_id]); } } } } } } } catch (PDOException $e) { var_dump($e->getMessage()); } } } $categories_fixed = array(); if (!empty($key_by)) { if ($key_by == "\x69\x64") { foreach ($categories as $row) { if (!empty($row["\143\x68\x69\154\x64\162\x65\x6e"])) { $children_fixed = array(); foreach ($row["\143\x68\x69\154\144\x72\x65\x6e"] as $child) { $children_fixed[$child["\151\x64"]] = $child; } $row["\143\x68\x69\154\144\162\145\x6e"] = $children_fixed; } $categories_fixed[$row["\x69\144"]] = $row; } } elseif ($key_by == "\x6c\141\142\145\x6c") { foreach ($categories as $row) { if (!empty($row["\143\150\x69\x6c\x64\162\x65\x6e"])) { $children_fixed = array(); foreach ($row["\143\150\151\x6c\x64\x72\x65\x6e"] as $child) { $children_fixed[$child["\x6c\x61\142\145\154"]] = $child; } $row["\x63\x68\x69\x6c\x64\162\x65\156"] = $children_fixed; } $categories_fixed[$row["\x6c\141\x62\145\x6c"]] = $row; } } elseif ($key_by == "\156\165\155\142\x65\x72") { $categories_fixed = index_fromone($categories); $categories_fixed = index_fromone_recursive($categories_fixed); } else { foreach ($categories as $row) { if (!empty($row["\x63\x68\x69\154\x64\162\145\x6e"])) { $children_fixed = array(); foreach ($row["\143\150\x69\154\144\162\x65\156"] as $child) { $children_fixed[$child["\163\x6c\165\x67"]] = $child; } $row["\x63\150\151\154\144\x72\145\156"] = $children_fixed; } $categories_fixed[$row["\x73\x6c\x75\x67"]] = $row; } } } else { foreach ($categories as $row) { if (!empty($row["\x63\x68\151\x6c\144\x72\145\156"])) { $children_fixed = array(); foreach ($row["\x63\x68\x69\x6c\x64\162\145\x6e"] as $child) { $children_fixed[$child["\163\x6c\165\147"]] = $child; } $row["\143\150\151\x6c\x64\162\x65\x6e"] = $children_fixed; } $categories_fixed[$row["\163\x6c\x75\147"]] = $row; } } return $categories_fixed; } goto d1jsP; giBAt: function get_posttypes($config = array()) { global $database; global $pdo; global $table_prefix; $site = !empty($config["\x73\151\x74\x65"]) ? $config["\x73\x69\164\x65"] : null; $site_id = isset($config["\163\x69\x74\145\x5f\x69\144"]) ? intval($config["\163\x69\x74\145\x5f\151\x64"]) : 1; $key_by = !empty($config["\x6b\x65\171\137\x62\171"]) ? $config["\153\x65\x79\137\x62\171"] : null; if ($site) { $site_id = 9999; $sql = "\x53\x45\114\105\103\x54\40\151\x64\40\106\x52\117\x4d\40{$table_prefix}\163\151\164\x65\x73\x20\127\110\105\122\105\40\x64\x65\154\x65\x74\145\137\146\154\147\x20\x3d\40\60\40\x41\116\x44\40\163\x74\141\x74\x75\x73\x20\x3d\x20\61\x20\x41\116\x44\x20\163\x6c\x75\x67\40\75\x20\47{$site}\47"; $read_records = $pdo->prepare($sql); $read_records->execute(); if ($record = $read_records->fetch(PDO::FETCH_ASSOC)) { $site_id = intval($record["\x69\144"]); } unset($read_records); } $posttypes = array(); if ($site_id > 0) { $site_id = sprintf("\x25\60\64\144", $site_id); try { $sql = "\12\11\11\x9\11\x9\x53\105\x4c\x45\103\x54\12\x9\x9\x9\11\x9\x9\x70\x74\x2e\151\144\40\x41\x53\x20\47\x69\144\47\x2c\12\11\x9\11\x9\11\x9\160\x74\56\x6e\x61\x6d\x65\40\101\x53\40\x27\154\x61\x62\145\x6c\x27\x2c\12\11\11\x9\x9\x9\x9\160\x74\x2e\163\x6c\x75\147\x20\x41\123\x20\x27\163\x6c\x75\147\47\54\12\x9\x9\x9\11\11\x9\x63\166\x2e\x63\x6f\166\x65\x72\x5f\151\155\141\147\x65\xa\x9\x9\x9\x9\x9\x46\122\x4f\x4d\40{$table_prefix}\160\x6f\163\x74\x74\x79\160\x65\163\x20\101\x53\40\160\x74\12\x9\x9\x9\11\x9\11\114\105\106\x54\40\117\125\x54\x45\122\x20\112\117\x49\116\40\50\x53\x45\x4c\105\103\x54\x20\x2a\40\106\122\117\115\x20{$table_prefix}\143\x6f\x76\145\x72\163\x20\x57\110\105\122\105\x20\145\156\164\151\x74\x79\x5f\143\157\144\x65\x20\75\40\62\x29\40\101\123\x20\143\166\xa\x9\11\x9\x9\x9\11\x9\117\116\40\x70\164\x2e\x69\144\40\x3d\40\x63\x76\x2e\x65\x6e\x74\151\x74\171\137\151\144\12\x9\x9\x9\11\11\127\110\x45\122\105\12\11\11\11\x9\x9\11\160\x74\x2e\x64\x65\x6c\145\x74\x65\x5f\x66\154\147\40\75\x20\60\xa\11\11\x9\x9\x9\11\x41\x4e\x44\x20\x70\164\56\163\164\141\164\x75\x73\x20\75\x20\61\12\x9\11\11\x9\11\11\x41\116\x44\40\160\x74\56\151\144\x20\x3c\x20\x31\x30\x30\x30\12\x9\x9\x9\11\11\11\101\116\x44\x20\x70\164\56\163\151\164\x65\x5f\151\x64\40\x6c\x69\153\145\x20\47\x25{$site_id}\x25\x27\xa\11\11\x9\11\11\x4f\x52\x44\105\x52\40\x42\131\x20\x70\x74\x2e\154\x69\156\x65\x5f\157\x72\144\x65\x72\40\x41\123\103\xa\x9\11\x9"; $read_posttypes = $pdo->prepare($sql); $read_posttypes->execute(); while ($record = $read_posttypes->fetch(PDO::FETCH_ASSOC)) { $posttypes[$record["\x69\144"]] = $record; } unset($read_posttypes); } catch (PDOException $e) { var_dump($e->getMessage()); } $posttypes_fixed = array(); if (!empty($key_by)) { if ($key_by == "\x69\x64") { foreach ($posttypes as $row) { $posttypes_fixed[$row["\x69\144"]] = $row; } } elseif ($key_by == "\x6c\x61\x62\x65\154") { foreach ($posttypes as $row) { $posttypes_fixed[$row["\x6c\141\x62\x65\154"]] = $row; } } elseif ($key_by == "\156\x75\155\142\x65\162") { $posttypes_fixed = index_fromone($posttypes); } else { foreach ($posttypes as $row) { $posttypes_fixed[$row["\163\x6c\165\x67"]] = $row; } } } else { foreach ($posttypes as $row) { $posttypes_fixed[$row["\x73\x6c\x75\147"]] = $row; } } } return $posttypes_fixed; } goto acPqs; p_owe: function post_contact_send_mail($contact_target, $contact_data, $reset_items = array(), $config_mail = array()) { global $database; global $pdo; global $table_prefix; $posttype = !empty($contact_target["\x70\157\163\x74\164\171\x70\145"]) ? $contact_target["\160\x6f\163\x74\164\171\x70\x65"] : null; $posttype_id = !empty($contact_target["\x70\x6f\163\164\x74\x79\160\x65\137\x69\144"]) ? $contact_target["\160\x6f\x73\164\164\171\160\145\x5f\151\144"] : 1; $mail_to = !empty($contact_data["\145\155\x61\x69\154"]) ? $contact_data["\x65\x6d\x61\x69\x6c"] : ''; $postdata = $contact_target + $contact_data; if ($posttype) { $posttype_id = 9999; $sql = "\x53\105\114\105\x43\x54\x20\x69\144\x20\x46\x52\x4f\115\x20{$table_prefix}\160\157\163\164\x74\171\x70\x65\x73\x20\x57\110\x45\122\x45\x20\x64\x65\x6c\145\x74\145\x5f\146\x6c\147\x20\75\40\x30\x20\101\x4e\104\40\163\x74\141\164\x75\163\x20\75\x20\61\x20\x41\x4e\x44\x20\163\x6c\165\147\40\75\x20\47{$posttype}\x27"; $read_records = $pdo->prepare($sql); $read_records->execute(); if ($record = $read_records->fetch(PDO::FETCH_ASSOC)) { $posttype_id = intval($record["\x69\144"]); } unset($read_records); } $config_smtp = array(); $sql = "\123\105\x4c\x45\x43\x54\40\x69\164\145\155\x2c\40\x76\x61\154\165\x65\40\x46\x52\117\x4d\x20{$table_prefix}\143\157\156\x66\x69\147\x73\137\x70\157\x73\164\164\x79\x70\145\x20\x57\x48\105\122\x45\40\x73\x69\164\145\137\151\x64\x20\75\40\60\x20\x41\x4e\x44\x20\160\x6f\163\164\164\171\x70\x65\137\151\x64\x20\75\x20{$posttype_id}\40\101\x4e\104\40\151\164\145\155\40\111\116\50\47\165\163\x65\x5f\163\155\164\160\47\x2c\40\x27\150\x6f\163\x74\47\x2c\40\47\x75\x73\145\162\137\x6e\x61\155\x65\x27\54\40\47\160\141\x73\163\167\x6f\x72\x64\x27\54\40\x27\160\157\x72\x74\47\x29"; $read_records = $pdo->prepare($sql); $read_records->execute(); while ($record = $read_records->fetch(PDO::FETCH_ASSOC)) { $config_smtp[$record["\151\x74\x65\155"]] = $record["\166\141\x6c\x75\145"]; } unset($read_records); $config_admin = array(); $sql = "\123\105\114\x45\x43\124\x20\x69\x74\145\155\54\40\x76\141\154\165\145\x20\x46\122\117\115\x20{$table_prefix}\143\157\x6e\x66\151\147\163\137\160\x6f\x73\x74\164\171\x70\145\x20\x57\x48\x45\122\105\x20\163\x69\164\x65\137\151\144\40\75\x20\60\x20\x41\116\104\x20\160\157\163\164\164\x79\160\x65\137\151\x64\x20\x3d\40\x27{$posttype_id}\x27\40\x41\x4e\104\40\151\164\x65\155\40\x4c\111\113\x45\40\x27\x25\x61\x64\155\151\x6e\x25\47"; $read_records = $pdo->prepare($sql); $read_records->execute(); while ($record = $read_records->fetch(PDO::FETCH_ASSOC)) { $item = str_replace("\141\x64\155\x69\156\x5f", '', $record["\151\164\x65\x6d"]); $config_admin[$item] = $record["\166\141\x6c\165\x65"]; } unset($read_records); if (!empty($config_mail["\141\144\155\x69\156"])) { foreach ($config_mail["\141\144\x6d\x69\156"] as $key => $value) { if (isset($config_admin[$key]) && !empty($value)) { $config_admin[$key] = $value; } } } $config_customer = array(); $sql = "\x53\x45\114\x45\103\124\40\x69\x74\x65\x6d\x2c\40\x76\x61\x6c\165\145\40\106\122\x4f\x4d\40{$table_prefix}\143\157\156\x66\151\147\163\137\160\157\163\164\x74\x79\x70\145\40\x57\x48\105\x52\105\40\x73\151\x74\145\137\151\144\x20\75\x20\60\x20\101\x4e\x44\x20\x70\157\x73\164\x74\x79\x70\x65\137\x69\x64\x20\75\x20\x27{$posttype_id}\47\x20\101\x4e\104\40\151\164\x65\155\x20\x4c\x49\x4b\x45\x20\47\x25\x63\165\163\164\157\155\x65\x72\x25\47"; $read_records = $pdo->prepare($sql); $read_records->execute(); while ($record = $read_records->fetch(PDO::FETCH_ASSOC)) { $item = str_replace("\x63\165\163\x74\157\155\x65\x72\x5f", '', $record["\151\x74\x65\155"]); $config_customer[$item] = $record["\x76\141\x6c\x75\145"]; } unset($read_records); if (!empty($config_mail["\x63\165\x73\164\x6f\x6d\145\x72"])) { foreach ($config_mail["\x63\x75\x73\164\x6f\155\x65\162"] as $key => $value) { if (isset($config_customer[$key]) && !empty($value)) { $config_customer[$key] = $value; } } } if (empty($postdata["\164\x69\164\x6c\145"]) && !empty($config_customer["\163\165\x62\152\x65\143\x74"])) { $postdata["\x74\151\164\x6c\145"] = $config_customer["\163\x75\x62\152\145\x63\x74"]; } if (!($new_contact_id = post_contact($postdata))) { return array("\x72\x65\x73\165\154\x74" => 0, "\x68\x74\164\x70\x5f\x73\164\141\164\x75\163\x5f\x63\x6f\144\145" => 400, "\145\162\162\157\162\137\160\x6f\151\x6e\164" => "\x62\141\x64\x5f\x72\145\161\165\145\163\x74"); } $contact = get_contact($new_contact_id, $contact_target); if (empty($contact)) { return array("\x72\x65\x73\x75\x6c\164" => 0, "\x68\164\164\160\137\x73\164\x61\x74\165\163\x5f\143\157\144\145" => 400, "\145\162\x72\157\x72\137\160\x6f\151\x6e\x74" => "\x62\x61\144\137\162\145\x71\165\145\x73\x74"); } $contact = reset_contact($contact, $reset_items); if ($config_admin["\x66\x72\x6f\155"] && $config_admin["\x74\x6f"] && $config_admin["\165\163\145\137\x61\x75\164\157\137\x72\x65\160\154\171\137\141\x64\x6d\x69\156"]) { $contact = $config_admin["\x75\x73\145\x5f\151\x6e\160\165\x74\137\x76\141\154\165\145\163\137\x61\x64\155\151\156"] ? $contact : array(); if (!empty($config_smtp["\165\x73\x65\x5f\163\x6d\164\160"])) { $result = send_mail_extend($config_admin, $config_smtp, $contact); if ($result["\162\145\x73\x75\x6c\164"] == 0) { return $result; } } else { $result = send_mail($config_admin, $contact); if ($result["\x72\x65\x73\165\x6c\x74"] == 0) { return $result; } } } if ($config_customer["\146\x72\x6f\155"] && $config_customer["\165\163\x65\x5f\141\165\164\x6f\x5f\162\x65\160\154\x79\137\143\x75\163\x74\x6f\x6d\x65\x72"]) { $config_customer["\x74\157"] = $mail_to; $contact = $config_customer["\165\x73\145\x5f\x69\156\160\165\164\x5f\166\141\154\165\x65\163\137\143\x75\163\x74\x6f\155\145\x72"] ? $contact : array(); if (!empty($config_smtp["\x75\x73\x65\x5f\x73\155\164\160"])) { $result = send_mail_extend($config_customer, $config_smtp, $contact); if ($result["\x72\145\x73\165\x6c\x74"] == 0) { return $result; } } else { $result = send_mail($config_customer, $contact); if ($result["\x72\x65\x73\x75\154\x74"] == 0) { return $result; } } } return array("\x72\145\163\165\x6c\x74" => 1, "\150\x74\x74\160\x5f\163\x74\x61\x74\x75\x73\137\x63\x6f\x64\x65" => 200, "\x65\x72\x72\x6f\x72\137\160\x6f\x69\156\x74" => "\x6e\157\x6e\145"); } goto AQwwW; gT5L8: require_once dirname(__FILE__) . "\x2f\x2e\56\57\56\x2e\57\56\56\x2f\x63\x6c\141\x73\x73\57\111\61\x38\116\x5f\x55\156\151\x63\157\x64\145\116\157\162\x6d\141\154\151\172\x65\162\57\125\156\x69\143\x6f\x64\x65\116\x6f\162\x6d\x61\154\x69\172\145\162\x2e\x70\x68\x70"; goto WO03J; Vd3vZ: function get_contact_items($config = array(), $with_hidden = false) { global $database; global $pdo; global $table_prefix; global $contact_items; global $contact_items_label; $site = !empty($config["\163\x69\x74\x65"]) ? $config["\x73\x69\x74\145"] : null; $site_id = !empty($config["\163\151\164\145\x5f\x69\144"]) ? intval($config["\163\x69\164\x65\x5f\151\x64"]) : 1; $posttype = !empty($config["\160\x6f\163\164\164\x79\x70\x65"]) ? $config["\x70\x6f\x73\164\164\x79\x70\x65"] : null; $posttype_id = !empty($config["\160\x6f\163\164\164\171\160\x65\137\151\x64"]) ? intval($config["\x70\157\163\x74\164\x79\x70\x65\137\x69\x64"]) : 1001; $language = !empty($config["\x6c\141\156\147\165\x61\147\x65"]) ? $config["\154\141\x6e\x67\165\x61\x67\145"] : null; $language_id = !empty($config["\154\x61\x6e\x67\x75\x61\x67\x65\137\x69\144"]) ? intval($config["\154\141\156\147\x75\x61\147\145\x5f\x69\144"]) : 1; $group = !empty($config["\147\162\157\165\x70"]) ? $config["\x67\x72\157\x75\x70"] : null; $group_id = !empty($config["\x67\162\x6f\x75\x70\x5f\x69\x64"]) ? intval($config["\x67\x72\x6f\x75\x70\137\151\144"]) : 0; $excluded_items = !empty($config["\145\170\143\x6c\x75\144\145\x64\x5f\x69\164\x65\x6d\x73"]) ? $config["\x65\170\143\x6c\x75\x64\145\144\137\x69\164\x65\155\x73"] : array(); if ($site) { $site_id = 9999; $sql = "\123\105\114\105\103\x54\40\x69\x64\40\x46\122\117\115\40{$table_prefix}\x73\151\x74\145\x73\x20\x57\110\105\x52\x45\x20\144\x65\154\145\164\x65\137\146\x6c\147\40\x3d\40\x30\40\101\x4e\x44\x20\163\x74\x61\164\x75\163\40\x3d\40\x31\40\101\116\x44\x20\163\154\x75\147\x20\x3d\40\x27{$site}\47"; $read_records = $pdo->prepare($sql); $read_records->execute(); if ($record = $read_records->fetch(PDO::FETCH_ASSOC)) { $site_id = intval($record["\x69\x64"]); } unset($read_records); } if ($posttype) { $posttype_id = 9999; $sql = "\x53\105\114\x45\103\124\x20\x69\144\40\x46\x52\117\x4d\40{$table_prefix}\x70\x6f\x73\x74\x74\171\x70\x65\163\40\127\110\x45\122\105\40\144\x65\154\145\164\145\x5f\146\x6c\x67\40\x3d\x20\60\x20\x41\x4e\104\x20\163\164\x61\164\x75\x73\x20\x3d\x20\x31\40\101\116\104\40\163\x6c\165\x67\x20\75\x20\47{$posttype}\x27"; $read_records = $pdo->prepare($sql); $read_records->execute(); if ($record = $read_records->fetch(PDO::FETCH_ASSOC)) { $posttype_id = intval($record["\x69\x64"]); } unset($read_records); } if ($language) { $language_id = 9999; $sql = "\123\105\x4c\105\x43\x54\40\151\144\40\x46\122\117\115\x20{$table_prefix}\154\x61\x6e\x67\x75\141\x67\145\x73\x20\x57\x48\x45\122\x45\40\163\154\165\x67\40\x3d\x20\x27{$language}\x27"; $read_records = $pdo->prepare($sql); $read_records->execute(); if ($record = $read_records->fetch(PDO::FETCH_ASSOC)) { $language_id = intval($record["\151\x64"]); } unset($read_records); } if ($group) { $sql = "\x53\x45\x4c\x45\x43\124\40\151\144\x20\106\x52\x4f\x4d\40{$table_prefix}\x67\x72\157\x75\x70\x73\40\x57\110\105\122\x45\x20\163\x6c\x75\x67\40\x3d\x20\47{$group}\x27"; $read_records = $pdo->prepare($sql); $read_records->execute(); if ($record = $read_records->fetch(PDO::FETCH_ASSOC)) { $group_id = intval($record["\151\x64"]); } unset($read_records); } $exist_flg = 0; $site_id_string = sprintf("\45\60\x34\x64", $site_id); try { $sql = "\x53\x45\x4c\x45\103\124\40\103\x4f\125\116\x54\x28\52\x29\40\x41\123\x20\145\x78\151\163\164\x20\106\x52\x4f\115\x20{$table_prefix}\x70\x6f\163\x74\164\171\x70\x65\x73\x20\x57\110\x45\x52\105\x20\x69\x64\x20\x3d\x20{$posttype_id}\40\101\116\104\40\163\x69\x74\145\137\x69\x64\x20\114\x49\113\x45\40\47\x25{$site_id_string}\x25\47\40\x41\x4e\x44\40\144\145\x6c\x65\164\145\137\146\154\x67\x20\75\40\x30\x20\101\x4e\104\x20\163\x74\141\164\x75\163\x20\x3d\x20\61"; $check_exist = $pdo->prepare($sql); $check_exist->execute(); if ($record = $check_exist->fetch(PDO::FETCH_ASSOC)) { $exist_flg = $record["\x65\170\x69\x73\164"]; } unset($check_exist); } catch (PDOException $e) { var_dump($e->getMessage()); } $items = array(); if ($exist_flg) { $categories = array(); try { $sql = "\12\11\x9\11\x9\x9\123\x45\114\x45\x43\124\xa\x9\x9\x9\x9\x9\x9\164\x62\56\151\144\x20\x41\x53\40\x69\144\x2c\xa\11\x9\11\x9\x9\x9\x74\142\56\x70\141\162\145\x6e\x74\137\x69\x64\x20\101\123\40\160\141\162\x65\156\x74\137\151\x64\54\12\x9\x9\11\11\11\x9\x74\142\x2e\x73\154\x75\x67\40\x41\x53\40\163\x6c\x75\147\54\xa\11\11\11\11\x9\11\164\x62\56\154\x69\156\145\137\157\162\x64\x65\x72\40\x41\123\40\154\x69\x6e\x65\137\x6f\x72\144\145\x72\x2c\xa\11\x9\11\11\x9\x9\164\x6c\x2e\154\141\x62\x65\x6c\40\x41\x53\x20\154\141\x62\145\x6c\xa\11\x9\11\11\x9\106\122\117\115\x20{$table_prefix}\164\141\170\157\156\157\x6d\151\145\x73\x5f\x62\x61\163\x65\40\101\x53\40\x74\142\xa\11\x9\11\x9\11\11\x49\116\x4e\105\122\x20\x4a\117\111\116\40{$table_prefix}\164\x61\170\x6f\156\157\155\151\x65\x73\137\154\x61\x62\145\154\40\x41\123\40\164\154\12\x9\11\x9\x9\x9\11\11\117\116\x20\164\x62\56\151\x64\40\x3d\40\164\x6c\56\142\141\x73\145\x5f\x69\144\xa\x9\11\11\11\x9\x57\x48\105\x52\x45\xa\x9\x9\x9\x9\x9\x9\164\x62\x2e\x64\145\x6c\x65\164\145\x5f\146\154\x67\x20\x3d\x20\60\xa\11\x9\x9\x9\x9\x9\x41\116\x44\x20\x74\142\x2e\163\164\x61\x74\165\163\40\75\x20\61\12\x9\x9\11\11\x9\11\101\116\104\40\x74\142\x2e\x70\157\x73\164\164\x79\x70\x65\x5f\x69\144\x20\x3d\40{$posttype_id}\xa\11\x9\x9\11\x9\11\x41\116\x44\x20\164\x6c\56\x6c\x61\x6e\x67\x75\141\x67\145\137\151\x64\40\75\40{$language_id}\12\x9\x9\11\x9\x9\11\101\x4e\104\x20\50\164\x6c\x2e\154\x61\142\145\x6c\40\111\123\40\116\117\124\x20\x4e\125\x4c\114\40\x41\116\104\x20\x74\154\x2e\154\141\x62\145\x6c\40\41\x3d\x20\47\47\x29\12\x9\11\x9\x9\x9\117\122\104\x45\x52\x20\x42\x59\x20\164\x62\x2e\x70\141\x72\x65\156\164\x5f\x69\144\x2c\40\x74\142\x2e\154\151\x6e\x65\137\x6f\162\x64\145\162\54\40\x74\142\56\151\x64\x20\x41\x53\x43\12\x9\11\x9"; $read_categories = $pdo->prepare($sql); $read_categories->execute(); while ($category = $read_categories->fetch(PDO::FETCH_ASSOC)) { if ($category["\160\141\162\x65\x6e\x74\x5f\x69\144"] > 0) { $categories[$category["\x70\x61\162\145\x6e\164\x5f\151\144"]]["\x63\150\x69\x6c\x64\x72\x65\x6e"][$category["\151\x64"]] = $category; } else { $categories[$category["\x69\144"]] = $category; } } unset($read_categories); } catch (PDOException $e) { var_dump($e->getMessage()); } $select_values_category = array(); if (!empty($categories)) { foreach ($categories as $row) { $select_value = array(); $select_value["\166\x61\154\165\x65"] = $row["\151\144"]; $select_value["\x6c\x61\x62\x65\154"] = $row["\154\x61\142\145\154"]; if (isset($row["\143\x68\151\x6c\144\162\x65\156"])) { $select_value["\x61\x74\x74\x72\151\142\165\164\145"] = "\x70\x61\x72\x65\x6e\164"; $select_values_category[] = $select_value; $select_value = array(); foreach ($row["\x63\150\151\154\x64\x72\145\x6e"] as $row_child) { $select_value["\x76\141\x6c\x75\x65"] = $row_child["\x69\x64"]; $select_value["\x6c\141\x62\x65\x6c"] = $row_child["\154\141\142\145\154"]; $select_value["\141\x74\x74\x72\x69\142\165\164\145"] = "\x63\x68\x69\154\x64"; $select_value["\160\141\162\145\156\x74"] = $row["\x69\144"]; $select_values_category[] = $select_value; } } else { $select_values_category[] = $select_value; } } } $i_item = 0; $temp_order_sort = array(); foreach ($contact_items as $row) { if (!in_array($row["\x69\164\x65\155"], $excluded_items)) { if ($row["\151\x74\x65\x6d"] == "\x63\141\164\145\x67\x6f\162\171\137\x69\144") { if (!empty($select_values_category)) { $row["\163\145\x6c\145\143\164\137\166\x61\154\x75\x65\163"] = $select_values_category; } else { continue; } } if (isset($contact_items_label[$row["\151\164\x65\x6d"]])) { $row["\x6c\141\142\145\x6c"] = $contact_items_label[$row["\151\x74\145\x6d"]]; } if ($row["\151\164\145\x6d"] == "\x73\151\x74\x65\x5f\x69\x64") { $row["\x64\x65\x66\141\165\x6c\164\137\166\141\x6c\165\x65"] = $site_id; } if ($row["\151\x74\x65\x6d"] == "\x70\157\163\164\164\x79\x70\145\137\x69\144") { $row["\x64\x65\x66\x61\165\154\x74\137\166\141\x6c\x75\145"] = $posttype_id; } if ($row["\151\164\x65\x6d"] == "\x6c\141\156\x67\x75\x61\x67\145\x5f\151\x64") { $row["\144\x65\146\x61\x75\x6c\x74\137\166\141\154\x75\x65"] = $language_id; } if ($row["\x69\164\145\155"] == "\147\162\157\x75\160\137\x69\x64") { $row["\x64\x65\x66\x61\165\154\164\x5f\x76\x61\154\165\145"] = $group_id; } $temp_order_sort[] = $row["\164\145\x6d\x70\x5f\x6f\162\144\145\162"]; $items[$i_item] = $row; $i_item++; } } $custom_items = array(); $temp_order = 100; try { $sql = "\xa\11\11\11\11\x9\123\105\x4c\105\103\x54\12\11\11\11\x9\x9\x9\151\x64\40\x41\x53\x20\x27\151\x64\47\54\xa\x9\11\x9\11\11\11\x73\154\165\x67\40\101\x53\x20\x27\151\x74\145\x6d\x27\54\xa\x9\11\x9\x9\11\x9\156\x61\155\145\x20\101\123\40\x27\154\x61\142\145\154\x27\54\12\11\x9\x9\11\11\x9\x43\x41\123\105\12\x9\11\11\x9\11\x9\11\x57\x48\x45\116\x20\x74\x79\160\x65\40\75\40\x27\x73\145\x6c\145\x63\x74\x27\40\124\110\105\116\40\47\x73\x65\154\145\x63\x74\x27\xa\11\11\11\x9\11\11\11\127\110\105\116\40\x74\x79\160\145\40\75\x20\x27\x74\x65\x78\164\x61\162\145\141\x27\x20\x54\x48\105\116\40\x27\x74\145\x78\x74\141\x72\x65\x61\47\12\x9\x9\x9\11\x9\x9\x9\x45\114\123\x45\x20\47\x69\156\x70\x75\164\47\12\x9\11\x9\x9\x9\11\x45\116\x44\x20\101\123\x20\47\x68\x74\x6d\154\164\x61\147\x27\54\xa\x9\11\11\11\11\x9\x74\171\x70\145\x20\101\123\40\x27\164\x79\x70\x65\x27\x2c\xa\11\11\x9\11\11\x9\x6e\x75\x6c\154\40\x41\x53\40\x27\x6e\x61\x6d\145\x27\x2c\xa\x9\11\11\11\11\11\x63\150\x6f\151\143\x65\163\40\x41\123\40\x27\143\150\157\151\143\145\x73\47\54\xa\x9\x9\x9\11\11\11\156\165\154\154\x20\101\123\40\47\x64\x65\146\141\x75\x6c\x74\x5f\166\141\x6c\165\x65\47\54\12\11\11\x9\x9\x9\x9\156\165\154\154\40\101\123\x20\47\163\145\x6c\x65\x63\x74\x5f\x76\141\x6c\165\x65\163\x27\xa\x9\x9\x9\x9\x9\106\x52\x4f\115\40{$table_prefix}\143\165\163\x74\157\x6d\137\151\x74\x65\x6d\163\xa\11\x9\x9\x9\x9\127\110\x45\122\x45\xa\11\11\11\x9\x9\11\x64\145\x6c\145\164\x65\137\x66\x6c\x67\x20\75\40\60\xa\x9\11\x9\x9\11\x9\x41\x4e\104\40\x73\x74\141\x74\165\x73\40\x3d\40\x31\xa\x9\x9\11\x9\x9\x9\x41\116\x44\x20\x70\157\163\x74\164\x79\160\x65\137\x69\144\x20\x3d\x20{$posttype_id}\12\11\x9\11\x9\11\x4f\x52\104\x45\122\40\102\131\40\x6c\x69\156\x65\137\157\x72\x64\x65\162\x20\x41\x53\103\xa\11\x9\11"; $read_custom_items = $pdo->prepare($sql); $read_custom_items->execute(); while ($record = $read_custom_items->fetch(PDO::FETCH_ASSOC)) { $record["\156\141\155\x65"] = "\151\x74\x65\155\163\x5b" . $record["\151\144"] . "\135"; $record["\164\145\155\x70\137\157\162\144\145\162"] = $temp_order; $custom_items[] = $record; $temp_order++; } unset($read_custom_items); } catch (PDOException $e) { var_dump($e->getMessage()); } if (!empty($custom_items)) { foreach ($custom_items as $key => $row) { try { if (!empty($row["\x63\x68\157\x69\143\x65\163"]) && ($row["\x68\x74\x6d\154\164\x61\x67"] == "\x73\x65\154\145\143\x74" || $row["\x74\171\160\x65"] == "\162\x61\x64\x69\157" || $row["\x74\171\160\x65"] == "\143\150\x65\x63\x6b\x62\157\170")) { $sql = "\xa\11\x9\x9\x9\x9\x9\11\x9\x53\x45\x4c\105\x43\124\xa\11\x9\11\x9\11\x9\11\11\11\x63\166\x2e\151\x64\x20\101\x53\40\x69\x64\54\12\11\11\11\x9\x9\11\x9\x9\x9\x63\x76\56\x6c\x61\x62\x65\154\40\101\123\40\154\x61\x62\145\x6c\x2c\xa\x9\11\x9\x9\11\11\11\x9\11\143\x76\x2e\154\151\156\145\x5f\157\x72\x64\145\162\x20\101\123\40\x6c\151\156\x65\137\157\162\144\x65\162\12\x9\x9\x9\x9\11\x9\11\x9\106\122\117\115\40{$table_prefix}\x63\x75\163\x74\157\155\x5f\x6c\151\163\164\x73\x20\x41\123\40\143\154\12\11\x9\11\x9\x9\x9\x9\11\x9\111\x4e\116\105\x52\x20\112\117\111\x4e\xa\x9\x9\x9\x9\x9\x9\11\x9\x9\11\x28\12\x9\11\x9\x9\x9\11\11\11\x9\11\11\x53\x45\114\x45\103\124\40\52\12\11\x9\11\11\11\x9\11\x9\11\11\x9\x46\122\117\x4d\x20{$table_prefix}\x63\165\x73\164\x6f\155\137\x76\141\x6c\165\x65\163\137\142\x61\163\x65\40\101\x53\x20\x63\166\x62\12\x9\11\11\11\x9\11\x9\x9\x9\x9\x9\x9\x49\x4e\116\105\122\40\x4a\117\111\x4e\40{$table_prefix}\143\x75\163\164\157\155\137\x76\x61\154\x75\x65\x73\137\154\x61\142\145\154\x20\101\x53\40\x63\x76\x6c\xa\x9\x9\x9\x9\x9\x9\11\11\11\11\x9\x9\x9\x4f\x4e\x20\143\x76\x62\x2e\151\x64\x20\x3d\x20\x63\x76\x6c\x2e\142\x61\x73\145\x5f\151\144\xa\x9\11\11\x9\11\x9\11\11\11\x9\x9\127\110\x45\122\x45\40\143\x76\x62\x2e\144\145\x6c\x65\164\145\137\146\x6c\147\x20\x3d\40\60\x20\101\x4e\104\x20\x28\x63\166\x6c\x2e\x6c\141\142\x65\154\x20\111\123\40\x4e\x4f\x54\40\x4e\125\x4c\x4c\40\101\116\104\x20\x63\x76\x6c\56\154\x61\142\145\x6c\40\41\x3d\40\47\47\51\x20\x41\116\x44\x20\143\x76\x6c\56\154\141\x6e\x67\x75\141\147\145\137\151\x64\x20\x3d\x20{$language_id}\12\11\x9\11\11\x9\11\11\11\11\11\x29\x20\x41\123\40\x63\x76\12\x9\11\11\11\11\x9\x9\x9\x9\x9\x4f\116\40\143\x6c\56\x69\144\40\75\40\143\x76\56\154\151\163\164\x5f\x69\144\12\x9\x9\11\11\x9\11\11\x9\127\x48\105\122\x45\xa\x9\x9\x9\11\11\11\11\11\11\x63\154\x2e\144\x65\154\x65\164\145\137\x66\154\147\x20\x3d\x20\60\12\11\11\x9\x9\11\11\x9\x9\x9\x41\116\x44\40\x63\154\x2e\x69\144\40\75\40{$row["\x63\150\x6f\x69\x63\x65\163"]}\xa\x9\11\x9\x9\11\11\x9\11\x9\101\116\x44\40\143\154\x2e\x70\x6f\x73\164\x74\171\160\x65\x5f\151\x64\40\x3d\x20{$posttype_id}\12\x9\11\x9\x9\11\11\x9\x9\117\122\x44\105\x52\x20\102\131\x20\154\x69\156\145\137\x6f\162\144\x65\162\x2c\x20\151\x64\40\x41\x53\103\xa\x9\x9\x9\x9\x9\x9"; $read_custom_values = $pdo->prepare($sql); $read_custom_values->execute(); $custom_values = array(); while ($record = $read_custom_values->fetch(PDO::FETCH_ASSOC)) { $select_value = array(); $select_value["\166\141\154\x75\145"] = $record["\154\141\142\x65\154"]; $select_value["\x6c\141\x62\x65\x6c"] = $record["\x6c\x61\142\x65\154"]; array_push($custom_values, $select_value); } unset($read_custom_values); $custom_items[$key]["\x73\145\154\145\143\164\137\166\141\x6c\x75\x65\x73"] = $custom_values; } } catch (PDOException $e) { var_dump($e->getMessage()); } } foreach ($custom_items as $row) { if (!in_array($row["\x69\164\145\155"], $excluded_items)) { $temp_order_sort[] = $row["\x74\145\x6d\160\x5f\157\x72\144\x65\x72"]; $items[$i_item] = $row; $i_item++; } } } array_multisort($temp_order_sort, SORT_NUMERIC, $items); foreach ($items as $key => $row) { unset($items[$key]["\x69\144"]); unset($items[$key]["\164\145\155\160\x5f\x6f\162\144\145\162"]); if (false === $with_hidden && $row["\164\171\160\145"] == "\150\151\x64\144\145\x6e") { unset($items[$key]); } } } $items = index_fromone($items); $shaped_items = array(); foreach ($items as $key => $row) { $new_key = $row["\x69\x74\x65\x6d"]; $item_slug = array("\x73\154\x75\147" => $new_key); unset($row["\x69\164\x65\155"]); unset($row["\x6e\141\155\145"]); $options = array(); if (is_array($row["\163\x65\x6c\145\143\164\137\x76\x61\x6c\x75\x65\x73"]) && count($row["\163\145\154\145\x63\x74\x5f\x76\141\154\165\x65\x73"]) > 0) { foreach ($row["\x73\x65\154\145\143\164\x5f\166\141\x6c\x75\x65\163"] as $value) { $options[$value["\x76\x61\x6c\x75\x65"]]["\x76\x61\154\165\x65"] = $value["\166\x61\x6c\165\145"]; $options[$value["\x76\141\x6c\x75\x65"]]["\154\141\x62\x65\154"] = $value["\154\141\x62\145\x6c"]; } } else { $options = $row["\163\145\154\145\143\x74\137\x76\141\x6c\x75\145\x73"]; } $row["\157\160\x74\x69\x6f\156\x73"] = $options; unset($row["\x73\145\154\145\x63\164\137\166\141\154\x75\x65\x73"]); $shaped_items[$new_key] = $item_slug + $row; } return $shaped_items; } goto hNwlT; Ht8zO: function send_mail_extend($config_mail, $config_smtp = array(), $contact = array()) { $mail = new PHPMailer(); $normalizer = new I18N_UnicodeNormalizer(); $php_version = ''; $php_version_arr = explode("\56", phpversion()); for ($i = 0; $i < 3; $i++) { $version_string = isset($php_version_arr[$i]) ? sprintf("\x25\x30\x32\x64", $php_version_arr[$i]) : "\x30\60"; $php_version .= $version_string; } if (!empty($config_mail) && !empty($config_mail["\146\162\157\155"]) && !empty($config_mail["\164\x6f"])) { $from_name = !empty($config_mail["\x66\162\x6f\155\137\156\141\155\145"]) ? $config_mail["\x66\x72\157\x6d\137\156\141\x6d\x65"] : null; $to_name = !empty($config_mail["\164\x6f\137\156\x61\x6d\x65"]) ? $config_mail["\164\157\137\x6e\x61\155\x65"] : null; $from = !empty($config_mail["\x66\x72\157\155"]) ? $config_mail["\146\x72\x6f\155"] : null; $to = !empty($config_mail["\164\157"]) ? $config_mail["\x74\157"] : null; $cc = !empty($config_mail["\x63\143"]) ? $config_mail["\x63\x63"] : null; $bcc = !empty($config_mail["\x62\143\x63"]) ? $config_mail["\142\x63\x63"] : null; $replyto = !empty($config_mail["\x72\x65\160\x6c\171\x74\x6f"]) ? $config_mail["\162\145\160\154\171\164\x6f"] : null; $subject = !empty($config_mail["\163\165\142\x6a\x65\143\164"]) ? $config_mail["\163\165\x62\152\x65\143\x74"] : null; $body_head = !empty($config_mail["\x62\157\144\171\x5f\x68\145\x61\x64"]) ? $config_mail["\142\157\x64\x79\x5f\x68\x65\141\144"] : null; $body_main = !empty($config_mail["\x62\x6f\144\x79\137\155\x61\x69\156"]) ? $config_mail["\x62\157\x64\171\137\155\x61\151\x6e"] : null; $body_bottom = !empty($config_mail["\142\x6f\x64\171\x5f\142\x6f\164\164\157\x6d"]) ? $config_mail["\142\x6f\x64\x79\137\142\157\164\x74\x6f\x6d"] : null; $signature = !empty($config_mail["\163\x69\x67\156\x61\164\x75\x72\x65"]) ? $config_mail["\163\151\x67\156\x61\164\165\162\145"] : null; $attachments = !empty($config_mail["\x61\164\x74\x61\x63\x68\155\145\156\164\x73"]) ? $config_mail["\x61\164\164\x61\143\150\x6d\x65\156\x74\x73"] : array(); $wordwrap = !empty($config_mail["\167\x6f\162\x64\167\x72\141\160"]) ? intval($config_mail["\167\157\x72\x64\167\162\141\160"]) : 0; if (!empty($to) && !is_array($to)) { $to = explode("\x2c", $to); } if (!empty($cc) && !is_array($cc)) { $cc = explode("\x2c", $cc); } if (!empty($bcc) && !is_array($bcc)) { $to = explode("\x2c", $bcc); } if (!empty($replyto) && !is_array($replyto)) { $replyto = explode("\x2c", $replyto); } if (!empty($config_mail["\x6c\x61\x6e\147\x75\141\147\145"])) { switch (mb_strtolower($config_mail["\x6c\x61\x6e\147\x75\x61\x67\x65"])) { case "\x75\156\151\x63\157\144\x65": $language = "\x75\x6e\151"; $charset = "\x55\124\x46\x2d\70"; $encoding = "\x62\141\163\x65\x36\64"; break; case "\x75\x6e\151": $language = "\165\x6e\x69"; $charset = "\125\124\106\x2d\70"; $encoding = "\142\141\x73\x65\66\64"; break; case "\x75\x74\x66": $language = "\165\156\x69"; $charset = "\x55\x54\x46\55\70"; $encoding = "\142\141\163\x65\x36\64"; break; case "\x65\x6e\147\x6c\151\x73\x68": $language = "\145\x6e"; $charset = "\x49\x53\117\55\70\x38\x35\71\55\61"; $encoding = "\x38\142\x69\164"; break; case "\145\156": $language = "\145\x6e"; $charset = "\x49\x53\x4f\x2d\x38\70\65\71\55\x31"; $encoding = "\x38\x62\x69\164"; break; case "\145\156\137\x65\x6e": $language = "\x65\x6e"; $charset = "\x49\x53\117\x2d\70\x38\65\x39\55\x31"; $encoding = "\70\x62\x69\164"; break; case "\147\145\162\x6d\141\x6e": $language = "\145\156"; $charset = "\x49\123\117\55\70\70\x35\71\x2d\x31"; $encoding = "\x38\142\151\164"; break; case "\x64\145": $language = "\145\156"; $charset = "\111\x53\x4f\x2d\x38\x38\x35\x39\x2d\x31"; $encoding = "\x38\142\151\x74"; break; case "\x64\x65\137\x64\x65": $language = "\x65\156"; $charset = "\x49\x53\x4f\x2d\70\70\x35\71\55\x31"; $encoding = "\x38\142\x69\164"; break; case "\x66\x72\145\156\x63\150": $language = "\145\156"; $charset = "\111\x53\117\55\x38\70\65\71\x2d\x31"; $encoding = "\x38\142\151\x74"; break; case "\x66\162": $language = "\145\x6e"; $charset = "\x49\123\117\55\70\x38\65\x39\x2d\x31"; $encoding = "\x38\x62\151\x74"; break; case "\146\x72\137\x66\x72": $language = "\145\156"; $charset = "\111\123\x4f\55\x38\70\x35\71\55\61"; $encoding = "\70\x62\151\x74"; break; case "\x73\x70\141\156\151\163\x68": $language = "\145\156"; $charset = "\111\123\117\55\70\x38\x35\71\55\61"; $encoding = "\70\142\151\x74"; break; case "\x65\163": $language = "\x65\x6e"; $charset = "\111\123\x4f\x2d\70\70\x35\x39\x2d\x31"; $encoding = "\70\x62\x69\x74"; break; case "\145\163\x5f\145\x73": $language = "\145\x6e"; $charset = "\111\123\x4f\x2d\x38\x38\65\x39\x2d\61"; $encoding = "\x38\142\x69\164"; break; case "\151\x74\x61\154\151\141\x6e": $language = "\145\156"; $charset = "\111\123\x4f\55\70\70\65\71\x2d\61"; $encoding = "\x38\x62\x69\x74"; break; case "\151\164": $language = "\x65\x6e"; $charset = "\111\x53\117\x2d\70\x38\65\x39\55\61"; $encoding = "\x38\142\x69\164"; break; case "\x69\164\137\x69\x74": $language = "\145\156"; $charset = "\x49\x53\117\55\70\x38\x35\71\55\x31"; $encoding = "\70\142\151\x74"; break; case "\x6a\141\x70\x61\156\145\163\x65": $language = "\152\x61"; $charset = "\x49\x53\x4f\x2d\x32\60\x32\x32\55\x4a\120"; $encoding = "\x62\x61\163\x65\x36\x34"; break; case "\x6a\160": $language = "\152\141"; $charset = "\111\x53\x4f\x2d\x32\60\62\x32\55\x4a\x50"; $encoding = "\x62\141\x73\145\66\64"; break; case "\x6a\141\x5f\x6a\160": $language = "\152\141"; $charset = "\111\x53\x4f\x2d\62\x30\x32\x32\x2d\x4a\x50"; $encoding = "\x62\141\x73\x65\66\64"; break; case "\x6a\x61": $language = "\x6a\141"; $charset = "\x49\123\x4f\x2d\62\x30\x32\x32\x2d\112\x50"; $encoding = "\142\141\x73\145\66\x34"; break; } } else { $language = "\x75\x6e\151"; $charset = "\x55\124\x46\x2d\70"; $encoding = "\x62\x61\163\x65\x36\64"; } if (intval($php_version) >= 50201 && $charset == "\111\123\117\55\x32\x30\62\x32\55\112\120") { $charset = "\111\x53\x4f\x2d\62\60\x32\x32\55\112\x50\x2d\115\123"; } $mail->CharSet = $charset; $mail->Encoding = $encoding; $mail->WordWrap = 0; mb_language($language); if (!empty($config_smtp)) { $mail->SMTPDebug = 0; $mail->IsSMTP(); $mail->IsHTML(false); $mail->Host = "\154\157\143\x61\154\x68\x6f\163\164"; $mail->SMTPAuth = false; $mail->Port = 25; if (!empty($config_smtp["\150\157\x73\x74"])) { if (is_array($config_smtp["\150\157\163\x74"])) { $config_smtp["\x68\x6f\x73\164"] = implode("\73", $config_smtp["\x68\x6f\163\164"]); } $mail->Host = $config_smtp["\150\x6f\x73\164"]; } if (!empty($config_smtp["\x75\x73\x65\162\x5f\156\141\x6d\x65"]) && !empty($config_smtp["\x70\141\x73\163\167\157\x72\x64"])) { $mail->SMTPAuth = true; $mail->Username = $config_smtp["\x75\163\145\x72\137\156\141\x6d\x65"]; $mail->Password = $config_smtp["\x70\x61\163\163\167\157\162\x64"]; } if (!empty($config_smtp["\160\157\x72\x74"])) { if ($config_smtp["\160\x6f\x72\x74"] == "\x34\66\65") { $mail->SMTPSecure = "\163\163\x6c"; } if ($config_smtp["\160\157\162\x74"] == "\x35\x38\x37") { $mail->SMTPSecure = "\164\154\x73"; } $mail->Port = $config_smtp["\x70\x6f\162\x74"]; } if (!empty($wordwrap)) { if ($wordwrap = intval($config_mail["\167\x6f\x72\144\x77\162\x61\x70"])) { $mail->WordWrap = $wordwrap; } } } $mail->setFrom($from, mb_encode_mimeheader(mb_convert_encoding($from_name, $charset, "\101\125\x54\117"), $charset, "\x42", "\xa")); foreach ($to as $value) { $mail->addAddress($value); } if (!empty($cc)) { foreach ($cc as $value) { $mail->addCC($value); } } if (!empty($bcc)) { foreach ($bcc as $value) { $mail->addBCC($value); } } if (!empty($replyto)) { foreach ($replyto as $value) { $mail->addReplyTo($value); } } $mail->Subject = mb_encode_mimeheader(mb_convert_encoding($subject, $charset, "\x41\x55\x54\x4f"), $charset, "\x42", "\12"); $body = null; if ($to_name) { $body .= $to_name . "\xd\xa" . "\15\xa"; } if ($body_head) { $body .= $body_head . "\15\xa" . "\15\12"; } if ($body_main) { $body .= $body_main . "\xd\xa" . "\15\xa"; } if (!empty($contact) && is_array($contact)) { $body .= "\55\x2d\55" . "\xd\xa"; foreach ($contact as $key => $value) { $body .= $key . "\40\72\x20" . $value . "\xd\12"; } $body .= "\x2d\x2d\x2d" . "\xd\12" . "\xd\12"; } if ($body_bottom) { $body .= $body_bottom . "\15\12" . "\xd\12" . "\15\xa"; } if ($signature) { $body .= $signature . "\xd\12" . "\xd\xa" . "\xd\12"; } $body = mb_convert_encoding($body, $charset, "\x41\125\124\117"); $mail->Body = $body; if (!empty($attachments)) { foreach ($attachments as $attachment) { $mail->AddAttachment($attachment["\x66\151\x6c\x65\x5f\160\x61\164\150"], mb_encode_mimeheader(mb_convert_encoding($normalizer->normalize($attachment["\x66\151\x6c\x65\x5f\x6e\141\x6d\145"], "\x4e\x46\x43"), $charset, "\x41\x55\x54\117"), $charset, "\x42", "\12")); } } } else { return array("\162\x65\x73\165\154\164" => 0, "\x68\x74\164\x70\x5f\x73\x74\141\164\165\163\137\143\157\x64\145" => 400, "\x65\162\x72\157\162\x5f\160\x6f\151\x6e\164" => "\x62\141\144\137\162\145\x71\165\145\x73\164"); } if (!$mail->send()) { return array("\x72\x65\x73\165\154\164" => 0, "\150\164\164\x70\x5f\x73\x74\x61\164\165\x73\137\x63\x6f\x64\x65" => 400, "\145\162\x72\x6f\x72\x5f\x70\x6f\x69\156\x74" => "\x73\x65\x6e\x64\x5f\155\141\151\154", "\x65\170\164\162\x61\137\x6d\145\163\x73\141\x67\145" => $mail->ErrorInfo); } else { return array("\162\x65\163\x75\x6c\x74" => 1, "\150\164\x74\x70\137\163\x74\x61\164\x75\x73\137\x63\157\144\145" => 200, "\145\x72\162\x6f\162\x5f\x70\x6f\151\156\164" => "\156\157\156\x65"); } } goto p_owe; hNwlT: function post_contact($postdata) { global $database; global $pdo; global $table_prefix; if (!empty($postdata)) { $site = !empty($postdata["\163\x69\x74\x65"]) ? $postdata["\x73\151\x74\145"] : null; $site_id = !empty($postdata["\163\151\x74\x65\x5f\151\x64"]) ? $postdata["\x73\151\x74\145\137\151\144"] : 1; $posttype = !empty($postdata["\160\x6f\x73\x74\x74\171\160\145"]) ? $postdata["\160\157\163\164\x74\x79\x70\145"] : null; $posttype_id = !empty($postdata["\x70\157\x73\164\x74\x79\160\x65\x5f\x69\144"]) ? $postdata["\x70\157\x73\164\164\171\160\145\137\x69\x64"] : 1001; $language = !empty($postdata["\154\141\x6e\147\x75\141\147\x65"]) ? $postdata["\x6c\141\x6e\147\x75\141\x67\145"] : null; $language_id = !empty($postdata["\x6c\141\x6e\x67\x75\141\x67\145\137\151\x64"]) ? $postdata["\154\x61\156\147\165\x61\147\145\137\x69\144"] : 1; $group = !empty($postdata["\x67\162\157\x75\160"]) ? $postdata["\147\x72\x6f\x75\x70"] : null; $group_id = !empty($postdata["\x67\162\x6f\165\x70\137\151\x64"]) ? $postdata["\x67\162\157\165\x70\x5f\151\144"] : 0; $title = !empty($postdata["\164\x69\x74\154\x65"]) ? $postdata["\164\151\x74\x6c\x65"] : null; $content = !empty($postdata["\143\x6f\156\164\x65\156\x74"]) ? $postdata["\143\157\156\164\x65\156\x74"] : null; $name = !empty($postdata["\x6e\141\155\x65"]) ? $postdata["\156\141\x6d\x65"] : null; $email = !empty($postdata["\x65\x6d\141\x69\154"]) ? $postdata["\145\x6d\x61\x69\x6c"] : null; $tel = !empty($postdata["\164\145\x6c"]) ? $postdata["\x74\145\x6c"] : null; $contacted_at = date("\x59\x2d\155\55\x64\x20\x48\72\x69\x3a\163"); $created_at = date("\131\x2d\155\55\x64\40\x48\x3a\151\x3a\x73"); $category_id = "\60\x30\x30\60"; if ($site) { $site_id = 9999; $sql = "\123\105\x4c\105\103\124\40\x69\x64\x20\106\122\117\115\x20{$table_prefix}\x73\151\164\145\x73\x20\x57\110\x45\x52\x45\x20\x64\x65\x6c\145\164\x65\137\146\154\147\40\x3d\x20\60\40\x41\116\104\40\x73\x74\141\164\x75\163\40\x3d\40\61\40\101\x4e\104\x20\163\x6c\x75\147\40\x3d\40\x27{$site}\x27"; $read_records = $pdo->prepare($sql); $read_records->execute(); if ($record = $read_records->fetch(PDO::FETCH_ASSOC)) { $site_id = intval($record["\151\x64"]); } unset($read_records); } if ($posttype) { $posttype_id = 9999; $sql = "\123\105\x4c\x45\103\x54\x20\151\144\x20\x46\x52\117\x4d\x20{$table_prefix}\x70\x6f\163\164\164\x79\160\145\x73\x20\x57\110\x45\122\x45\x20\144\x65\154\x65\164\x65\137\146\x6c\147\x20\x3d\x20\x30\40\x41\x4e\x44\x20\x73\164\x61\164\x75\x73\40\75\x20\61\x20\x41\116\104\40\x73\154\x75\x67\x20\75\x20\47{$posttype}\x27"; $read_records = $pdo->prepare($sql); $read_records->execute(); if ($record = $read_records->fetch(PDO::FETCH_ASSOC)) { $posttype_id = intval($record["\x69\144"]); } unset($read_records); } if ($language) { $language_id = 9999; $sql = "\x53\x45\x4c\x45\x43\124\x20\151\x64\40\106\122\x4f\115\40{$table_prefix}\154\x61\156\x67\x75\141\x67\x65\163\x20\127\x48\x45\x52\x45\40\163\154\165\x67\x20\75\40\47{$language}\47"; $read_records = $pdo->prepare($sql); $read_records->execute(); if ($record = $read_records->fetch(PDO::FETCH_ASSOC)) { $language_id = intval($record["\151\144"]); } unset($read_records); } if ($group) { $sql = "\123\x45\114\105\103\124\x20\151\144\40\106\x52\x4f\x4d\x20{$table_prefix}\x67\x72\157\165\160\x73\x20\127\x48\x45\x52\x45\40\163\154\165\147\40\75\40\47{$group}\x27"; $read_records = $pdo->prepare($sql); $read_records->execute(); if ($record = $read_records->fetch(PDO::FETCH_ASSOC)) { $group_id = intval($record["\x69\x64"]); } unset($read_records); } if (!empty($postdata["\143\x61\164\x65\147\157\162\171\137\151\144"])) { if (is_array($postdata["\143\x61\x74\x65\x67\x6f\x72\x79\137\x69\x64"])) { foreach ($postdata["\143\x61\x74\x65\x67\x6f\162\171\137\151\144"] as $key => $value) { $postdata["\143\141\x74\145\147\x6f\162\x79\137\151\144"][$key] = sprintf("\45\x30\64\x64", $value); } $category_id = implode("\x2c", $postdata["\143\141\164\x65\x67\157\162\x79\137\x69\144"]); } else { $category_id = sprintf("\45\60\64\144", $postdata["\x63\x61\x74\145\x67\x6f\162\x79\x5f\x69\144"]); } } $new_contact_id = 0; try { $pdo->beginTransaction(); $sql = "\xa\x9\x9\x9\x9\x9\x49\x4e\123\105\x52\124\x20\x49\x4e\124\x4f\x20{$table_prefix}\x63\x6f\156\164\141\x63\164\x73\137\142\141\163\145\xa\x9\11\x9\x9\x9\11\50\40\x73\x69\x74\145\x5f\x69\x64\54\x20\x20\160\x6f\x73\164\164\x79\160\x65\137\x69\144\x2c\40\40\154\x61\x6e\147\165\x61\x67\145\x5f\x69\144\x2c\x20\x20\x67\162\x6f\x75\160\137\x69\144\x2c\40\x20\x63\x61\x74\145\147\x6f\x72\x79\137\x69\x64\x2c\x20\x20\164\151\164\x6c\x65\x2c\40\40\x63\157\x6e\164\x65\156\164\54\x20\x20\156\141\155\x65\x2c\40\x20\145\155\x61\151\154\x2c\x20\x20\164\145\154\x2c\40\x20\143\x6f\x6e\164\x61\x63\164\145\x64\x5f\141\164\54\40\40\x63\162\145\141\164\x65\144\x5f\x61\164\51\xa\11\x9\11\x9\x9\x56\101\114\x55\105\123\12\x9\x9\x9\x9\x9\11\x28\x3a\123\x49\x54\x45\137\111\x44\x2c\40\x3a\x50\x4f\x53\124\x54\131\120\x45\137\111\104\54\40\72\x4c\101\116\107\125\x41\107\105\x5f\111\x44\x2c\40\72\x47\122\117\x55\120\137\111\104\54\40\72\x43\x41\x54\x45\x47\117\122\131\137\111\x44\x2c\x20\72\x54\x49\124\114\105\54\x20\x3a\x43\117\116\124\x45\116\124\54\40\x3a\116\x41\x4d\x45\54\40\x3a\105\115\x41\111\x4c\54\x20\x3a\124\x45\x4c\x2c\40\x3a\103\x4f\116\124\101\103\124\x45\x44\x5f\101\x54\x2c\40\x3a\103\x52\x45\x41\124\x45\104\137\101\124\51\12\11\x9\x9"; $create_contact_base = $pdo->prepare($sql); $create_contact_base->bindValue("\72\123\x49\x54\105\137\x49\104", $site_id, PDO::PARAM_INT); $create_contact_base->bindValue("\x3a\120\x4f\x53\124\124\131\x50\x45\137\111\x44", $posttype_id, PDO::PARAM_INT); $create_contact_base->bindValue("\72\x4c\101\x4e\107\x55\x41\x47\x45\x5f\x49\104", $language_id, PDO::PARAM_INT); $create_contact_base->bindValue("\72\x47\x52\117\125\x50\x5f\111\104", $group_id, PDO::PARAM_INT); $create_contact_base->bindValue("\72\x43\x41\124\105\x47\117\122\131\x5f\x49\x44", $category_id, PDO::PARAM_STR); $create_contact_base->bindValue("\72\124\111\124\x4c\x45", $title, PDO::PARAM_STR); $create_contact_base->bindValue("\72\x43\117\116\124\105\116\124", $content, PDO::PARAM_STR); $create_contact_base->bindValue("\x3a\x4e\101\115\105", $name, PDO::PARAM_STR); $create_contact_base->bindValue("\72\x45\115\101\111\x4c", $email, PDO::PARAM_STR); $create_contact_base->bindValue("\72\x54\105\x4c", $tel, PDO::PARAM_STR); $create_contact_base->bindValue("\72\x43\117\x4e\x54\101\103\x54\x45\104\137\x41\x54", $contacted_at, PDO::PARAM_STR); $create_contact_base->bindValue("\72\x43\122\105\x41\x54\105\104\x5f\x41\x54", $created_at, PDO::PARAM_STR); $create_contact_base->execute(); unset($create_contact_base); $sql = "\x53\105\x4c\x45\103\124\40\151\x64\x20\106\x52\x4f\115\40{$table_prefix}\143\x6f\156\x74\x61\x63\164\163\137\142\141\x73\145\x20\x4f\x52\104\x45\122\40\102\x59\40\151\144\40\104\x45\123\103\40\114\x49\115\x49\124\x20\x30\54\x20\61"; $get_new_contact = $pdo->prepare($sql); $get_new_contact->execute(); if ($new_contact = $get_new_contact->fetch(PDO::FETCH_ASSOC)) { $new_contact_id = $new_contact["\151\x64"]; unset($get_new_contact); } if (!empty($new_contact_id)) { foreach ($postdata as $key => $value) { if (false === in_array($key, array("\164\151\x74\154\145", "\x6e\x61\x6d\x65", "\145\155\x61\151\x6c", "\164\145\154", "\x63\x6f\x6e\x74\145\x6e\x74", "\151\164\x65\x6d\x73"))) { $sql = "\xa\11\x9\11\x9\x9\11\11\123\105\114\105\x43\x54\40\151\x64\x20\106\x52\x4f\x4d\40{$table_prefix}\x63\165\x73\x74\x6f\155\137\x69\x74\145\155\x73\xa\x9\11\x9\11\x9\11\x9\x57\x48\x45\x52\105\40\x64\145\x6c\145\x74\x65\x5f\x66\x6c\x67\40\x3d\x20\x30\x20\101\x4e\x44\40\x73\x74\x61\x74\165\x73\40\75\x20\x31\x20\101\116\104\40\x70\x6f\x73\164\164\x79\x70\x65\x5f\x69\144\x20\x3d\40{$posttype_id}\40\101\x4e\104\x20\x73\x6c\x75\x67\x20\75\x20\x27{$key}\47\12\11\x9\11\x9\11\x9"; $read_custom_item = $pdo->prepare($sql); $read_custom_item->execute(); if ($custom_item = $read_custom_item->fetch(PDO::FETCH_ASSOC)) { $custom_item_id = $custom_item["\x69\144"]; $postdata["\x69\x74\x65\155\163"][$custom_item_id] = $value; } unset($read_custom_item); } } if (!empty($postdata["\151\x74\x65\155\x73"])) { foreach ($postdata["\151\164\145\155\x73"] as $custom_item_id => $value) { if (is_array($value)) { $value = implode("\54", $value); } $sql = "\xa\11\x9\x9\x9\11\11\11\111\x4e\123\105\122\124\x20\111\x4e\x54\117\40{$table_prefix}\143\157\x6e\164\x61\x63\x74\163\x5f\x63\x75\163\x74\157\155\xa\x9\11\x9\x9\11\11\x9\x9\x28\x20\x62\x61\x73\145\137\x69\144\x2c\x20\x20\143\x75\x73\x74\x6f\x6d\137\151\x74\145\155\x5f\151\144\x2c\x20\40\x76\141\154\x75\145\51\12\x9\11\x9\11\11\11\11\x56\x41\x4c\x55\105\x53\12\x9\x9\11\x9\x9\11\x9\x9\x28\72\x42\x41\123\x45\x5f\111\104\54\40\72\103\x55\123\124\x4f\x4d\137\111\124\x45\x4d\x5f\111\x44\x2c\40\x3a\x56\x41\x4c\125\105\51\xa\x9\x9\x9\x9\x9\11"; $create_contact_custom = $pdo->prepare($sql); $create_contact_custom->bindValue("\72\102\101\123\105\x5f\x49\x44", $new_contact_id, PDO::PARAM_INT); $create_contact_custom->bindValue("\x3a\x43\125\123\124\x4f\x4d\x5f\111\x54\x45\x4d\x5f\111\104", $custom_item_id, PDO::PARAM_INT); $create_contact_custom->bindValue("\x3a\x56\101\114\125\105", $value, PDO::PARAM_STR); $create_contact_custom->execute(); unset($create_contact_custom); } } } $pdo->commit(); } catch (PDOException $e) { $pdo->rollBack(); return false; } return $new_contact_id; } return false; } goto Wfb0P; acPqs: function get_languages($config = array()) { global $database; global $pdo; global $table_prefix; $posttype = !empty($config["\160\157\163\x74\x74\x79\160\x65"]) ? $config["\x70\157\163\x74\164\171\160\145"] : null; $posttype_id = isset($config["\x70\x6f\x73\164\x74\x79\x70\145\137\151\144"]) ? intval($config["\x70\157\x73\x74\164\x79\x70\x65\137\151\x64"]) : 1; $key_by = !empty($config["\x6b\x65\x79\x5f\x62\171"]) ? $config["\x6b\145\x79\x5f\142\x79"] : null; if ($posttype) { $posttype_id = 9999; $sql = "\123\x45\114\x45\103\124\x20\x69\144\40\x46\x52\x4f\115\40{$table_prefix}\160\x6f\163\x74\x74\171\x70\x65\163\x20\x57\x48\x45\122\105\40\144\145\154\145\164\x65\137\x66\154\147\40\x3d\x20\x30\x20\x41\x4e\104\40\x73\164\141\164\x75\x73\x20\x3d\x20\61\x20\x41\x4e\104\x20\163\x6c\x75\147\40\x3d\40\x27{$posttype}\47"; $read_records = $pdo->prepare($sql); $read_records->execute(); if ($record = $read_records->fetch(PDO::FETCH_ASSOC)) { $posttype_id = intval($record["\151\144"]); } unset($read_records); } $qsc_target_id = null; if ($posttype_id > 0) { $language_id = null; try { $sql = "\x53\x45\x4c\x45\x43\124\40\x6c\x61\x6e\147\x75\141\x67\145\137\x69\x64\x20\x46\x52\117\115\40{$table_prefix}\x70\157\163\x74\x74\x79\160\x65\x73\x20\x57\x48\x45\x52\x45\x20\144\x65\154\x65\164\x65\x5f\x66\x6c\x67\40\75\40\x30\x20\101\116\104\40\163\164\141\164\x75\163\40\75\x20\61\x20\x41\116\x44\x20\x69\x64\40\75\40\72\111\x44"; $read_records = $pdo->prepare($sql); $read_records->bindValue("\72\x49\104", $posttype_id, PDO::PARAM_INT); $read_records->execute(); if ($record = $read_records->fetch(PDO::FETCH_ASSOC)) { $language_id = $record["\154\x61\156\x67\x75\141\x67\145\137\x69\144"]; } unset($read_records); } catch (PDOException $e) { var_dump($e->getMessage()); } $language_id_arr = explode("\x2c", $language_id); foreach ($language_id_arr as $key => $value) { $language_id_arr[$key] = intval($value); } $target_id = implode("\54", $language_id_arr); $qsc_target_id = "\101\116\104\x20\x6c\x67\56\151\x64\x20\111\x4e\x20\x28{$target_id}\51"; } $languages = array(); try { $sql = "\12\x9\11\x9\11\x53\105\x4c\x45\103\124\12\x9\x9\x9\11\x9\x6c\147\56\151\144\x20\x41\123\x20\47\151\144\x27\x2c\12\11\11\11\x9\x9\154\x67\56\x6e\141\x6d\145\x20\x41\x53\x20\x27\x6c\x61\x62\145\x6c\x27\54\xa\x9\11\11\x9\11\x6c\147\56\163\154\165\147\40\x41\x53\x20\x27\163\154\x75\x67\47\54\12\11\11\x9\11\11\x63\166\56\143\x6f\166\x65\x72\x5f\151\155\x61\x67\x65\xa\x9\x9\11\11\x46\x52\x4f\x4d\40{$table_prefix}\154\141\156\147\x75\x61\x67\145\163\x20\101\x53\x20\x6c\147\12\11\x9\x9\x9\11\114\x45\106\124\x20\117\x55\x54\x45\x52\x20\112\x4f\111\x4e\40\x28\123\x45\114\105\x43\x54\40\x2a\x20\106\122\117\x4d\40{$table_prefix}\143\x6f\x76\x65\162\163\40\x57\x48\x45\122\x45\40\145\156\164\x69\164\171\x5f\143\157\x64\x65\40\75\x20\x33\x29\x20\101\x53\40\x63\166\12\11\x9\x9\x9\11\x9\x4f\116\40\x6c\x67\56\151\144\40\75\x20\x63\166\56\x65\x6e\164\151\x74\x79\137\x69\144\xa\11\x9\x9\x9\x57\x48\105\x52\105\xa\x9\x9\11\x9\11\154\x67\56\144\x65\x6c\145\164\x65\x5f\146\154\x67\x20\75\40\x30\xa\x9\x9\11\11\x9\x41\x4e\104\40\x6c\x67\x2e\163\164\141\164\x75\163\40\x3d\40\x31\12\x9\x9\11\x9\11{$qsc_target_id}\xa\x9\x9\x9\11\117\122\104\105\x52\x20\x42\x59\x20\x6c\x67\x2e\154\x69\x6e\145\137\x6f\162\144\x65\x72\x20\101\123\103\xa\x9\11"; $read_languages = $pdo->prepare($sql); $read_languages->execute(); while ($record = $read_languages->fetch(PDO::FETCH_ASSOC)) { $languages[$record["\x69\144"]] = $record; } unset($read_languages); } catch (PDOException $e) { var_dump($e->getMessage()); } $languages_fixed = array(); if (!empty($key_by)) { if ($key_by == "\x69\x64") { foreach ($languages as $row) { $languages_fixed[$row["\151\144"]] = $row; } } elseif ($key_by == "\154\141\x62\145\x6c") { foreach ($languages as $row) { $languages_fixed[$row["\x6c\141\x62\145\154"]] = $row; } } elseif ($key_by == "\x6e\x75\155\142\x65\x72") { $languages_fixed = index_fromone($languages); } else { foreach ($languages as $row) { $languages_fixed[$row["\x73\x6c\165\147"]] = $row; } } } else { foreach ($languages as $row) { $languages_fixed[$row["\x73\x6c\165\x67"]] = $row; } } return $languages_fixed; } goto ca1_i; ER59W: function reset_contact($contact, $targets = array()) { $contact_reset = array(); if (!empty($contact) && !empty($targets)) { foreach ($targets as $key_target => $label) { if (array_key_exists($key_target, $contact)) { if (!empty($label)) { $contact_reset[$label] = $contact[$key_target]; } else { $contact_reset[$key_target] = $contact[$key_target]; } } } return $contact_reset; } elseif (!empty($contact) && empty($targets)) { return $contact; } return false; } goto ZB2Y5; ZKAA8: function get_post($post_key, $config = array(), $recursive = true) { global $database; global $pdo; global $table_prefix; $id = 0; if (!empty($post_key)) { if (preg_match("\57\136\x5b\141\55\146\60\x2d\71\x5d\x7b\63\62\175\44\57", $post_key)) { $preview_hash_salt = null; $sql = "\12\11\11\11\11\x53\105\x4c\105\x43\x54\40\x76\141\154\165\145\x20\106\122\x4f\115\40{$table_prefix}\x63\157\156\x66\x69\x67\163\xa\x9\x9\x9\11\127\x48\105\122\105\40\151\x74\145\155\40\75\40\x27\160\162\145\166\x69\145\x77\x5f\150\x61\x73\x68\137\x73\x61\154\x74\x27\xa\x9\11\11\11"; $read_config = $pdo->prepare($sql); $read_config->execute(); while ($config = $read_config->fetch(PDO::FETCH_ASSOC)) { $preview_hash_salt = $config["\166\141\154\165\x65"]; } unset($read_config); $decoded_exp = decodeHashId(substr($post_key, 0, 20), 20, $preview_hash_salt); $decoded_id = decodeHashId(substr($post_key, 20, 9), 9, $preview_hash_salt); $decoded_version = decodeHashId(substr($post_key, 29, 3), 3, $preview_hash_salt); $time = (int) ($decoded_exp[0] . "\60"); if ($time + 86400 >= time()) { $id = $decoded_id[0]; $config["\x70\162\x65\166\151\x65\x77"] = 1; $config["\x76\145\x72\163\151\157\x6e"] = $decoded_version[0]; } } elseif (preg_match("\x2f\x5e\x5b\141\x2d\x66\60\55\71\x5d\x7b\61\x32\x7d\x24\57", $post_key)) { try { $sql = "\x53\x45\x4c\x45\x43\x54\x20\x69\144\x20\x46\x52\x4f\x4d\40{$table_prefix}\x70\x6f\x73\x74\x73\137\142\141\163\145\x20\x57\110\105\122\x45\x20\x64\145\154\x65\164\145\137\146\x6c\147\x20\75\x20\60\40\101\116\x44\x20\x68\141\x73\150\x5f\x69\x64\40\75\x20\72\110\101\x53\110\x5f\111\104"; $read_id = $pdo->prepare($sql); $read_id->bindValue("\x3a\x48\x41\123\110\x5f\111\104", $post_key, PDO::PARAM_STR); $read_id->execute(); if ($record = $read_id->fetch(PDO::FETCH_ASSOC)) { $id = intval($record["\151\x64"]); } unset($read_id); } catch (PDOException $e) { var_dump($e->getMessage()); } } elseif (is_numeric($post_key) && strlen($post_key) < 11) { $id = intval($post_key); } else { try { if (preg_match("\x2f\x5e\x5c\x2f\56\x2a\57", $post_key)) { $sql = "\123\105\x4c\x45\103\124\x20\151\144\40\x46\122\117\115\x20{$table_prefix}\160\157\x73\x74\163\137\142\x61\x73\145\40\127\x48\x45\x52\105\x20\x64\145\x6c\x65\164\145\137\146\x6c\x67\40\75\x20\x30\40\101\116\104\40\160\x65\x72\155\x61\x6c\151\156\153\137\165\x72\x69\x20\x3d\x20\x3a\x55\x52\x49"; $read_id = $pdo->prepare($sql); $read_id->bindValue("\72\x55\122\x49", $post_key, PDO::PARAM_STR); $read_id->execute(); if ($record = $read_id->fetch(PDO::FETCH_ASSOC)) { $id = intval($record["\151\x64"]); } } else { $sql = "\123\105\x4c\x45\103\124\40\151\x64\40\106\x52\x4f\115\x20{$table_prefix}\x70\x6f\x73\164\163\137\142\141\163\x65\x20\127\x48\105\x52\105\x20\144\x65\154\x65\x74\145\137\146\x6c\x67\x20\75\x20\60\40\x41\116\x44\x20\x28\163\x6c\x75\147\x20\75\x20\72\123\114\x55\x47\40\117\122\x20\x70\145\x72\155\141\x6c\x69\x6e\x6b\x5f\153\145\171\x20\75\40\x3a\x50\105\x52\115\x41\114\x49\x4e\x4b\137\x4b\x45\131\x29"; $read_id = $pdo->prepare($sql); $read_id->bindValue("\x3a\x53\x4c\125\107", $post_key, PDO::PARAM_STR); $read_id->bindValue("\x3a\120\105\x52\115\101\114\111\116\113\137\x4b\x45\131", $post_key, PDO::PARAM_STR); $read_id->execute(); if ($record = $read_id->fetch(PDO::FETCH_ASSOC)) { $id = intval($record["\x69\144"]); } } unset($read_id); } catch (PDOException $e) { var_dump($e->getMessage()); } } } $language = !empty($config["\154\x61\156\x67\165\141\x67\145"]) ? $config["\x6c\x61\156\x67\x75\141\x67\145"] : null; $language_id = !empty($config["\x6c\141\156\147\165\x61\x67\145\x5f\151\144"]) ? intval($config["\154\141\x6e\x67\x75\141\x67\x65\137\151\144"]) : 1; $eyecatch_frame = !empty($config["\145\x79\145\143\x61\164\x63\150\137\x66\162\x61\155\x65"]) ? $config["\x65\x79\x65\143\x61\164\x63\150\x5f\x66\x72\x61\x6d\145"] : null; $content_frame = !empty($config["\x63\x6f\156\164\x65\156\x74\137\x66\x72\141\x6d\x65"]) ? $config["\x63\x6f\156\164\x65\156\x74\137\x66\162\141\x6d\145"] : null; $custom_frame = !empty($config["\143\x75\x73\164\x6f\x6d\x5f\x66\x72\141\x6d\x65"]) ? $config["\143\165\x73\164\x6f\x6d\x5f\x66\162\x61\x6d\145"] : array(); $with_child_custom = isset($config["\x77\x69\164\x68\137\x63\x68\151\154\144\x5f\x63\x75\163\x74\x6f\x6d"]) ? intval($config["\x77\x69\164\x68\137\x63\x68\151\154\x64\x5f\143\x75\163\x74\x6f\x6d"]) : 0; $with_counter = isset($config["\x77\x69\164\150\x5f\x63\x6f\x75\156\164\x65\162"]) ? intval($config["\167\x69\x74\x68\x5f\143\x6f\x75\156\x74\145\162"]) : 1; $content_head_length = isset($config["\x63\157\156\x74\145\x6e\x74\x5f\150\145\x61\144\x5f\154\145\x6e\147\164\150"]) ? intval($config["\143\x6f\156\164\x65\x6e\164\137\150\x65\x61\144\137\x6c\145\156\x67\x74\150"]) : 25; $version = !empty($config["\x76\145\x72\163\x69\157\156"]) ? intval($config["\166\x65\162\x73\151\157\156"]) : 0; $preview = isset($config["\160\162\145\x76\151\x65\x77"]) ? intval($config["\x70\x72\145\x76\x69\145\167"]) : 0; $permalink_base = null; $now = date("\x59\55\155\x2d\144\40\x48\x3a\x69\72\x73"); $qsc_version = !empty($version) ? "\x41\x4e\104\40\x70\x62\56\x76\x65\x72\x73\151\157\x6e\x20\x3d\40{$version}" : "\x41\x4e\x44\x20\160\142\x2e\x63\x75\x72\162\x65\x6e\x74\137\x66\154\147\x20\75\40\x31"; $qsc_publish_datetime = !$preview ? "\x41\x4e\104\x20\x70\142\56\160\x75\x62\x6c\151\x73\150\x5f\x64\x61\164\x65\x74\x69\155\145\40\x3c\x3d\40\x27{$now}\47" : null; $qsc_publish_end_at = !$preview ? "\101\x4e\x44\40\50\160\x62\56\x70\165\142\x6c\151\163\150\x5f\x65\x6e\144\x5f\x61\164\40\76\x20\x27{$now}\x27\x20\117\122\x20\160\142\x2e\x70\165\142\x6c\151\163\150\137\x65\156\144\137\x61\x74\x20\x49\x53\40\x4e\x55\114\114\51" : null; $qsc_status = !$preview ? "\x41\116\x44\40\160\142\x2e\163\x74\141\x74\x75\x73\x20\x3d\40\61" : "\101\x4e\x44\40\x70\142\x2e\x73\164\141\x74\x75\163\x20\74\75\x20\62"; if (!empty($id)) { if ($language) { $language_id = 9999; $sql = "\123\105\114\x45\x43\124\x20\x69\x64\40\106\x52\117\x4d\x20{$table_prefix}\x6c\141\x6e\147\x75\141\147\x65\x73\40\x57\x48\105\122\105\x20\163\154\165\x67\40\x3d\x20\47{$language}\47"; $read_records = $pdo->prepare($sql); $read_records->execute(); if ($record = $read_records->fetch(PDO::FETCH_ASSOC)) { $language_id = intval($record["\x69\x64"]); } unset($read_records); } $post = array(); $i_page = 1; $post_pages = array(); $post_base = array(); $post_category = array(); $post_tag = array(); $post_text = array(); $post_custom = array(); $post_family = array(); $post_page_navi = array(); $qsi_publish_datetime = $database == 1 ? "\123\x55\x42\123\x54\x52\x28\160\142\56\160\x75\142\x6c\151\163\x68\137\x64\141\x74\145\164\x69\x6d\145\54\x20\61\54\x20\61\x36\51" : "\123\x55\x42\x53\124\122\x49\116\x47\50\160\142\56\x70\x75\142\154\151\x73\150\x5f\x64\x61\164\x65\x74\151\155\x65\x2c\x20\61\x2c\40\x31\66\51"; $qsi_publish_date = $database == 1 ? "\x53\125\x42\x53\x54\122\50\160\142\56\160\x75\142\x6c\151\163\x68\137\x64\x61\x74\x65\164\151\x6d\145\x2c\40\61\54\x20\x31\x30\51" : "\123\x55\x42\x53\124\x52\x49\116\107\50\x70\x62\x2e\160\x75\x62\x6c\x69\x73\x68\137\144\x61\x74\145\x74\x69\155\145\x2c\40\x31\x2c\x20\61\60\x29"; $qsi_publish_year = $database == 1 ? "\x53\124\x52\106\124\x49\x4d\x45\x28\x27\45\x59\47\x2c\40\160\142\56\x70\x75\x62\154\151\x73\x68\x5f\144\x61\164\145\164\x69\x6d\145\x29" : "\131\x45\101\122\x28\x70\x62\56\160\x75\x62\154\151\x73\x68\x5f\x64\x61\164\145\x74\151\x6d\145\x29"; $qsi_publish_month = $database == 1 ? "\x53\124\x52\106\124\111\115\x45\50\47\45\155\47\54\x20\x70\142\x2e\x70\x75\x62\x6c\151\163\x68\137\144\x61\164\x65\164\x69\155\145\x29" : "\x4d\117\116\124\110\50\x70\142\x2e\160\x75\x62\154\151\x73\x68\x5f\144\x61\x74\x65\x74\x69\x6d\x65\51"; $qsi_publish_day = $database == 1 ? "\x53\124\122\x46\x54\x49\115\105\x28\x27\45\x64\47\54\x20\160\x62\x2e\x70\x75\x62\x6c\x69\163\x68\137\144\x61\164\x65\x74\x69\155\x65\x29" : "\x44\x41\131\50\x70\142\56\160\165\x62\x6c\x69\x73\150\137\x64\x61\x74\145\x74\x69\x6d\145\x29"; try { $sql = "\12\x9\x9\11\11\11\123\105\x4c\105\x43\x54\12\11\11\x9\11\11\x9\160\142\x2e\151\x64\x20\101\x53\x20\x27\x69\x64\47\x2c\xa\x9\11\x9\x9\x9\11\x70\142\x2e\150\141\163\150\137\x69\x64\40\x41\123\x20\x27\150\x61\163\x68\x5f\x69\144\x27\54\xa\x9\11\x9\x9\11\x9\160\142\x2e\x70\x65\162\x6d\x61\x6c\x69\156\x6b\x5f\153\x65\x79\x20\x41\x53\x20\x27\x70\x6f\x73\x74\137\x6b\x65\x79\x27\54\xa\x9\x9\x9\11\x9\11\156\165\154\154\40\x41\x53\40\x27\160\x65\162\x6d\141\x6c\151\156\x6b\47\x2c\xa\x9\11\x9\11\11\x9\160\x62\x2e\x70\x65\162\155\x61\154\x69\x6e\153\137\x75\162\x69\x20\101\x53\x20\x27\x70\x65\x72\155\141\154\x69\x6e\153\137\165\162\x69\x27\54\xa\x9\x9\x9\x9\x9\x9\x70\x62\x2e\166\x65\162\163\x69\157\x6e\x20\101\123\x20\x27\x76\x65\x72\x73\x69\157\156\47\x2c\12\x9\11\x9\11\11\11{$qsi_publish_datetime}\x20\x41\123\x20\x27\160\165\142\x6c\x69\163\150\137\x64\x61\164\x65\x74\151\155\145\x27\54\12\x9\x9\11\x9\11\x9{$qsi_publish_date}\x20\101\123\x20\x27\160\165\142\154\151\x73\150\x5f\144\x61\164\145\47\54\xa\x9\11\x9\x9\x9\11{$qsi_publish_year}\40\101\x53\40\47\x70\165\x62\x6c\x69\163\x68\137\171\x65\x61\x72\x27\54\12\11\x9\11\x9\x9\11{$qsi_publish_month}\40\101\x53\40\47\x70\165\142\x6c\x69\163\150\137\155\157\x6e\164\x68\47\x2c\12\x9\x9\x9\x9\x9\x9{$qsi_publish_day}\x20\101\x53\40\47\160\x75\142\154\151\x73\x68\x5f\x64\141\171\47\x2c\12\x9\x9\x9\x9\x9\x9\160\x62\x2e\160\165\142\x6c\x69\x73\x68\x5f\145\x6e\144\x5f\x61\164\40\x41\123\x20\47\160\x75\x62\154\151\x73\150\137\145\x6e\x64\137\x61\x74\47\54\12\11\x9\11\11\11\x9\160\x62\x2e\x73\151\164\145\x5f\151\x64\x20\x41\x53\x20\47\x73\151\164\145\x5f\x69\144\x27\54\12\11\11\x9\11\x9\x9\160\142\x2e\160\157\163\164\x74\171\x70\x65\137\x69\x64\40\x41\123\40\47\160\157\x73\x74\x74\171\x70\145\137\x69\144\47\x2c\12\11\11\11\x9\11\11\160\x74\x2e\x6c\x61\x6e\x67\165\141\x67\x65\x5f\151\x64\x20\101\x53\x20\47\154\x61\x6e\x67\x75\x61\x67\x65\137\151\144\x27\x2c\xa\11\11\11\11\x9\11\160\x62\56\x70\x61\x72\145\x6e\164\137\151\144\40\x41\123\40\x27\x70\141\x72\145\156\164\x5f\151\x64\47\54\12\11\x9\x9\11\x9\x9\x70\x62\x2e\141\156\143\x68\x6f\162\40\x41\123\40\47\141\156\x63\x68\x6f\x72\x27\54\12\11\11\x9\x9\x9\11\160\142\x2e\x63\162\x65\141\x74\x65\x64\137\141\x74\40\101\x53\40\47\143\162\x65\x61\x74\x65\x64\x5f\141\x74\47\54\xa\x9\11\11\x9\11\11\x70\x62\x2e\143\x72\145\141\x74\x65\x64\x5f\x62\171\40\x41\123\40\47\x63\162\x65\x61\x74\x65\144\x5f\142\x79\47\54\12\x9\11\x9\x9\11\x9\x70\142\56\165\160\144\141\164\x65\x64\137\x61\164\40\101\123\40\x27\x75\x70\x64\x61\x74\145\144\137\141\164\x27\54\xa\x9\11\x9\x9\11\x9\x75\163\x2e\x6e\151\143\153\156\x61\155\x65\40\101\123\40\47\141\165\164\150\157\162\x27\54\12\x9\x9\11\11\x9\x9\160\x62\56\163\164\141\164\165\163\40\101\x53\40\x27\163\x74\141\x74\x75\163\47\x2c\12\11\x9\11\11\11\x9\160\142\56\144\x65\x6c\145\164\145\x5f\146\x6c\147\x20\101\123\x20\x27\144\145\x6c\145\x74\145\137\x66\154\x67\x27\x2c\xa\x9\x9\11\11\x9\x9\160\142\56\x73\x6c\x75\x67\x20\101\x53\x20\x27\x73\154\165\x67\47\x2c\12\x9\11\x9\x9\x9\x9\x70\142\56\x65\171\x65\x63\141\164\143\x68\x20\x41\123\40\47\145\x79\145\143\x61\164\143\150\x5f\162\x61\167\47\54\12\x9\11\11\x9\11\x9\x6e\x75\154\x6c\x20\x41\123\x20\47\x65\171\x65\143\141\164\x63\150\x27\x2c\xa\x9\x9\x9\x9\x9\x9\160\x74\56\x74\151\x74\154\x65\x20\101\123\40\x27\x74\x69\x74\154\x65\x27\x2c\xa\11\11\11\x9\11\x9\x70\164\56\x61\144\x64\x69\x74\151\157\156\40\101\123\40\47\144\x65\163\x63\162\x69\x70\x74\x69\157\x6e\47\x2c\xa\11\11\x9\11\x9\11\x70\x74\x2e\x61\x64\144\151\x74\x69\157\x6e\x20\101\123\40\47\141\144\144\151\164\x69\157\x6e\47\54\xa\x9\11\11\11\x9\11\x70\164\56\x63\x6f\x6e\x74\145\156\x74\x20\x41\x53\x20\x27\x63\x6f\x6e\x74\x65\x6e\164\47\x2c\xa\x9\x9\x9\x9\11\11\x70\142\x2e\143\x61\x74\145\147\157\162\x79\137\151\x64\x20\101\123\x20\47\x63\x61\x74\145\147\x6f\162\171\137\151\x64\x27\54\xa\11\x9\11\x9\x9\x9\x6e\x75\154\x6c\x20\x41\123\x20\47\143\141\x74\145\147\x6f\162\x79\137\164\x65\170\164\47\54\xa\11\11\x9\x9\11\11\156\x75\154\x6c\40\101\x53\x20\47\143\141\x74\145\x67\x6f\x72\x69\x65\x73\x27\54\xa\11\11\x9\x9\11\11\x70\x62\56\x74\x61\x67\137\x69\144\x20\101\x53\x20\47\164\141\147\x5f\151\144\47\54\12\x9\11\11\11\11\x9\x6e\x75\x6c\154\40\101\x53\40\x27\164\141\x67\137\164\x65\170\164\47\x2c\12\11\11\11\x9\x9\x9\x6e\165\x6c\x6c\40\101\123\40\x27\164\141\147\163\47\54\xa\x9\11\11\x9\x9\11\x63\146\x70\56\x76\141\154\x75\145\40\101\x53\40\x63\x6f\155\x6d\145\156\x74\x5f\164\x79\160\145\12\11\x9\11\11\11\106\x52\117\115\40{$table_prefix}\x70\157\x73\x74\163\x5f\x62\141\x73\x65\40\x41\x53\x20\160\142\12\x9\x9\11\x9\x9\11\x4c\105\106\x54\x20\117\x55\124\105\x52\40\112\117\111\x4e\x20{$table_prefix}\165\163\145\162\x73\x20\x41\123\40\165\163\12\x9\11\11\x9\x9\11\x9\x4f\x4e\x20\x70\x62\x2e\143\162\x65\141\164\x65\x64\x5f\142\171\40\75\40\165\x73\56\151\144\12\x9\x9\11\11\11\11\114\105\106\x54\x20\117\125\124\x45\122\x20\x4a\x4f\111\116\x20\x28\x53\x45\x4c\105\103\x54\40\52\x20\106\x52\x4f\115\x20{$table_prefix}\x70\x6f\x73\164\163\x5f\x74\145\170\164\40\127\x48\x45\122\x45\40\154\141\156\147\x75\141\147\145\137\151\144\x20\75\x20\x3a\114\101\x4e\107\x55\x41\107\105\137\111\104\51\x20\x41\123\40\160\164\12\x9\11\x9\x9\x9\x9\11\x4f\116\x20\x70\142\56\x69\144\x20\75\x20\x70\x74\56\x62\x61\x73\x65\137\x69\144\x20\x41\x4e\104\40\x70\142\x2e\166\x65\162\x73\x69\x6f\156\x20\x3d\40\x70\164\x2e\142\141\x73\x65\137\x76\145\x72\x73\x69\157\x6e\xa\x9\x9\x9\11\11\11\x4c\x45\106\x54\40\x4f\x55\124\x45\122\40\112\x4f\111\116\40\50\123\105\114\105\103\x54\x20\x70\x6f\163\x74\x74\x79\160\145\137\151\144\54\40\166\x61\154\165\145\x20\106\122\x4f\x4d\40{$table_prefix}\143\157\x6e\x66\151\147\163\x5f\160\x6f\163\x74\x74\171\160\145\x20\127\x48\x45\122\105\x20\x73\151\x74\145\137\151\144\40\x3d\40\60\x20\101\x4e\x44\40\151\164\x65\x6d\x20\x3d\x20\47\x63\x6f\x6d\155\145\156\164\x5f\164\171\x70\x65\x27\x29\40\101\123\x20\x63\146\160\xa\x9\x9\11\11\x9\11\x9\117\x4e\40\160\142\56\x70\157\163\164\164\171\160\x65\x5f\151\x64\40\x3d\40\x63\x66\x70\56\160\157\163\164\x74\171\160\145\x5f\151\x64\xa\x9\11\x9\11\x9\127\110\105\122\105\12\x9\11\11\11\11\11\160\x62\56\151\144\x20\75\40\72\111\104\12\11\11\11\x9\11\11\x41\x4e\104\x20\160\142\x2e\x64\145\x6c\x65\164\x65\x5f\146\154\147\40\75\x20\x30\xa\11\11\x9\x9\11\11{$qsc_version}\12\x9\x9\11\x9\11\11{$qsc_publish_datetime}\12\x9\x9\x9\x9\11\x9{$qsc_publish_end_at}\12\11\11\x9\11\x9\x9{$qsc_status}\xa\x9\x9\x9"; $read_post_base = $pdo->prepare($sql); $read_post_base->bindValue("\x3a\x49\104", $id, PDO::PARAM_INT); $read_post_base->bindValue("\x3a\x4c\101\116\107\125\x41\107\x45\x5f\x49\x44", $language_id, PDO::PARAM_INT); $read_post_base->execute(); if ($record = $read_post_base->fetch(PDO::FETCH_ASSOC)) { $configs_posttype = array(); if ($record["\163\151\x74\145\x5f\151\x64"] && $record["\160\157\163\164\164\171\160\x65\x5f\151\144"]) { $sql = "\12\x9\11\x9\11\11\11\x53\x45\114\105\x43\x54\40\x69\164\145\x6d\54\x20\x76\x61\x6c\x75\145\x20\106\x52\117\x4d\40{$table_prefix}\143\157\156\146\151\x67\x73\x5f\x70\x6f\x73\164\x74\171\x70\145\xa\11\x9\x9\x9\x9\11\127\x48\105\122\x45\40\50\x73\x69\164\145\x5f\x69\x64\x20\75\x20\60\x20\117\x52\40\x73\151\164\x65\137\x69\144\40\75\x20{$record["\163\151\164\x65\137\x69\144"]}\x29\x20\x41\116\104\40\x70\157\x73\164\x74\171\x70\x65\137\151\144\x20\75\40{$record["\x70\x6f\163\x74\x74\171\x70\145\x5f\x69\x64"]}\12\x9\11\11\x9\11\x9\101\x4e\104\40\151\164\145\155\x20\111\116\40\50\47\x70\145\162\x6d\141\154\x69\x6e\153\137\142\x61\163\x65\x5f\x70\x72\x64\x27\54\x20\x27\145\171\145\143\141\164\143\x68\137\146\x72\x61\155\145\x27\51\12\11\11\11\x9\x9\x9"; $read_config = $pdo->prepare($sql); $read_config->execute(); while ($config = $read_config->fetch(PDO::FETCH_ASSOC)) { $configs_posttype[$config["\x69\164\x65\155"]] = $config["\x76\141\x6c\165\145"]; } unset($read_config); } $permalink_base = $configs_posttype["\160\x65\x72\155\141\x6c\151\x6e\153\137\142\141\x73\145\x5f\x70\x72\x64"]; if ($permalink_base && $record["\160\x65\x72\x6d\141\x6c\x69\156\153\137\x75\162\x69"]) { $record["\160\x65\162\x6d\x61\x6c\151\x6e\x6b"] = $permalink_base . $record["\x70\145\162\x6d\141\x6c\x69\x6e\153\x5f\x75\162\151"]; } $eyecatch_frame = !$eyecatch_frame ? $configs_posttype["\x65\171\x65\x63\x61\164\x63\150\137\x66\x72\x61\x6d\145"] : $eyecatch_frame; $record["\145\x79\x65\x63\141\x74\143\150"]["\x73\x72\143"]["\170\x31"] = $record["\x65\x79\x65\143\x61\164\143\150\137\162\x61\x77"]; $record["\145\171\x65\143\x61\x74\143\150"]["\x73\x72\143"]["\x78\x32"] = str_replace("\x2f\x31\x78\x2f", "\57\x32\x78\57", $record["\145\171\145\143\x61\x74\143\x68\137\162\x61\x77"]); $uri_arr = explode("\57", $record["\145\x79\145\143\141\164\x63\150\x5f\162\141\x77"]); $record["\x65\171\x65\143\x61\164\x63\150"]["\146\151\154\x65\137\156\141\155\145"] = preg_replace("\57\134\x3f\x76\x3d\x5c\144\x2a\x24\57", '', end($uri_arr)); if (!empty($record["\x65\171\145\x63\141\x74\x63\x68\137\x72\141\167"]) && !empty($eyecatch_frame)) { $record["\145\171\x65\x63\141\164\x63\150"]["\163\x72\143"]["\x78\x31"] = str_replace("\x2f\x66\x72\137\141\x64\x6d\151\156\x2f\145\171\x65\143\x61\x74\x63\x68\57", "\x2f" . $eyecatch_frame . "\x2f", $record["\x65\x79\145\x63\x61\164\x63\150"]["\x73\162\143"]["\170\x31"]); $record["\x65\x79\145\x63\141\x74\143\150"]["\x73\162\143"]["\170\x32"] = str_replace("\x2f\146\162\x5f\141\x64\x6d\x69\156\x2f\x65\171\145\x63\141\x74\x63\150\x2f", "\57" . $eyecatch_frame . "\57", $record["\145\x79\145\143\x61\x74\143\x68"]["\163\162\143"]["\x78\x32"]); } unset($record["\145\171\x65\143\141\x74\143\150\x5f\162\x61\x77"]); if (!empty($record["\143\157\x6e\x74\x65\156\x74"]) && !empty($content_frame)) { $record["\143\157\x6e\x74\145\156\164"] = str_replace("\x2f\x66\x72\137\155\141\x69\x6e\x2f", "\x2f" . $content_frame . "\57", $record["\143\157\156\x74\x65\x6e\164"]); } $record["\141\x63\x63\x65\160\164\x5f\x63\157\155\155\145\x6e\164"] = strpos($record["\143\157\155\155\145\x6e\x74\137\164\171\x70\145"], "\x31") !== false ? 1 : 0; $record["\x61\143\143\145\160\x74\x5f\162\145\166\x69\x65\x77"] = strpos($record["\x63\x6f\155\x6d\145\x6e\164\x5f\x74\x79\160\x65"], "\62") !== false ? 1 : 0; $post_base = $record; } unset($read_post_base); } catch (PDOException $e) { var_dump($e->getMessage()); } if (!empty($post_base)) { if (!empty($post_base["\x63\x61\x74\145\x67\x6f\162\x79\137\151\144"])) { $category_id_arr = explode("\54", $post_base["\143\x61\164\145\147\157\x72\x79\137\x69\x64"]); $post_category["\x63\141\x74\145\147\x6f\x72\x69\x65\x73"] = array(); foreach ($category_id_arr as $value) { try { $sql = "\xa\11\11\x9\11\11\11\11\11\123\x45\114\105\103\124\xa\11\11\11\11\11\11\x9\x9\11\x74\142\56\151\144\x20\x41\123\40\47\x74\x61\170\157\x6e\x6f\x6d\171\x5f\151\x64\47\x2c\12\11\11\11\11\11\x9\x9\11\x9\164\x62\x2e\x70\141\x72\145\x6e\x74\x5f\x69\144\40\101\x53\40\x27\160\x61\162\145\156\164\x5f\151\x64\x27\x2c\xa\11\11\x9\x9\11\x9\x9\x9\x9\164\142\56\x73\x6c\x75\147\40\x41\x53\40\47\x73\x6c\x75\x67\x27\x2c\12\x9\x9\x9\11\11\11\x9\x9\x9\164\x6c\56\x6c\x61\142\145\154\40\101\x53\x20\x27\154\141\x62\145\154\x27\12\11\x9\x9\x9\11\x9\11\11\x46\122\x4f\x4d\40{$table_prefix}\164\x61\x78\x6f\x6e\157\x6d\151\145\x73\137\x62\141\163\145\x20\x41\123\40\164\142\12\11\11\x9\x9\11\x9\11\11\11\x49\116\x4e\x45\122\x20\x4a\117\x49\116\40{$table_prefix}\x74\x61\170\157\x6e\157\155\x69\145\x73\137\154\141\142\x65\x6c\x20\101\123\40\164\x6c\12\11\11\11\x9\11\x9\11\x9\11\11\x4f\x4e\x20\x74\142\x2e\151\144\x20\x3d\40\x74\x6c\56\x62\141\163\x65\137\151\144\12\11\11\x9\x9\11\x9\x9\x9\x57\110\105\x52\105\xa\11\x9\11\x9\x9\11\x9\x9\x9\164\142\56\x69\144\x20\x3d\40\72\x43\x41\124\105\x47\x4f\122\131\x5f\111\x44\12\x9\11\x9\x9\x9\11\11\x9\x9\x41\x4e\x44\40\164\x6c\56\x6c\x61\156\x67\165\x61\x67\x65\x5f\x69\144\x20\x3d\40\72\114\101\116\107\x55\101\x47\x45\137\111\104\12\x9\11\11\x9\11\x9"; $read_post_category = $pdo->prepare($sql); $read_post_category->bindValue("\72\103\101\x54\105\x47\x4f\122\x59\137\x49\x44", $value, PDO::PARAM_INT); $read_post_category->bindValue("\x3a\114\101\116\107\125\x41\107\105\137\x49\x44", $language_id, PDO::PARAM_INT); $read_post_category->execute(); if ($record = $read_post_category->fetch(PDO::FETCH_ASSOC)) { $post_category["\x63\x61\164\145\x67\157\x72\151\145\163"][] = $record; $post_category["\143\141\164\x65\147\157\x72\171\x5f\164\145\x78\x74"][] = $record["\154\141\142\145\x6c"]; } unset($read_post_category); } catch (PDOException $e) { var_dump($e->getMessage()); } } } else { $post_category["\x63\x61\164\x65\x67\x6f\162\151\145\163"] = array(); } $post_category["\x63\141\x74\145\x67\157\x72\x79\x5f\164\145\x78\164"] = !empty($post_category["\143\x61\x74\145\x67\157\x72\x79\137\164\x65\170\164"]) ? implode("\54", $post_category["\x63\x61\164\145\147\157\x72\171\x5f\164\145\170\x74"]) : null; if (!empty($post_base["\164\x61\147\x5f\151\x64"])) { $tag_id_arr = explode("\54", $post_base["\164\x61\x67\x5f\151\144"]); $post_tag["\x74\141\x67\163"] = array(); foreach ($tag_id_arr as $value) { try { $sql = "\xa\x9\11\x9\11\x9\x9\x9\x9\123\x45\114\x45\103\124\xa\11\x9\x9\x9\x9\11\x9\x9\x9\164\142\56\x69\144\40\101\x53\40\47\164\141\170\x6f\x6e\x6f\x6d\171\x5f\151\x64\47\x2c\xa\x9\11\x9\x9\x9\11\x9\x9\x9\164\x62\56\x73\x6c\x75\147\40\101\x53\40\47\163\154\x75\x67\47\x2c\xa\11\x9\x9\11\11\x9\x9\11\11\164\154\x2e\154\x61\142\x65\x6c\x20\101\x53\x20\47\x6c\x61\x62\x65\154\47\xa\x9\x9\11\11\11\11\11\11\106\x52\x4f\115\40{$table_prefix}\164\x61\x78\157\x6e\157\155\x69\x65\x73\137\142\141\x73\x65\x20\x41\x53\40\164\x62\xa\x9\11\x9\11\11\x9\11\x9\x9\x49\116\x4e\105\122\x20\112\117\x49\x4e\40{$table_prefix}\x74\x61\x78\x6f\x6e\157\155\x69\x65\x73\x5f\x6c\141\142\145\154\x20\101\123\40\x74\154\12\x9\x9\x9\x9\11\11\11\x9\11\x9\117\116\40\164\142\x2e\x69\x64\x20\75\40\164\x6c\x2e\142\141\x73\145\x5f\151\x64\12\11\11\11\11\11\11\11\x9\127\110\105\122\x45\12\x9\x9\x9\x9\11\x9\11\11\11\164\x62\56\x69\144\40\x3d\40\72\124\101\x47\137\111\104\12\x9\11\x9\x9\11\x9\x9\x9\11\x41\x4e\104\40\x74\154\x2e\154\x61\156\147\165\141\x67\x65\137\151\x64\x20\x3d\x20\72\x4c\x41\116\x47\x55\x41\107\x45\137\x49\104\12\11\x9\x9\x9\11\11"; $read_post_tag = $pdo->prepare($sql); $read_post_tag->bindValue("\x3a\124\x41\x47\137\111\x44", $value, PDO::PARAM_INT); $read_post_tag->bindValue("\x3a\114\101\x4e\x47\x55\x41\x47\105\x5f\x49\104", $language_id, PDO::PARAM_INT); $read_post_tag->execute(); if ($record = $read_post_tag->fetch(PDO::FETCH_ASSOC)) { $post_tag["\164\x61\x67\x73"][] = $record; $post_tag["\164\x61\147\137\164\145\x78\x74"][] = $record["\154\141\x62\x65\154"]; } unset($read_post_tag); } catch (PDOException $e) { var_dump($e->getMessage()); } } } else { $post_tag["\164\x61\147\x73"] = array(); } $post_tag["\164\x61\x67\x5f\164\145\170\x74"] = !empty($post_tag["\164\141\x67\x5f\164\x65\170\x74"]) ? implode("\54", $post_tag["\164\141\147\x5f\164\145\170\x74"]) : null; if ($recursive) { $relation_ids = array(); $post_relations["\162\x65\154\x61\x74\x69\157\156\x73"] = array(); try { $sql = "\xa\11\11\x9\x9\11\11\x53\105\114\x45\103\x54\40\160\143\56\x62\x61\163\x65\137\x69\144\xa\11\x9\x9\x9\x9\11\106\122\117\x4d\x20{$table_prefix}\x70\157\x73\x74\x73\137\x63\165\163\x74\157\x6d\x20\101\x53\x20\160\x63\12\11\11\x9\11\x20\40\11\11\111\x4e\x4e\x45\122\x20\x4a\117\x49\116\40{$table_prefix}\x63\x75\x73\164\157\x6d\x5f\x69\x74\x65\155\163\40\x41\123\x20\x63\x69\xa\11\11\x9\11\40\x20\11\x9\11\x4f\x4e\40\x70\143\56\143\x75\x73\x74\x6f\155\137\151\x74\x65\x6d\137\151\144\x20\75\x20\143\x69\x2e\151\x64\12\x9\11\40\40\x20\x20\x20\x20\40\40\x57\x48\x45\122\105\40\160\143\56\166\x61\154\165\x65\x20\75\40\72\102\101\123\x45\x5f\111\104\40\101\116\104\x20\x63\151\56\164\171\x70\145\x20\x3d\40\x27\x72\x65\x6c\141\x74\151\x6f\x6e\x27\xa\x9\11\x9\11\40"; $read_ids = $pdo->prepare($sql); $read_ids->bindValue("\72\x42\101\123\105\137\x49\x44", (string) $id, PDO::PARAM_STR); $read_ids->execute(); while ($record = $read_ids->fetch(PDO::FETCH_ASSOC)) { $relation_ids[] = $record["\x62\141\x73\145\x5f\151\x64"]; } unset($read_ids); foreach ($relation_ids as $key => $post_key_id) { $post_relations["\x72\x65\154\x61\164\151\x6f\156\163"][$key] = get_post($post_key_id, array(), false); } } catch (PDOException $e) { var_dump($e->getMessage()); } } try { $sql = "\xa\x9\x9\11\11\x9\x9\123\x45\114\x45\x43\124\12\11\x9\11\x9\11\x9\11\160\143\x2e\x6c\141\156\147\x75\141\147\x65\x5f\x69\x64\40\x41\x53\x20\x27\x6c\x61\x6e\147\165\141\147\145\x5f\x69\x64\x27\54\xa\11\11\11\11\11\11\x9\x70\x63\56\x63\165\163\164\157\155\137\x69\x74\x65\155\137\x69\x64\40\101\x53\40\x27\x63\165\x73\x74\x6f\155\x5f\x69\x74\x65\x6d\x5f\x69\144\x27\x2c\xa\11\11\x9\x9\11\x9\x9\143\151\x2e\163\154\x75\x67\40\x41\x53\40\x27\x63\157\x6c\165\x6d\156\x27\x2c\xa\x9\11\11\x9\11\x9\x9\x63\x69\56\x74\x79\x70\145\40\x41\123\40\x27\164\171\x70\x65\x27\54\12\11\x9\11\11\x9\11\x9\x63\151\56\143\x68\x6f\x69\143\x65\x73\x20\101\x53\40\x27\143\150\x6f\151\143\x65\x73\x27\54\12\x9\x9\11\x9\11\x9\11\160\143\56\x76\x61\154\x75\145\x20\101\x53\40\47\166\x61\x6c\165\145\x27\xa\11\11\x9\x9\x9\11\106\x52\117\x4d\x20{$table_prefix}\143\165\x73\164\x6f\155\137\x69\x74\145\x6d\x73\40\101\123\40\x63\151\12\11\11\11\x9\x9\11\11\x4c\x45\x46\x54\40\x4f\125\x54\105\122\40\112\x4f\111\x4e\40{$table_prefix}\160\x6f\163\164\x73\137\143\165\163\x74\x6f\155\x20\101\123\x20\x70\143\12\x9\11\x9\x9\x9\11\x9\x9\117\x4e\40\x20\x63\x69\x2e\x69\x64\x20\75\x20\160\143\56\x63\x75\163\x74\157\x6d\x5f\151\164\x65\155\137\151\x64\xa\x9\x9\11\11\x9\11\x57\x48\x45\x52\x45\12\11\x9\11\x9\x9\x9\x9\x63\151\56\163\164\x61\164\x75\x73\x20\75\40\x31\xa\11\11\11\11\11\11\11\101\116\104\x20\x63\x69\x2e\x64\145\x6c\x65\x74\145\x5f\x66\154\147\x20\x20\40\x3d\40\x30\xa\x9\x9\11\11\x9\11\11\x41\x4e\104\40\x70\143\56\x62\141\x73\145\x5f\151\144\x20\x20\x20\40\x20\x20\x3d\40\72\102\101\x53\x45\x5f\111\x44\12\11\x9\x9\x9\11\x9\11\101\x4e\x44\x20\160\143\56\x62\141\x73\145\137\166\x65\x72\x73\151\157\x6e\x20\75\40\72\x42\x41\123\105\x5f\x56\105\x52\123\x49\x4f\116\xa\x9\11\11\x9\11\11\11\101\116\x44\40\x70\143\56\x6c\x61\156\147\x75\x61\147\145\x5f\151\144\40\x20\75\x20\72\x4c\x41\116\107\125\101\x47\x45\x5f\x49\x44\xa\x9\x9\11\x9"; $read_post_custom = $pdo->prepare($sql); $read_post_custom->bindValue("\x3a\x42\101\123\105\137\x49\x44", $id, PDO::PARAM_INT); $read_post_custom->bindValue("\x3a\x42\101\123\x45\x5f\126\x45\x52\123\x49\117\x4e", $post_base["\x76\145\162\x73\x69\x6f\x6e"], PDO::PARAM_INT); $read_post_custom->bindValue("\72\114\101\x4e\107\x55\x41\107\x45\137\x49\x44", $language_id, PDO::PARAM_INT); $read_post_custom->execute(); while ($record = $read_post_custom->fetch(PDO::FETCH_ASSOC)) { if ($record["\x74\x79\160\x65"] == "\151\155\x61\147\x65") { if (isset($custom_frame[$record["\x63\x6f\154\165\155\156"]])) { $record["\166\x61\154\x75\x65"] = preg_replace("\x2f\134\57\x66\162\137\x28\141\x75\x74\157\174\143\x72\157\x70\x29\134\57\x5b\x30\55\x39\135\x7b\62\54\x33\175\134\x2f\x2f", "\57" . $custom_frame[$record["\x63\157\x6c\165\x6d\156"]] . "\x2f", $record["\x76\141\154\165\x65"]); } $x1 = $record["\166\x61\154\x75\145"]; $x2 = preg_replace("\57\x5c\x2f\x31\170\x5c\x2f\57", "\x2f\x32\x78\57", $x1); $key = "\x63\165\x73\164\x6f\x6d\x5f" . $record["\x63\x6f\x6c\165\x6d\156"]; $post_custom[$key]["\x73\x72\143"]["\170\61"] = $x1; $post_custom[$key]["\163\162\143"]["\170\x32"] = $x2; $uri_arr = explode("\x2f", $record["\166\141\154\165\x65"]); $post_custom[$key]["\146\x69\x6c\145\x5f\x6e\141\155\145"] = preg_replace("\x2f\134\77\166\x3d\x5c\144\52\x24\57", '', end($uri_arr)); } elseif ($record["\x74\x79\x70\x65"] == "\147\141\x6c\154\145\x72\171") { $urls = array(); $captions = array(); if (preg_match("\x2f\x5c\x6e\x2f", $record["\x76\141\x6c\165\145"])) { $record_arr = explode("\12", $record["\x76\141\x6c\x75\145"]); $urls = $record_arr[0]; $captions = $record_arr[1]; } else { $urls = $record["\166\141\154\165\145"]; } $urls = make_list_data($urls, "\54", false); $captions = make_list_data($captions, "\x2c", false); $x_arr = array(); foreach ($urls as $key => $value) { $x1 = $value; $x2 = preg_replace("\x2f\134\x2f\61\170\x5c\57\x2f", "\57\x32\170\x2f", $x1); $x2_arr[$key] = $x2; $x_arr[$key]["\x73\x72\x63"]["\170\x31"] = $x1; $x_arr[$key]["\x73\x72\x63"]["\170\62"] = $x2; $uri_arr = explode("\57", $value); $x_arr[$key]["\x66\x69\154\x65\x5f\156\141\x6d\145"] = preg_replace("\57\x5c\77\166\x3d\134\x64\x2a\44\x2f", '', end($uri_arr)); $x_arr[$key]["\x63\141\160\x74\x69\x6f\156"] = $captions[$key]; } $key = "\x63\x75\x73\164\x6f\155\137" . $record["\x63\157\154\x75\155\x6e"]; $post_custom[$key] = $x_arr; } else { if ($recursive) { if ($record["\x74\171\x70\x65"] == "\162\145\x6c\141\x74\x69\157\x6e" && !empty($record["\166\141\x6c\x75\x65"])) { $record["\x76\141\154\165\145"] = get_post($record["\x76\x61\154\x75\145"], array(), false); unset($record["\x76\x61\154\x75\145"]["\160\x6f\163\x74\137\142\x6f\x64\x79"]["\160\x61\147\145\x5f\156\141\x76\151"]); unset($record["\x76\x61\154\x75\x65"]["\160\x6f\x73\x74\137\x62\157\x64\171"]["\146\141\x6d\x69\x6c\x79"]); } } if ($record["\x74\x79\x70\145"] == "\163\171\156\164\x61\170") { $record["\166\x61\x6c\165\145"] = htmlspecialchars($record["\166\x61\x6c\165\145"], ENT_QUOTES); } if ($record["\x74\171\x70\145"] == "\154\151\x73\164") { $record["\166\141\154\x75\x65"] = make_list_data($record["\x76\x61\x6c\x75\145"]); } if ($record["\164\x79\x70\x65"] == "\x74\141\142\154\145") { $delimiter = ''; switch ($record["\x63\150\157\151\143\145\x73"]) { case "\x63\x6f\x6d\x6d\141": $delimiter = "\54"; break; case "\x73\x65\x6d\151\143\157\154\157\x6e": $delimiter = "\73"; break; case "\x63\157\154\x6f\156": $delimiter = "\x3a"; break; case "\x73\x6c\x61\163\150": $delimiter = "\57"; break; case "\144\x6f\x74": $delimiter = "\56"; break; } $record["\166\x61\x6c\x75\x65"] = make_table_data($record["\x76\x61\x6c\165\x65"], $delimiter); } $key = "\x63\165\x73\x74\157\x6d\x5f" . $record["\143\x6f\x6c\x75\x6d\x6e"]; $post_custom[$key] = $record["\x76\x61\154\165\145"]; } } unset($read_post_custom); } catch (PDOException $e) { var_dump($e->getMessage()); } $qsc_id = !empty($post_base["\x70\x61\162\x65\156\x74\137\x69\144"]) ? "\101\116\104\40\x28\160\142\56\x69\x64\40\75\x20{$post_base["\160\141\x72\145\x6e\164\137\151\x64"]}\40\117\122\x20\x70\x62\x2e\x70\x61\x72\145\156\164\137\151\x64\40\x3d\x20{$post_base["\x70\x61\162\145\x6e\x74\x5f\151\x64"]}\51" : "\101\116\x44\x20\50\x69\x64\40\75\40{$id}\x20\x4f\122\40\160\141\x72\145\x6e\x74\x5f\x69\144\x20\75\x20{$id}\51"; try { $sql = "\xa\x9\x9\11\x9\11\x9\123\x45\114\x45\x43\124\12\x9\x9\11\11\x9\x9\x9\160\142\56\151\x64\40\101\123\x20\x27\151\144\x27\x2c\xa\x9\11\x9\11\11\11\x9\160\x62\x2e\x68\141\x73\150\137\x69\x64\40\101\x53\x20\47\x68\x61\x73\x68\137\151\x64\x27\x2c\12\x9\11\11\x9\x9\11\x9\160\142\x2e\160\145\162\155\141\x6c\x69\x6e\x6b\x5f\153\145\171\x20\x41\x53\x20\x27\160\157\163\x74\x5f\153\x65\171\47\54\xa\x9\x9\11\x9\x9\11\11\x6e\x75\154\154\40\x41\x53\x20\47\160\x65\x72\x6d\x61\x6c\x69\x6e\x6b\47\x2c\xa\11\x9\11\11\x9\11\x9\x70\x62\56\x70\145\162\x6d\141\x6c\151\156\153\x5f\165\x72\x69\40\101\x53\x20\47\160\145\x72\x6d\x61\154\x69\156\153\137\x75\x72\151\x27\54\xa\x9\x9\11\11\11\11\11\x70\142\56\x70\x61\162\x65\156\x74\137\151\x64\x20\101\123\x20\x27\x70\141\162\145\156\164\x5f\x69\144\x27\x2c\xa\x9\11\x9\11\x9\x9\11\160\x62\56\166\145\162\x73\151\157\156\40\x41\123\x20\47\x76\145\162\x73\x69\x6f\156\x27\x2c\12\x9\x9\x9\11\x9\11\x9{$qsi_publish_datetime}\40\x41\x53\x20\47\x70\165\142\x6c\151\x73\150\137\x64\141\164\x65\x74\151\x6d\145\x27\x2c\12\x9\x9\11\x9\11\11\x9\160\142\56\x63\x72\x65\x61\x74\x65\x64\x5f\141\x74\x20\101\x53\x20\47\x63\162\x65\x61\x74\145\144\137\141\x74\47\54\12\11\11\x9\11\x9\11\x9\x70\x62\x2e\x63\162\145\x61\164\x65\x64\x5f\x62\x79\x20\101\x53\x20\x27\x63\x72\145\x61\x74\x65\x64\x5f\142\x79\x27\x2c\12\11\11\11\x9\11\11\11\x70\x62\x2e\163\164\141\x74\165\163\x20\101\123\x20\47\x73\164\x61\x74\165\163\x27\x2c\12\11\x9\11\x9\11\x9\11\160\x62\56\144\x65\154\145\164\145\137\146\x6c\147\40\x41\x53\40\x27\144\x65\154\x65\x74\145\137\146\154\x67\47\54\12\x9\11\11\11\11\11\x9\160\x62\x2e\x73\154\165\x67\x20\x41\123\x20\x27\163\154\x75\x67\x27\x2c\xa\11\x9\11\11\x9\11\x9\x70\142\x2e\145\x79\145\x63\x61\x74\143\150\x20\101\x53\x20\47\x65\171\x65\x63\x61\164\x63\150\x5f\162\141\x77\x27\x2c\xa\x9\11\x9\x9\x9\11\x9\156\x75\x6c\x6c\x20\101\x53\40\47\145\171\145\x63\141\x74\143\x68\47\54\12\x9\11\11\x9\11\11\x9\x70\164\x2e\x74\151\164\154\145\x20\101\x53\40\47\x74\151\x74\x6c\145\x27\x2c\xa\x9\x9\11\x9\x9\x9\11\160\x74\x2e\x61\x64\x64\x69\164\x69\157\x6e\x20\101\123\40\47\x64\145\x73\143\162\x69\160\x74\151\x6f\156\x27\54\12\11\x9\11\x9\11\x9\11\160\x74\x2e\141\x64\x64\151\x74\151\157\x6e\40\101\123\40\47\141\x64\x64\x69\x74\x69\x6f\156\47\54\12\x9\x9\x9\11\x9\11\x9\x70\164\56\143\x6f\156\164\145\156\x74\40\x41\123\40\x27\x63\x6f\156\164\x65\156\x74\47\12\11\11\x9\11\11\11\106\x52\117\115\40{$table_prefix}\x70\x6f\163\164\x73\137\142\x61\x73\145\x20\101\x53\x20\x70\x62\12\11\11\x9\x9\11\x9\11\x4c\x45\x46\x54\40\117\125\x54\105\x52\40\112\x4f\x49\x4e\x20\50\x53\105\114\x45\x43\124\40\x2a\x20\106\x52\x4f\115\x20{$table_prefix}\x70\x6f\163\164\x73\x5f\x74\x65\x78\164\x20\x57\110\x45\x52\105\40\x6c\141\x6e\147\x75\x61\x67\x65\137\x69\x64\40\x3d\x20\72\114\x41\x4e\107\x55\101\107\105\137\x49\104\51\x20\101\123\x20\160\164\12\11\x9\x9\x9\11\x9\x9\11\x4f\116\x20\160\x62\x2e\151\x64\x20\x3d\40\x70\x74\x2e\x62\x61\x73\x65\137\151\144\40\x41\116\104\x20\x70\142\56\x76\145\162\x73\x69\x6f\156\x20\75\x20\160\x74\56\x62\141\163\145\x5f\166\145\x72\163\151\157\156\xa\11\11\x9\x9\11\x9\127\x48\x45\x52\x45\12\11\x9\x9\11\x9\11\x9\x70\142\x2e\x64\145\154\x65\x74\x65\x5f\146\x6c\x67\x20\75\x20\x30\12\11\11\x9\x9\x9\11\11\101\x4e\x44\x20\x70\142\56\163\164\x61\164\165\x73\40\75\x20\x31\xa\11\x9\11\x9\x9\x9\11\101\116\x44\x20\x70\x74\56\142\x61\x73\145\137\x76\145\162\163\x69\x6f\x6e\40\x3d\40\72\x42\x41\123\x45\137\126\105\x52\x53\111\x4f\116\12\x9\11\x9\x9\11\11\x9{$qsc_id}\12\11\11\x9\x9\x9\11\x4f\x52\104\105\122\40\102\x59\x20\x70\x62\x2e\x69\x64\x20\x41\123\x43\xa\11\11\x9\11"; $read_post_children = $pdo->prepare($sql); $read_post_children->bindValue("\72\114\101\x4e\107\125\101\107\105\x5f\x49\x44", $language_id, PDO::PARAM_INT); $read_post_children->bindValue("\72\102\x41\123\x45\x5f\126\x45\122\123\111\x4f\x4e", $post_base["\x76\x65\x72\x73\x69\157\x6e"], PDO::PARAM_INT); $read_post_children->execute(); while ($record = $read_post_children->fetch(PDO::FETCH_ASSOC)) { $record["\x65\171\145\143\141\x74\x63\x68"]["\x73\x72\143"]["\170\61"] = $record["\145\x79\145\x63\x61\164\x63\x68\137\x72\141\x77"]; $record["\145\171\145\x63\x61\164\x63\x68"]["\163\162\x63"]["\170\62"] = str_replace("\x2f\61\x78\57", "\x2f\62\x78\x2f", $record["\x65\x79\x65\143\x61\x74\143\150\x5f\162\141\167"]); $uri_arr = explode("\57", $record["\x65\x79\x65\143\141\164\143\x68\x5f\x72\141\167"]); $record["\x65\x79\145\143\141\164\x63\150"]["\146\151\x6c\x65\x5f\x6e\141\155\x65"] = preg_replace("\x2f\x5c\77\x76\x3d\x5c\144\x2a\44\57", '', end($uri_arr)); if (!empty($record["\145\171\x65\x63\141\x74\143\x68\137\162\141\x77"]) && !empty($eyecatch_frame)) { $record["\145\171\x65\x63\141\164\x63\150"]["\163\x72\143"]["\170\x31"] = str_replace("\57\x66\162\x5f\141\144\x6d\151\x6e\57\x65\171\x65\x63\141\164\x63\x68\x2f", "\57" . $eyecatch_frame . "\x2f", $record["\x65\171\x65\143\x61\164\143\x68"]["\x73\x72\143"]["\170\x31"]); $record["\145\171\x65\x63\x61\x74\143\150"]["\x73\162\143"]["\x78\x32"] = str_replace("\57\146\x72\137\141\x64\x6d\x69\156\x2f\x65\171\145\143\x61\164\x63\x68\57", "\x2f" . $eyecatch_frame . "\57", $record["\145\171\145\143\141\164\143\x68"]["\x73\x72\143"]["\170\x32"]); } unset($record["\x65\171\145\x63\141\164\143\150\137\x72\141\167"]); if ($permalink_base && $record["\160\145\162\155\141\154\x69\x6e\153\x5f\165\162\x69"]) { $record["\x70\145\162\x6d\x61\154\151\156\x6b"] = $permalink_base . $record["\x70\145\162\x6d\141\x6c\x69\156\153\x5f\x75\162\x69"]; } if ($record["\160\141\x72\145\156\x74\137\151\x64"] == 0) { $post_family["\x66\x61\x6d\151\154\x79"]["\157\165\x74\154\x69\x6e\x65"] = array("\x70\x61\x72\145\156\164\137\151\144" => $record["\151\144"], "\x70\141\x72\145\156\164\137\x68\141\x73\x68\137\151\x64" => $record["\x68\x61\x73\x68\x5f\151\144"], "\x70\141\162\x65\x6e\x74\x5f\160\157\163\x74\137\153\x65\171" => $record["\160\x6f\163\x74\137\x6b\145\171"], "\x70\141\x72\x65\156\x74\x5f\x70\x65\162\x6d\x61\154\151\156\x6b" => $record["\x70\145\162\155\141\x6c\151\x6e\x6b"], "\160\x61\x72\145\156\x74\137\x70\145\162\x6d\141\x6c\x69\x6e\153\137\x75\x72\153" => $record["\x70\145\x72\x6d\x61\x6c\x69\156\153\x5f\x75\162\x69"], "\160\x61\162\x65\156\164\137\x73\x6c\x75\x67" => $record["\163\x6c\165\x67"], "\x70\141\162\145\x6e\164\137\x65\171\x65\143\141\x74\143\150" => $record["\x65\171\145\143\x61\164\143\150"], "\160\x75\142\x6c\x69\163\x68\x5f\144\x61\x74\145\x74\x69\155\145" => $record["\160\165\x62\154\151\x73\x68\137\x64\x61\164\x65\164\x69\x6d\145"], "\x70\165\x62\x6c\x69\163\x68\137\145\156\144\x5f\141\x74" => $record["\x70\x75\142\154\151\163\x68\x5f\145\156\x64\x5f\141\164"], "\164\151\164\154\145" => $record["\164\x69\164\154\145"]); } $post_family["\x66\141\x6d\x69\x6c\171"]["\160\x61\147\x65\x5f\151\156\x64\145\x78"][$i_page] = array("\151\144" => $record["\151\144"], "\x68\x61\x73\x68\137\151\x64" => $record["\150\x61\x73\150\x5f\151\144"], "\x70\157\163\x74\x5f\x6b\145\171" => $record["\x70\157\163\x74\137\x6b\x65\171"], "\160\x65\x72\x6d\141\x6c\x69\x6e\153" => $record["\160\145\162\155\x61\x6c\x69\156\x6b"], "\x70\145\x72\x6d\x61\154\151\x6e\x6b\137\165\x72\151" => $record["\x70\x65\x72\155\x61\x6c\151\156\153\x5f\165\x72\x69"], "\163\154\165\147" => $record["\163\154\x75\x67"], "\144\145\x73\143\x72\x69\160\164\x69\157\156" => $record["\144\x65\x73\x63\x72\x69\x70\164\151\x6f\156"], "\141\x64\x64\x69\x74\x69\157\x6e" => $record["\141\144\144\x69\164\x69\x6f\x6e"], "\145\x79\145\x63\141\x74\143\x68" => $record["\x65\171\x65\143\x61\x74\143\x68"], "\x63\x6f\156\x74\x65\x6e\x74\x5f\150\145\141\144" => substructString($record["\x63\x6f\x6e\x74\145\x6e\x74"], $content_head_length)); $record["\143\x6f\x6e\164\x65\156\164"] = substructString($record["\x63\157\x6e\x74\145\156\164"], $content_head_length); $post_family["\x66\141\x6d\151\x6c\x79"]["\154\151\x73\x74"][$record["\151\144"]] = $record; $i_page++; } unset($read_post_children); $post_family["\146\x61\155\x69\154\x79"]["\x6f\x75\164\x6c\x69\x6e\x65"]["\160\x61\147\145\x73"] = $i_page; } catch (PDOException $e) { var_dump($e->getMessage()); } if ($with_child_custom && count($post_family["\146\x61\155\151\154\171"]["\154\x69\163\164"]) > 1) { foreach ($post_family["\146\x61\155\151\x6c\x79"]["\154\x69\x73\164"] as $family_id => $row) { $post_child_custom = array(); try { $sql = "\12\x9\x9\x9\x9\x9\11\11\11\x53\105\x4c\x45\x43\124\12\11\x9\x9\11\11\x9\x9\11\11\x70\143\56\154\141\x6e\147\165\141\x67\x65\x5f\x69\x64\40\101\123\x20\47\154\x61\156\147\x75\x61\x67\x65\137\151\144\x27\54\xa\x9\11\x9\x9\11\x9\11\x9\x9\160\x63\56\x63\165\163\x74\157\155\x5f\x69\164\145\155\137\151\x64\40\x41\123\x20\47\x63\165\x73\164\x6f\155\137\151\164\x65\x6d\x5f\x69\144\x27\x2c\xa\11\x9\11\x9\11\11\x9\x9\11\143\151\x2e\x74\171\x70\x65\x20\101\x53\40\47\164\171\x70\x65\x27\54\xa\11\x9\x9\x9\11\x9\11\x9\x9\x63\151\56\163\x6c\165\x67\40\x41\123\40\x27\x63\x6f\154\165\x6d\x6e\47\54\xa\x9\11\11\11\11\x9\11\x9\11\x70\x63\x2e\166\141\x6c\x75\145\40\x41\x53\x20\47\166\141\154\165\x65\47\xa\11\x9\11\x9\11\x9\11\11\106\122\x4f\115\x20{$table_prefix}\x70\157\163\164\163\137\x63\x75\163\164\x6f\x6d\x20\101\123\40\160\x63\xa\11\x9\x9\11\11\11\x9\11\x9\122\111\x47\x48\x54\40\117\125\x54\105\122\x20\x4a\117\111\x4e\x20{$table_prefix}\x63\x75\x73\164\157\155\x5f\x69\164\145\155\163\40\x41\x53\40\143\151\12\11\11\x9\11\11\x9\11\x9\x9\11\x4f\116\x20\40\160\x63\x2e\143\165\x73\x74\x6f\x6d\137\151\x74\x65\155\x5f\x69\x64\x20\75\x20\143\x69\56\x69\144\xa\11\x9\x9\11\11\x9\x9\x9\x57\x48\x45\x52\105\xa\x9\x9\11\11\x9\x9\x9\11\11\x63\151\56\163\x74\141\164\x75\163\x20\75\40\61\xa\x9\11\x9\x9\x9\x9\x9\11\11\101\116\x44\40\x63\x69\56\x64\145\x6c\145\164\x65\137\146\x6c\x67\40\x3d\40\x30\12\11\x9\x9\x9\11\x9\11\x9\11\101\x4e\104\x20\160\143\56\x62\x61\x73\145\x5f\151\x64\40\x20\x20\x20\40\40\x3d\x20\72\102\x41\x53\105\x5f\x49\104\xa\11\x9\11\x9\x9\x9\11\x9\11\101\x4e\104\x20\160\x63\56\142\x61\163\145\137\166\145\x72\163\151\157\156\40\75\40\72\102\x41\123\105\x5f\126\105\x52\x53\x49\117\x4e\12\11\x9\x9\11\x9\x9\x9\x9\x9\101\x4e\104\x20\160\143\56\154\x61\x6e\x67\x75\141\147\x65\137\x69\144\40\40\x3d\x20\x3a\114\x41\x4e\x47\125\x41\107\x45\x5f\111\104\xa\x9\x9\x9\x9\11\x9"; $read_post_child_custom = $pdo->prepare($sql); $read_post_child_custom->bindValue("\x3a\102\x41\123\105\x5f\111\x44", $family_id, PDO::PARAM_INT); $read_post_child_custom->bindValue("\72\102\x41\123\105\x5f\x56\x45\x52\x53\x49\x4f\116", $row["\x76\x65\162\163\151\x6f\156"], PDO::PARAM_INT); $read_post_child_custom->bindValue("\x3a\114\101\x4e\107\x55\x41\107\105\137\111\x44", $language_id, PDO::PARAM_INT); $read_post_child_custom->execute(); while ($record = $read_post_child_custom->fetch(PDO::FETCH_ASSOC)) { $key = "\143\x75\x73\x74\157\155\x5f" . $record["\143\157\x6c\x75\x6d\156"]; $post_family["\x66\x61\x6d\151\x6c\x79"]["\154\x69\163\164"][$family_id][$key] = $record["\x76\141\x6c\x75\x65"]; } unset($read_post_child_custom); } catch (PDOException $e) { var_dump($e->getMessage()); } } } $post_count_comments = array(); if (!empty($post_base)) { $sql = "\xa\11\x9\x9\x9\x9\x9\123\x45\x4c\x45\103\124\40\x44\x49\123\124\111\116\x43\124\x28\x74\171\160\x65\51\x20\x41\x53\x20\164\x79\160\145\x2c\40\x43\117\x55\x4e\124\x28\x2a\51\x20\x41\123\40\x63\x6f\165\156\164\12\11\11\x9\11\11\x9\x46\122\117\x4d\x20{$table_prefix}\143\x6f\x6d\155\145\156\164\163\12\x9\x9\x9\11\x9\11\127\110\105\x52\x45\xa\x9\11\x9\x9\x9\11\x9\x64\145\x6c\x65\x74\145\137\146\154\147\40\x3d\40\x30\xa\x9\11\x9\11\11\11\x9\x41\x4e\104\x20\x73\164\x61\x74\165\x73\40\x3d\x20\61\12\11\x9\11\11\x9\11\x9\x41\116\x44\40\160\x6f\163\164\x5f\x69\x64\x20\75\40\72\x49\104\xa\x9\x9\x9\x9\x9\x9\x9\101\116\x44\40\x63\157\155\x6d\x65\156\164\x5f\x69\144\x20\75\40\60\12\x9\x9\11\x9\x9\x9\x47\122\117\125\120\x20\x42\x59\40\x74\x79\x70\145\xa\x9\11\11\11"; $read_count_comment = $pdo->prepare($sql); $read_count_comment->bindValue("\72\x49\x44", $id, PDO::PARAM_INT); $read_count_comment->execute(); while ($record = $read_count_comment->fetch(PDO::FETCH_ASSOC)) { $post_count_comments["\x63\x6f\165\156\164\x5f\143\157\x6d\x6d\x65\x6e\164\x73"][$record["\x74\171\160\145"]] = $record["\143\x6f\165\x6e\164"]; } unset($read_count_comment); } $post_family["\x66\141\155\x69\154\x79"]["\x6c\x69\x73\x74"] = index_fromone($post_family["\x66\141\x6d\x69\154\x79"]["\154\151\x73\x74"]); $post_page_navi["\x70\x61\147\x65\x5f\156\141\166\x69"] = array("\x70\162\145\x76\137\x70\141\147\x65" => array(), "\x74\x68\151\x73\x5f\x70\141\147\x65" => array(), "\x6e\145\x78\164\x5f\x70\x61\147\145" => array()); if (count($post_family["\x66\141\x6d\x69\x6c\x79"]["\x6c\151\x73\164"]) > 1) { foreach ($post_family["\146\x61\x6d\x69\x6c\x79"]["\x6c\x69\x73\164"] as $key => $row_family) { if ($row_family["\x69\144"] == $id) { if ($key > 1) { $post_page_navi["\x70\x61\147\x65\x5f\x6e\141\166\x69"]["\x70\162\x65\x76\137\160\141\x67\145"]["\160\x61\x67\145"] = $key - 1; $post_page_navi["\160\x61\x67\145\137\156\x61\x76\151"]["\x70\162\x65\166\x5f\160\141\147\x65"]["\x69\144"] = $post_family["\146\x61\155\151\154\171"]["\x6c\151\163\x74"][$key - 1]["\151\144"]; $post_page_navi["\160\141\x67\x65\x5f\x6e\141\x76\151"]["\160\x72\x65\166\137\x70\x61\x67\x65"]["\144\x65\x73\143\162\x69\x70\x74\151\157\x6e"] = $post_family["\146\x61\x6d\151\154\x79"]["\154\151\x73\164"][$key - 1]["\x64\x65\x73\x63\162\x69\x70\x74\x69\x6f\x6e"]; $post_page_navi["\x70\141\147\145\x5f\x6e\141\166\151"]["\160\x72\x65\166\137\160\x61\147\145"]["\x61\x64\144\151\164\151\x6f\x6e"] = $post_family["\146\x61\x6d\x69\154\171"]["\154\151\163\164"][$key - 1]["\141\144\x64\151\x74\151\x6f\156"]; $post_page_navi["\x70\x61\147\x65\x5f\156\x61\x76\x69"]["\x70\162\x65\x76\137\160\x61\147\145"]["\x63\x6f\x6e\164\145\x6e\x74\x5f\150\x65\141\144"] = $post_family["\x66\x61\155\x69\x6c\x79"]["\154\151\x73\164"][$key - 1]["\x63\x6f\x6e\x74\x65\156\164"]; } $post_page_navi["\160\x61\147\x65\137\x6e\x61\x76\151"]["\164\x68\151\163\137\x70\141\x67\x65"]["\x70\141\147\145"] = $key; $post_page_navi["\160\141\x67\145\x5f\x6e\x61\166\151"]["\164\x68\x69\163\x5f\x70\x61\147\x65"]["\x69\x64"] = $row_family["\151\144"]; $post_page_navi["\160\141\147\x65\137\156\x61\x76\151"]["\x74\x68\151\x73\x5f\x70\x61\x67\x65"]["\144\145\163\143\162\151\x70\164\x69\157\156"] = $row_family["\x64\145\x73\x63\x72\x69\x70\x74\151\157\156"]; $post_page_navi["\160\x61\147\x65\x5f\156\141\166\x69"]["\164\x68\151\163\137\x70\141\x67\145"]["\141\x64\x64\x69\164\151\157\156"] = $row_family["\141\x64\144\151\x74\x69\157\x6e"]; $post_page_navi["\x70\x61\x67\145\x5f\x6e\141\x76\x69"]["\x74\x68\151\163\137\160\x61\147\x65"]["\143\x6f\x6e\x74\x65\x6e\x74\x5f\150\145\x61\x64"] = $row_family["\143\157\x6e\164\x65\x6e\x74"]; if ($key < count($post_family["\x66\x61\x6d\x69\154\x79"]["\x6c\x69\163\164"])) { $post_page_navi["\160\x61\x67\145\137\156\141\x76\x69"]["\x6e\145\x78\x74\x5f\x70\x61\147\145"]["\160\141\147\x65"] = $key + 1; $post_page_navi["\160\x61\147\145\x5f\156\x61\x76\151"]["\156\145\x78\x74\137\160\141\147\x65"]["\151\144"] = $post_family["\146\141\155\151\154\x79"]["\x6c\x69\x73\164"][$key + 1]["\151\x64"]; $post_page_navi["\x70\x61\x67\145\x5f\156\x61\x76\151"]["\x6e\145\170\164\137\x70\141\147\x65"]["\x64\145\163\143\x72\151\160\164\151\157\x6e"] = $post_family["\146\141\155\x69\x6c\x79"]["\154\151\163\x74"][$key + 1]["\144\x65\x73\143\162\x69\x70\164\151\157\156"]; $post_page_navi["\x70\141\147\145\137\156\141\x76\151"]["\156\145\170\x74\137\x70\x61\147\x65"]["\x61\144\x64\x69\164\x69\x6f\x6e"] = $post_family["\146\x61\155\x69\x6c\171"]["\154\x69\163\164"][$key + 1]["\x61\144\x64\x69\164\151\157\x6e"]; $post_page_navi["\160\x61\147\145\137\156\x61\x76\151"]["\x6e\145\x78\x74\x5f\x70\x61\147\x65"]["\x63\157\156\x74\145\156\164\x5f\x68\x65\141\144"] = $post_family["\x66\141\155\151\154\171"]["\x6c\151\x73\164"][$key + 1]["\x63\157\156\164\x65\156\164"]; } } } } $post_counter = array(); if ($with_counter) { try { $sql = "\123\x45\114\105\103\x54\40\x2a\40\106\122\x4f\115\x20{$table_prefix}\143\x6f\165\156\x74\x65\x72\x73\x20\x57\x48\x45\122\105\x20\x70\157\x73\164\x5f\151\144\40\x3d\40{$id}\x20\117\122\104\x45\x52\40\102\x59\40\x74\171\x70\145\x20\x41\x53\x43"; $read_records = $pdo->prepare($sql); $read_records->execute(); while ($record = $read_records->fetch(PDO::FETCH_ASSOC)) { $post_counter["\143\x6f\x75\156\x74\145\x72"][$record["\164\171\x70\x65"]]["\143\x6f\165\156\x74"] = $record["\x63\157\x75\x6e\x74"]; $post_counter["\x63\157\x75\156\164\x65\162"][$record["\164\171\x70\145"]]["\x75\x70\x64\x61\x74\x65\x64\137\141\164"] = $record["\165\160\144\141\x74\x65\x64\x5f\141\x74"]; } unset($read_records); } catch (PDOException $e) { var_dump($e->getMessage()); } } if ($recursive) { $post = array_merge($post_base, $post_category, $post_tag, $post_custom, $post_count_comments, $post_relations, $post_pages, $post_page_navi, $post_family, $post_counter); } else { $post = array_merge($post_base, $post_category, $post_tag, $post_custom, $post_count_comments); } $post["\143\141\x74\145\x67\x6f\162\x69\145\163"] = index_fromone($post["\143\x61\164\145\x67\157\x72\x69\145\163"]); $post["\x74\141\147\163"] = index_fromone($post["\x74\141\x67\x73"]); if (isset($post["\162\145\154\141\164\151\x6f\x6e\x73"])) { $post["\x72\x65\x6c\x61\x74\151\x6f\x6e\163"] = index_fromone($post["\162\x65\x6c\141\164\x69\x6f\x6e\163"]); } } return $post; } else { return false; } } goto QxZf7; iU39A: function set_counter($post_id, $type) { global $pdo; global $table_prefix; $count = 0; $next_count = 0; if (!empty($post_id) && !empty($type)) { $sql = "\123\x45\x4c\x45\x43\x54\40\x63\157\165\156\x74\x20\106\122\x4f\115\x20{$table_prefix}\x63\x6f\165\156\x74\x65\162\x73\x20\x57\110\x45\122\x45\x20\160\157\163\x74\x5f\x69\144\x20\75\x20\x3a\x50\x4f\x53\x54\x5f\x49\x44\x20\x41\116\104\x20\x74\x79\160\145\x20\x3d\x20\x3a\x54\131\x50\105"; $read_item = $pdo->prepare($sql); $read_item->bindValue("\x3a\120\x4f\123\124\137\x49\x44", $post_id, PDO::PARAM_INT); $read_item->bindValue("\x3a\x54\x59\120\x45", $type, PDO::PARAM_INT); $read_item->execute(); if ($item = $read_item->fetch(PDO::FETCH_ASSOC)) { $count = $item["\143\157\165\x6e\164"]; } unset($read_item); $next_count = $count + 1; if ($next_count == 1) { $sql = "\xa\x9\x9\x9\x9\x9\111\116\123\x45\122\124\x20\111\x4e\x54\x4f\40{$table_prefix}\x63\x6f\165\x6e\164\x65\x72\x73\12\11\11\11\11\11\x9\50\x20\x70\157\x73\164\137\x69\144\54\40\40\164\171\160\x65\54\x20\x20\x63\x6f\165\x6e\x74\54\40\x20\165\160\x64\141\164\145\x64\137\141\x74\x29\12\11\x9\11\11\x9\x56\x41\x4c\125\x45\x53\xa\x9\x9\x9\x9\x9\11\x28\x3a\x50\117\x53\124\x5f\111\104\54\x20\72\x54\x59\x50\x45\54\x20\x3a\103\117\x55\116\x54\x2c\x20\x3a\x55\120\104\x41\x54\x45\x44\x5f\101\124\x29\12\x9\x9\x9"; } elseif ($next_count > 1) { $sql = "\12\11\x9\x9\x9\11\125\120\104\x41\x54\x45\x20{$table_prefix}\x63\157\165\156\x74\x65\162\163\x20\123\105\124\12\x9\11\11\11\11\11\x63\157\165\156\x74\x20\x20\x20\40\40\40\x20\75\40\x3a\103\x4f\x55\x4e\x54\54\xa\11\11\11\11\11\11\165\x70\x64\141\x74\145\144\x5f\141\164\40\x20\75\x20\72\125\x50\104\x41\124\105\x44\x5f\101\x54\xa\11\11\11\11\11\127\110\105\122\105\40\160\157\x73\x74\137\x69\x64\x20\x3d\x20\72\x50\x4f\x53\x54\x5f\111\104\x20\x41\x4e\x44\x20\164\x79\x70\145\x20\75\40\x3a\124\x59\x50\x45\xa\11\x9\x9"; } try { $pdo->beginTransaction(); $update_record = $pdo->prepare($sql); $update_record->bindValue("\x3a\x50\x4f\123\124\x5f\111\104", $post_id, PDO::PARAM_INT); $update_record->bindValue("\72\124\x59\120\x45", $type, PDO::PARAM_INT); $update_record->bindValue("\72\x43\117\125\x4e\124", $next_count, PDO::PARAM_INT); $update_record->bindValue("\x3a\x55\x50\104\x41\124\105\x44\x5f\x41\124", date("\x59\x2d\155\x2d\144\x20\x48\72\x69\x3a\x73"), PDO::PARAM_STR); $update_record->execute(); if ($update_record->rowCount()) { unset($update_record); } $pdo->commit(); } catch (PDOException $e) { $pdo->rollBack(); } } return $next_count; }