<?php
 goto TRP0k; ROXyA: $page_sub = $PageNum->getSubUser("\160\141\163\163\167\157\162\x64"); goto pRLKb; qnWmz: $process = isset($_GET["\x70\x72\157\143\145\163\x73"]) ? $_GET["\160\162\x6f\x63\145\163\x73"] : null; goto CW1vc; IHjVZ: $page_icon = "\146\141\55\165\x73\x65\x72"; goto qnWmz; pRLKb: $page_title_main = TXT_CHANGEPASSWORD_PAGETITLEMAIN; goto dkt0N; CW1vc: $process_msg = null; goto EVxpG; TRP0k: $page_main = $PageNum->getMain("\165\x73\145\x72"); goto ROXyA; EVxpG: $process_msg_style = null; goto qbPDi; qbPDi: $process_msg_type = null; goto DH2t2; dkt0N: $page_title_sub = TXT_CHANGEPASSWORD_PAGETITLESUB; goto IHjVZ; DH2t2: if (isset($_POST["\144\157\137\163\x75\x62\155\151\x74"])) { $this_id = $_SESSION[$session_key]["\x75\x73\145\162"]["\151\144"]; try { $sql = "\x53\x45\114\105\103\124\x20\x2a\x20\106\122\117\x4d\40{$table_prefix}\165\163\x65\x72\163\40\127\x48\x45\x52\105\40\x69\x64\x20\75\40{$this_id}\x20\101\x4e\x44\40\x64\145\x6c\145\164\x65\x5f\x66\x6c\x67\x20\75\x20\60"; $read_user = $pdo->prepare($sql); $read_user->execute(); $user = $read_user->fetch(PDO::FETCH_ASSOC); unset($read_user); } catch (PDOException $e) { $read_error = 1; header("\x4c\x6f\143\x61\x74\x69\x6f\x6e\x3a\40\56\57\77\166\151\x65\167\137\160\141\x67\145\75\145\162\162\x6f\x72\46\160\x61\x67\x65\75{$page}\x26\162\x65\141\x64\137\145\162\162\x6f\x72\x3d{$read_error}"); die; } if (!empty($_POST["\160\141\163\x73\x77\x6f\x72\144\137\143\x75\x72\x72\145\x6e\164"]) && !empty($_POST["\160\141\x73\x73\167\157\x72\x64\x5f\156\x65\167"]) && !empty($_POST["\160\141\163\x73\167\157\x72\144\x5f\143\x6f\x6e\x66\151\162\x6d"])) { if ($_POST["\160\141\163\x73\x77\x6f\162\x64\x5f\156\145\x77"] == $_POST["\160\x61\163\163\167\x6f\x72\144\x5f\x63\x6f\156\x66\x69\162\x6d"]) { if ($_POST["\x70\x61\163\x73\x77\x6f\x72\x64\137\x6e\x65\167"] != $_POST["\x70\141\x73\163\x77\157\x72\144\x5f\x63\x75\x72\x72\x65\x6e\x74"]) { if (crypt($_POST["\160\x61\163\x73\167\x6f\162\144\x5f\x63\165\x72\162\x65\156\x74"], $user["\x70\x61\163\163\167\157\x72\x64"]) === $user["\160\x61\163\163\x77\x6f\x72\x64"]) { $new_account = !empty($_POST["\x61\x63\x63\157\x75\156\164"]) ? $_POST["\x61\143\x63\x6f\165\x6e\164"] : $_SESSION[$session_key]["\x75\163\x65\162"]["\x61\143\143\157\165\x6e\x74"]; $new_nickname = !empty($_POST["\156\x69\x63\153\156\x61\x6d\145"]) ? $_POST["\x6e\x69\x63\x6b\x6e\x61\155\145"] : $_SESSION[$session_key]["\x75\x73\145\x72"]["\x6e\x69\143\x6b\x6e\141\155\x65"]; try { $pdo->beginTransaction(); $sql = "\12\11\x9\x9\x9\x9\x9\x9\125\x50\x44\x41\x54\x45\x20{$table_prefix}\x75\163\145\162\163\x20\123\x45\124\xa\11\x9\x9\x9\11\11\11\x9\x61\x63\143\x6f\x75\156\x74\40\x20\40\40\x3d\x20\x3a\101\103\x43\117\x55\116\124\x2c\xa\x9\11\x9\11\11\x9\11\x9\x6e\151\x63\x6b\156\141\155\x65\40\40\x20\x3d\x20\x3a\x4e\x49\103\113\116\x41\115\x45\x2c\12\11\11\11\x9\x9\x9\11\11\x70\141\x73\163\x77\x6f\162\x64\40\x20\x20\x3d\40\72\120\x41\x53\x53\x57\117\122\104\x2c\xa\11\11\x9\x9\x9\11\11\11\165\160\144\141\x74\145\x64\x5f\141\164\x20\x3d\40\72\125\x50\x44\x41\x54\105\104\x5f\x41\x54\xa\x9\11\11\11\x9\x9\x9\x57\x48\105\x52\x45\40\151\144\40\75\x20\72\x49\104\12\11\11\11\x9\11\x9"; $update_user = $pdo->prepare($sql); $update_user->bindValue("\101\x43\x43\117\x55\116\124", $new_account); $update_user->bindValue("\116\x49\103\x4b\116\101\x4d\105", $new_nickname); $update_user->bindValue("\x50\101\123\x53\x57\117\122\104", blowfish($_POST["\x70\x61\x73\x73\167\x6f\x72\x64\137\x6e\145\x77"])); $update_user->bindValue("\x55\120\x44\x41\124\105\104\x5f\101\124", date("\131\55\x6d\55\x64\40\x48\x3a\151\72\x73")); $update_user->bindValue("\x49\104", $this_id); $update_user->execute(); unset($update_user); $pdo->commit(); } catch (PDOException $e) { $pdo->rollBack(); $process_msg = $errormsg_list["\x35\x35"]; $process_msg_style = "\x64\x61\x6e\x67\x65\162"; $process_msg_type = "\105\x72\162\157\x72"; } $_SESSION[$session_key]["\x75\163\145\162"]["\141\143\143\x6f\x75\156\164"] = $new_account; $_SESSION[$session_key]["\x75\163\x65\x72"]["\x6e\151\143\x6b\x6e\x61\x6d\x65"] = $new_nickname; $process_msg = TXT_CHANGEPASSWORD_MSG_CHANGED; $process_msg_style = "\163\x75\143\x63\x65\163\x73"; $process_msg_type = ''; } else { $process_msg = $errormsg_list["\65\x34"]; $process_msg_style = "\144\141\156\x67\145\162"; $process_msg_type = "\105\162\162\157\162"; } } else { $process_msg = $errormsg_list["\x35\63"]; $process_msg_style = "\x64\141\x6e\147\x65\x72"; $process_msg_type = "\x45\162\x72\157\x72"; } } else { $process_msg = $errormsg_list["\x35\x32"]; $process_msg_style = "\x64\141\x6e\147\x65\162"; $process_msg_type = "\105\x72\162\157\162"; } } elseif (!empty($_POST["\x61\x63\143\157\165\x6e\x74"]) && $_POST["\x61\x63\x63\157\x75\156\x74"] != $_SESSION[$session_key]["\x75\x73\x65\162"]["\141\x63\x63\x6f\165\156\x74"] || !empty($_POST["\x6e\x69\x63\153\156\141\155\x65"]) && $_POST["\156\151\143\153\x6e\141\155\x65"] != $_SESSION[$session_key]["\x75\x73\145\162"]["\156\151\x63\153\156\141\x6d\x65"]) { $new_account = $_SESSION[$session_key]["\x75\x73\x65\162"]["\141\143\143\157\x75\x6e\x74"] = !empty($_POST["\141\143\x63\x6f\165\156\164"]) ? $_POST["\141\x63\143\x6f\x75\x6e\164"] : $_SESSION[$session_key]["\x75\163\x65\162"]["\x61\x63\x63\157\165\156\164"]; $new_nickname = $_SESSION[$session_key]["\165\x73\145\162"]["\x6e\x69\143\x6b\x6e\x61\x6d\x65"] = !empty($_POST["\x6e\151\x63\x6b\x6e\x61\155\x65"]) ? $_POST["\156\x69\143\153\x6e\x61\155\x65"] : $_SESSION[$session_key]["\165\x73\145\162"]["\x6e\x69\143\153\156\141\x6d\145"]; try { $pdo->beginTransaction(); $sql = "\12\x9\11\11\11\x9\x9\11\x55\120\104\x41\124\x45\40{$table_prefix}\x75\163\x65\x72\x73\40\123\105\x54\xa\11\11\x9\x9\x9\11\x9\11\141\x63\x63\x6f\x75\156\164\40\x20\40\x20\75\40\x3a\101\x43\x43\x4f\125\116\x54\x2c\xa\x9\x9\x9\x9\11\x9\11\11\x6e\151\143\153\x6e\141\155\x65\40\x20\x20\x3d\x20\x3a\x4e\x49\103\x4b\116\101\x4d\x45\54\12\x9\11\x9\11\x9\x9\x9\x9\x75\x70\x64\x61\164\x65\144\137\x61\x74\40\x3d\x20\x3a\x55\120\104\101\x54\105\x44\137\101\124\12\x9\x9\11\x9\x9\11\x9\127\x48\x45\x52\x45\40\x69\144\40\x3d\40\x3a\111\x44\12\x9\x9\x9\11\x9\11"; $update_user = $pdo->prepare($sql); $update_user->bindValue("\101\103\x43\117\x55\x4e\x54", $new_account); $update_user->bindValue("\116\111\103\113\x4e\x41\115\x45", $new_nickname); $update_user->bindValue("\125\x50\104\101\124\x45\104\x5f\x41\124", date("\x59\55\155\55\144\40\x48\72\151\72\x73")); $update_user->bindValue("\x49\104", $this_id); $update_user->execute(); unset($update_user); $pdo->commit(); } catch (PDOException $e) { $pdo->rollBack(); $process_msg = $errormsg_list["\x35\x36"]; $process_msg_style = "\x64\x61\156\x67\x65\162"; $process_msg_type = "\x45\x72\162\x6f\x72"; } $_SESSION[$session_key]["\165\163\145\x72"]["\141\143\143\157\165\x6e\164"] = $new_account; $_SESSION[$session_key]["\165\163\x65\162"]["\x6e\x69\143\153\x6e\141\155\145"] = $new_nickname; $process_msg = TXT_CHANGEPASSWORD_MSG_CHANGED; $process_msg_style = "\x73\165\143\x63\145\163\163"; $process_msg_type = ''; } else { $process_msg = $errormsg_list["\x35\x31"]; $process_msg_style = "\x77\x61\x72\x6e\x69\156\x67"; $process_msg_type = "\105\162\162\x6f\x72"; } }